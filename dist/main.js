!function(t){var e={};function o(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=e,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=44)}([function(t,e,o){"use strict";var i=o(26),n="object"==typeof self&&self&&self.Object===Object&&self,r=i.a||n||Function("return this")();e.a=r},function(t,e,o){"use strict";e.a=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,o){"use strict";var i="__lodash_placeholder__";e.a=function(t,e){for(var o=-1,n=t.length,r=0,s=[];++o<n;){var h=t[o];h!==e&&h!==i||(t[o]=i,s[r++]=o)}return s}},function(t,e,o){"use strict";var i=o(49);t.exports=function(t,e){return function(o,n){return n.type.slice(0,t.length)===t?e(o,i(n,{type:n.type.slice(t.length)})):e(o,{})}}},function(t,e,o){"use strict";o.d(e,"a",(function(){return l})),o.d(e,"b",(function(){return h}));var i=o(23),n=function(){return Math.random().toString(36).substring(7).split("").join(".")},r={INIT:"@@redux/INIT"+n(),REPLACE:"@@redux/REPLACE"+n(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+n()}};function s(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function h(t,e,o){var n;if("function"==typeof e&&"function"==typeof o||"function"==typeof o&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof e&&void 0===o&&(o=e,e=void 0),void 0!==o){if("function"!=typeof o)throw new Error("Expected the enhancer to be a function.");return o(h)(t,e)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var a=t,l=e,c=[],u=c,p=!1;function d(){u===c&&(u=c.slice())}function f(){if(p)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return l}function g(t){if("function"!=typeof t)throw new Error("Expected the listener to be a function.");if(p)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var e=!0;return d(),u.push(t),function(){if(e){if(p)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");e=!1,d();var o=u.indexOf(t);u.splice(o,1)}}}function y(t){if(!s(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(p)throw new Error("Reducers may not dispatch actions.");try{p=!0,l=a(l,t)}finally{p=!1}for(var e=c=u,o=0;o<e.length;o++){(0,e[o])()}return t}return y({type:r.INIT}),(n={dispatch:y,subscribe:g,getState:f,replaceReducer:function(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");a=t,y({type:r.REPLACE})}})[i.a]=function(){var t,e=g;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new TypeError("Expected the observer to be an object.");function o(){t.next&&t.next(f())}return o(),{unsubscribe:e(o)}}})[i.a]=function(){return this},t},n}function a(t,e){var o=e&&e.type;return"Given "+(o&&'action "'+String(o)+'"'||"an action")+', reducer "'+t+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function l(t){for(var e=Object.keys(t),o={},i=0;i<e.length;i++){var n=e[i];0,"function"==typeof t[n]&&(o[n]=t[n])}var s,h=Object.keys(o);try{!function(t){Object.keys(t).forEach((function(e){var o=t[e];if(void 0===o(void 0,{type:r.INIT}))throw new Error('Reducer "'+e+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===o(void 0,{type:r.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+e+"\" returned undefined when probed with a random type. Don't try to handle "+r.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(o)}catch(t){s=t}return function(t,e){if(void 0===t&&(t={}),s)throw s;for(var i=!1,n={},r=0;r<h.length;r++){var l=h[r],c=o[l],u=t[l],p=c(u,e);if(void 0===p){var d=a(l,e);throw new Error(d)}n[l]=p,i=i||p!==u}return i?n:t}}},function(t,e,o){"use strict";e.a=function(t){return t.placeholder}},function(t,e,o){!function(){"use strict";var e=document,o=window,i=e.documentElement,n=e.createElement.bind(e),r=n("div"),s=n("table"),h=n("tbody"),a=n("tr"),l=Array.isArray,c=Array.prototype,u=c.filter,p=c.indexOf,d=c.map,f=c.push,g=c.slice,y=c.some,m=c.splice,M=/^#[\w-]*$/,w=/^\.[\w-]*$/,b=/<.+>/,v=/^\w+$/;function S(t,o){return void 0===o&&(o=e),(i=o)&&9===i.nodeType||L(o)?w.test(t)?o.getElementsByClassName(t.slice(1)):v.test(t)?o.getElementsByTagName(t):o.querySelectorAll(t):[];var i}var x=function(){function t(t,i){if(void 0===i&&(i=e),t){if(E(t))return t;var n=t;if(F(t)){var r=E(i)?i[0]:i;if(!(n=M.test(t)?r.getElementById(t.slice(1)):b.test(t)?vt(t):S(t,r)))return}else if(D(t))return this.ready(t);(n.nodeType||n===o)&&(n=[n]),this.length=n.length;for(var s=0,h=this.length;s<h;s++)this[s]=n[s]}}return t.prototype.init=function(e,o){return new t(e,o)},t}(),C=x.prototype,P=C.init;P.fn=P.prototype=C,C.length=0,C.splice=m,"function"==typeof Symbol&&(C[Symbol.iterator]=c[Symbol.iterator]),C.map=function(t){return P(d.call(this,(function(e,o){return t.call(e,o,e)})))},C.slice=function(t,e){return P(g.call(this,t,e))};var k=/-([a-z])/g;function T(t){return t.replace(k,(function(t,e){return e.toUpperCase()}))}function I(t,e,o){if(o){for(var i=t.length;i--;)if(!1===e.call(t[i],i,t[i]))return t}else{i=0;for(var n=t.length;i<n;i++)if(!1===e.call(t[i],i,t[i]))return t}return t}function B(t,e){var o=t&&(t.matches||t.webkitMatchesSelector||t.msMatchesSelector);return!!o&&o.call(t,e)}function E(t){return t instanceof x}function O(t){return!!t&&t===t.window}function L(t){return!!t&&1===t.nodeType}function D(t){return"function"==typeof t}function F(t){return"string"==typeof t}function R(t){return void 0===t}function j(t){return null===t}function N(t){return!isNaN(parseFloat(t))&&isFinite(t)}function A(t){return F(t)?function(e,o){return B(o,t)}:D(t)?t:E(t)?function(e,o){return t.is(o)}:t?function(e,o){return o===t}:function(){return!1}}function W(t,e){return e?t.filter(e):t}P.camelCase=T,P.each=I,C.each=function(t){return I(this,t)},C.removeProp=function(t){return this.each((function(e,o){delete o[t]}))},P.extend=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];for(var i=arguments.length,n=i<2?0:1;n<i;n++)for(var r in arguments[n])t[r]=arguments[n][r];return t},C.extend=function(t){return P.extend(C,t)},P.guid=1,P.matches=B,P.isWindow=O,P.isFunction=D,P.isString=F,P.isNumeric=N,P.isArray=l,C.prop=function(t,e){if(t){if(F(t))return arguments.length<2?this[0]&&this[0][t]:this.each((function(o,i){i[t]=e}));for(var o in t)this.prop(o,t[o]);return this}},C.get=function(t){return R(t)?g.call(this):this[t<0?t+this.length:t]},C.eq=function(t){return P(this.get(t))},C.first=function(){return this.eq(0)},C.last=function(){return this.eq(-1)},C.filter=function(t){var e=A(t);return P(u.call(this,(function(t,o){return e.call(t,o,t)})))};var _=/\S+/g;function H(t){return F(t)&&t.match(_)||[]}function z(t,e,o){for(var i=[],n=D(e),r=0,s=t.length;r<s;r++)if(n){var h=e(t[r]);h.length&&f.apply(i,h)}else for(var a=t[r][e];null!=a;)i.push(a),a=o?a[e]:null;return i}function K(t){return t.length>1?u.call(t,(function(t,e,o){return p.call(o,t)===e})):t}function U(t,e,i){if(L(t)&&e){var n=o.getComputedStyle(t,null);return e?i?n.getPropertyValue(e)||void 0:n[e]:n}}function G(t,e){return parseInt(U(t,e),10)||0}C.hasClass=function(t){return!!t&&y.call(this,(function(e){return e.classList.contains(t)}))},C.removeAttr=function(t){var e=H(t);return this.each((function(t,o){I(e,(function(t,e){o.removeAttribute(e)}))}))},C.attr=function(t,e){if(t){if(F(t)){if(arguments.length<2){if(!this[0])return;var o=this[0].getAttribute(t);return j(o)?void 0:o}return R(e)?this:j(e)?this.removeAttr(t):this.each((function(o,i){i.setAttribute(t,e)}))}for(var i in t)this.attr(i,t[i]);return this}},C.toggleClass=function(t,e){var o=H(t),i=!R(e);return this.each((function(t,n){I(o,(function(t,o){i?e?n.classList.add(o):n.classList.remove(o):n.classList.toggle(o)}))}))},C.addClass=function(t){return this.toggleClass(t,!0)},C.removeClass=function(t){return arguments.length?this.toggleClass(t,!1):this.attr("class","")},P.unique=K,C.add=function(t,e){return P(K(this.get().concat(P(t,e).get())))};var V=/^--/;function q(t){return V.test(t)}var Y={},X=r.style,$=["webkit","moz","ms"];function J(t,e){if(void 0===e&&(e=q(t)),e)return t;if(!Y[t]){var o=T(t),i=""+o[0].toUpperCase()+o.slice(1);I((o+" "+$.join(i+" ")+i).split(" "),(function(e,o){if(o in X)return Y[t]=o,!1}))}return Y[t]}P.prefixedProp=J;var Z={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function Q(t,e,o){return void 0===o&&(o=q(t)),o||Z[t]||!N(e)?e:e+"px"}function tt(t,e){var o=t.dataset[e]||t.dataset[T(e)];try{return JSON.parse(o)}catch(t){}return o}function et(t,e){return G(t,"border"+(e?"Left":"Top")+"Width")+G(t,"padding"+(e?"Left":"Top"))+G(t,"padding"+(e?"Right":"Bottom"))+G(t,"border"+(e?"Right":"Bottom")+"Width")}C.css=function(t,e){if(F(t)){var o=q(t);return t=J(t,o),arguments.length<2?this[0]&&U(this[0],t,o):t?(e=Q(t,e,o),this.each((function(i,n){L(n)&&(o?n.style.setProperty(t,e):n.style[t]=e)}))):this}for(var i in t)this.css(i,t[i]);return this},C.data=function(t,e){if(!t){if(!this[0])return;var o={};for(var i in this[0].dataset)o[i]=tt(this[0],i);return o}if(F(t))return arguments.length<2?this[0]&&tt(this[0],t):this.each((function(o,i){!function(t,e,o){try{o=JSON.stringify(o)}catch(t){}t.dataset[T(e)]=o}(i,t,e)}));for(var i in t)this.data(i,t[i]);return this},I([!0,!1],(function(t,e){I(["Width","Height"],(function(t,i){var n=(e?"outer":"inner")+i;C[n]=function(r){if(this[0])return O(this[0])?o[n]:this[0][(e?"offset":"client")+i]+(r&&e?G(this[0],"margin"+(t?"Top":"Left"))+G(this[0],"margin"+(t?"Bottom":"Right")):0)}}))})),I(["width","height"],(function(t,e){C[e]=function(o){if(!this[0])return R(o)?void 0:this;if(!arguments.length)return O(this[0])?this[0][T("outer-"+e)]:this[0].getBoundingClientRect()[e]-et(this[0],!t);var i=parseInt(o,10);return this.each((function(o,n){if(L(n)){var r=U(n,"boxSizing");n.style[e]=Q(e,i+("border-box"===r?et(n,!t):0))}}))}}));var ot={};function it(t){return"none"===U(t,"display")}function nt(t,e){return!e||!y.call(e,(function(e){return t.indexOf(e)<0}))}C.toggle=function(t){return this.each((function(o,i){(R(t)?it(i):t)?(i.style.display=i.___cd||"",it(i)&&(i.style.display=function(t){if(ot[t])return ot[t];var o=n(t);e.body.insertBefore(o,null);var i=U(o,"display");return e.body.removeChild(o),ot[t]="none"!==i?i:"block"}(i.tagName))):(i.___cd=U(i,"display"),i.style.display="none")}))},C.hide=function(){return this.toggle(!1)},C.show=function(){return this.toggle(!0)};var rt="___ce",st=".",ht={focus:"focusin",blur:"focusout"},at={mouseenter:"mouseover",mouseleave:"mouseout"},lt=/^(mouse|pointer|contextmenu|drag|drop|click|dblclick)/i;function ct(t){return at[t]||ht[t]||t}function ut(t){return t[rt]=t[rt]||{}}function pt(t){var e=t.split(st);return[e[0],e.slice(1).sort()]}function dt(t,e,o,i,n){var r=ut(t);if(e)r[e]&&(r[e]=r[e].filter((function(r){var s=r[0],h=r[1],a=r[2];if(n&&a.guid!==n.guid||!nt(s,o)||i&&i!==h)return!0;t.removeEventListener(e,a)})));else for(e in r)dt(t,e,o,i,n)}function ft(t){return t.multiple&&t.options?z(u.call(t.options,(function(t){return t.selected&&!t.disabled&&!t.parentNode.disabled})),"value"):t.value||""}C.off=function(t,e,o){var i=this;if(R(t))this.each((function(t,e){dt(e)}));else if(F(t))D(e)&&(o=e,e=""),I(H(t),(function(t,n){var r=pt(ct(n)),s=r[0],h=r[1];i.each((function(t,i){dt(i,s,h,e,o)}))}));else for(var n in t)this.off(n,t[n]);return this},C.on=function(t,e,o,i){var n=this;if(!F(t)){for(var r in t)this.on(r,e,t[r]);return this}return D(e)&&(o=e,e=""),I(H(t),(function(t,r){var s=pt(ct(r)),h=s[0],a=s[1];n.each((function(t,n){var r=function t(r){if(!r.namespace||nt(a,r.namespace.split(st))){var s=n;if(e){for(var l=r.target;!B(l,e);){if(l===n)return;if(!(l=l.parentNode))return}s=l,r.___cd=!0}r.___cd&&Object.defineProperty(r,"currentTarget",{configurable:!0,get:function(){return s}});var c=o.call(s,r,r.data);i&&dt(n,h,a,e,t),!1===c&&(r.preventDefault(),r.stopPropagation())}};r.guid=o.guid=o.guid||P.guid++,function(t,e,o,i,n){n.guid=n.guid||P.guid++;var r=ut(t);r[e]=r[e]||[],r[e].push([o,i,n]),t.addEventListener(e,n)}(n,h,a,e,r)}))})),this},C.one=function(t,e,o){return this.on(t,e,o,!0)},C.ready=function(t){return"loading"!==e.readyState?t(P):e.addEventListener("DOMContentLoaded",(function(){t(P)})),this},C.trigger=function(t,o){if(F(t)){var i=pt(t),n=i[0],r=i[1],s=lt.test(n)?"MouseEvents":"HTMLEvents";(t=e.createEvent(s)).initEvent(n,!0,!0),t.namespace=r.join(st)}t.data=o;var h=t.type in ht;return this.each((function(e,o){h&&D(o[t.type])?o[t.type]():o.dispatchEvent(t)}))};var gt=/%20/g;var yt=/file|reset|submit|button|image/i,mt=/radio|checkbox/i;C.serialize=function(){var t="";return this.each((function(e,o){I(o.elements||[o],(function(e,o){if(!(o.disabled||!o.name||"FIELDSET"===o.tagName||yt.test(o.type)||mt.test(o.type)&&!o.checked)){var i=ft(o);if(!R(i))I(l(i)?i:[i],(function(e,i){t+=function(t,e){return"&"+encodeURIComponent(t)+"="+encodeURIComponent(e).replace(gt,"+")}(o.name,i)}))}}))})),t.slice(1)},C.val=function(t){return R(t)?this[0]&&ft(this[0]):this.each((function(e,o){if("SELECT"===o.tagName){var i=l(t)?t:j(t)?[]:[t];I(o.options,(function(t,e){e.selected=i.indexOf(e.value)>=0}))}else o.value=j(t)?"":t}))},C.clone=function(){return this.map((function(t,e){return e.cloneNode(!0)}))},C.detach=function(){return this.each((function(t,e){e.parentNode&&e.parentNode.removeChild(e)}))};var Mt=/^\s*<(\w+)[^>]*>/,wt=/^\s*<(\w+)\s*\/?>(?:<\/\1>)?\s*$/,bt={"*":r,tr:h,td:a,th:a,thead:s,tbody:s,tfoot:s};function vt(t){if(!F(t))return[];if(wt.test(t))return[n(RegExp.$1)];var e=Mt.test(t)&&RegExp.$1,o=bt[e]||bt["*"];return o.innerHTML=t,P(o.childNodes).detach().get()}P.parseHTML=vt,C.empty=function(){return this.each((function(t,e){for(;e.firstChild;)e.removeChild(e.firstChild)}))},C.html=function(t){return R(t)?this[0]&&this[0].innerHTML:this.each((function(e,o){o.innerHTML=t}))},C.remove=function(){return this.detach().off()},C.text=function(t){return R(t)?this[0]?this[0].textContent:"":this.each((function(e,o){o.textContent=t}))},C.unwrap=function(){return this.parent().each((function(t,e){var o=P(e);o.replaceWith(o.children())})),this},C.offset=function(){var t=this[0];if(t){var e=t.getBoundingClientRect();return{top:e.top+o.pageYOffset-i.clientTop,left:e.left+o.pageXOffset-i.clientLeft}}},C.offsetParent=function(){return P(this[0]&&this[0].offsetParent)},C.position=function(){var t=this[0];if(t)return{left:t.offsetLeft,top:t.offsetTop}},C.children=function(t){return W(P(K(z(this,(function(t){return t.children})))),t)},C.contents=function(){return P(K(z(this,(function(t){return"IFRAME"===t.tagName?[t.contentDocument]:t.childNodes}))))},C.find=function(t){return P(K(z(this,(function(e){return S(t,e)}))))};var St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,xt=/^$|^module$|\/(java|ecma)script/i,Ct=["type","src","nonce","noModule"];function Pt(t,e,o,r){r?t.insertBefore(e,o?t.firstElementChild:null):t.parentNode.insertBefore(e,o?t:t.nextElementSibling),function(t,e){var o=P(t);o.filter("script").add(o.find("script")).each((function(t,o){if(xt.test(o.type)&&i.contains(o)){var r=n("script");r.text=o.textContent.replace(St,""),I(Ct,(function(t,e){o[e]&&(r[e]=o[e])})),e.head.insertBefore(r,null),e.head.removeChild(r)}}))}(e,t.ownerDocument)}function kt(t,e,o,i,n,r,s,h){return I(t,(function(t,r){I(P(r),(function(t,r){I(P(e),(function(t,e){var s=o?e:r;Pt(o?r:e,t?s.cloneNode(!0):s,i,n)}),h)}),s)}),r),e}C.after=function(){return kt(arguments,this,!1,!1,!1,!0,!0)},C.append=function(){return kt(arguments,this,!1,!1,!0)},C.appendTo=function(t){return kt(arguments,this,!0,!1,!0)},C.before=function(){return kt(arguments,this,!1,!0)},C.insertAfter=function(t){return kt(arguments,this,!0,!1,!1,!1,!1,!0)},C.insertBefore=function(t){return kt(arguments,this,!0,!0)},C.prepend=function(){return kt(arguments,this,!1,!0,!0,!0,!0)},C.prependTo=function(t){return kt(arguments,this,!0,!0,!0,!1,!1,!0)},C.replaceWith=function(t){return this.before(t).remove()},C.replaceAll=function(t){return P(t).replaceWith(this),this},C.wrapAll=function(t){for(var e=P(t),o=e[0];o.children.length;)o=o.firstElementChild;return this.first().before(e),this.appendTo(o)},C.wrap=function(t){return this.each((function(e,o){var i=P(t)[0];P(o).wrapAll(e?i.cloneNode(!0):i)}))},C.wrapInner=function(t){return this.each((function(e,o){var i=P(o),n=i.contents();n.length?n.wrapAll(t):i.append(t)}))},C.has=function(t){var e=F(t)?function(e,o){return S(t,o).length}:function(e,o){return o.contains(t)};return this.filter(e)},C.is=function(t){var e=A(t);return y.call(this,(function(t,o){return e.call(t,o,t)}))},C.next=function(t,e){return W(P(K(z(this,"nextElementSibling",e))),t)},C.nextAll=function(t){return this.next(t,!0)},C.not=function(t){var e=A(t);return this.filter((function(t,o){return!e.call(o,t,o)}))},C.parent=function(t){return W(P(K(z(this,"parentNode"))),t)},C.index=function(t){var e=t?P(t)[0]:this[0],o=t?this:P(e).parent().children();return p.call(o,e)},C.closest=function(t){var e=this.filter(t);if(e.length)return e;var o=this.parent();return o.length?o.closest(t):e},C.parents=function(t){return W(P(K(z(this,"parentElement",!0))),t)},C.prev=function(t,e){return W(P(K(z(this,"previousElementSibling",e))),t)},C.prevAll=function(t){return this.prev(t,!0)},C.siblings=function(t){return W(P(K(z(this,(function(t){return P(t).parent().children().not(t)})))),t)},t.exports=P}()},function(t,e,o){"use strict";e.a=function(t){return t}},function(t,e,o){"use strict";e.a=function(t,e,o){switch(o.length){case 0:return t.call(e);case 1:return t.call(e,o[0]);case 2:return t.call(e,o[0],o[1]);case 3:return t.call(e,o[0],o[1],o[2])}return t.apply(e,o)}},function(t,e,o){"use strict";var i=o(20),n=o(16),r=o(5),s=o(2),h=Object(i.a)((function(t,e){var o=Object(s.a)(e,Object(r.a)(h));return Object(n.a)(t,32,void 0,e,o)}));h.placeholder={},e.a=h},function(t,e,o){"use strict";var i=o(1),n=o(19),r=o(15),s="[object Symbol]";var h=function(t){return"symbol"==typeof t||Object(r.a)(t)&&Object(n.a)(t)==s},a=NaN,l=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,p=/^0o[0-7]+$/i,d=parseInt;e.a=function(t){if("number"==typeof t)return t;if(h(t))return a;if(Object(i.a)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Object(i.a)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(l,"");var o=u.test(t);return o||p.test(t)?d(t.slice(2),o?2:8):c.test(t)?a:+t}},function(t,e,o){"use strict";e.a=function(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];var i="function"!=typeof e[0]&&e.shift(),n=e;if(void 0===i)throw new TypeError("The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.");return function(t,e){for(var o=arguments.length,r=Array(o>2?o-2:0),s=2;s<o;s++)r[s-2]=arguments[s];var h=void 0===t,a=void 0===e;return h&&a&&i?i:n.reduce((function(t,o,i){if(void 0===o)throw new TypeError("An undefined reducer was passed in at index "+i);return o.apply(void 0,[t,e].concat(r))}),h&&!a&&i?i:t)}}},function(t,e,o){"use strict";var i=function(){function t(t){this._m=t}return t.prototype.getFramework=function(){return this._m},t}();e.a=i},function(t,e){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(t){"object"==typeof window&&(o=window)}t.exports=o},function(t,e,o){"use strict";var i=800,n=16,r=Date.now;e.a=function(t){var e=0,o=0;return function(){var s=r(),h=n-(s-o);if(o=s,h>0){if(++e>=i)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,o){"use strict";e.a=function(t){return null!=t&&"object"==typeof t}},function(t,e,o){"use strict";var i=o(7),n=o(17),r=o(0),s=Object(n.a)(r.a,"WeakMap"),h=s&&new s,a=h?function(t,e){return h.set(t,e),t}:i.a,l=o(1),c=Object.create,u=function(){function t(){}return function(e){if(!Object(l.a)(e))return{};if(c)return c(e);t.prototype=e;var o=new t;return t.prototype=void 0,o}}();var p=function(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var o=u(t.prototype),i=t.apply(o,e);return Object(l.a)(i)?i:o}},d=1;var f=function(t,e,o){var i=e&d,n=p(t);return function e(){return(this&&this!==r.a&&this instanceof e?n:t).apply(i?o:this,arguments)}},g=o(8),y=Math.max;var m=function(t,e,o,i){for(var n=-1,r=t.length,s=o.length,h=-1,a=e.length,l=y(r-s,0),c=Array(a+l),u=!i;++h<a;)c[h]=e[h];for(;++n<s;)(u||n<r)&&(c[o[n]]=t[n]);for(;l--;)c[h++]=t[n++];return c},M=Math.max;var w=function(t,e,o,i){for(var n=-1,r=t.length,s=-1,h=o.length,a=-1,l=e.length,c=M(r-h,0),u=Array(c+l),p=!i;++n<c;)u[n]=t[n];for(var d=n;++a<l;)u[d+a]=e[a];for(;++s<h;)(p||n<r)&&(u[d+o[s]]=t[n++]);return u};var b=function(t,e){for(var o=t.length,i=0;o--;)t[o]===e&&++i;return i};var v=function(){},S=4294967295;function x(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=S,this.__views__=[]}x.prototype=u(v.prototype),x.prototype.constructor=x;var C=x;var P=h?function(t){return h.get(t)}:function(){},k={},T=Object.prototype.hasOwnProperty;var I=function(t){for(var e=t.name+"",o=k[e],i=T.call(k,e)?o.length:0;i--;){var n=o[i],r=n.func;if(null==r||r==t)return n.name}return e};function B(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}B.prototype=u(v.prototype),B.prototype.constructor=B;var E=B,O=Array.isArray,L=o(15);var D=function(t,e){var o=-1,i=t.length;for(e||(e=Array(i));++o<i;)e[o]=t[o];return e};var F=function(t){if(t instanceof C)return t.clone();var e=new E(t.__wrapped__,t.__chain__);return e.__actions__=D(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e},R=Object.prototype.hasOwnProperty;function j(t){if(Object(L.a)(t)&&!O(t)&&!(t instanceof C)){if(t instanceof E)return t;if(R.call(t,"__wrapped__"))return F(t)}return new E(t)}j.prototype=v.prototype,j.prototype.constructor=j;var N=j;var A=function(t){var e=I(t),o=N[e];if("function"!=typeof o||!(e in C.prototype))return!1;if(t===o)return!0;var i=P(o);return!!i&&t===i[0]},W=o(14),_=Object(W.a)(a),H=/\{\n\/\* \[wrapped with (.+)\] \*/,z=/,? & /;var K=function(t){var e=t.match(H);return e?e[1].split(z):[]},U=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;var G=function(t,e){var o=e.length;if(!o)return t;var i=o-1;return e[i]=(o>1?"& ":"")+e[i],e=e.join(o>2?", ":" "),t.replace(U,"{\n/* [wrapped with "+e+"] */\n")},V=o(18);var q=function(t,e){for(var o=-1,i=null==t?0:t.length;++o<i&&!1!==e(t[o],o,t););return t};var Y=function(t,e,o,i){for(var n=t.length,r=o+(i?1:-1);i?r--:++r<n;)if(e(t[r],r,t))return r;return-1};var X=function(t){return t!=t};var $=function(t,e,o){for(var i=o-1,n=t.length;++i<n;)if(t[i]===e)return i;return-1};var J=function(t,e,o){return e==e?$(t,e,o):Y(t,X,o)};var Z=function(t,e){return!!(null==t?0:t.length)&&J(t,e,0)>-1},Q=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];var tt=function(t,e){return q(Q,(function(o){var i="_."+o[0];e&o[1]&&!Z(t,i)&&t.push(i)})),t.sort()};var et=function(t,e,o){var i=e+"";return Object(V.a)(t,G(i,tt(K(i),o)))},ot=1,it=2,nt=4,rt=8,st=32,ht=64;var at=function(t,e,o,i,n,r,s,h,a,l){var c=e&rt;e|=c?st:ht,(e&=~(c?ht:st))&nt||(e&=~(ot|it));var u=[t,e,n,c?r:void 0,c?s:void 0,c?void 0:r,c?void 0:s,h,a,l],p=o.apply(void 0,u);return A(t)&&_(p,u),p.placeholder=i,et(p,t,e)},lt=o(5),ct=9007199254740991,ut=/^(?:0|[1-9]\d*)$/;var pt=function(t,e){var o=typeof t;return!!(e=null==e?ct:e)&&("number"==o||"symbol"!=o&&ut.test(t))&&t>-1&&t%1==0&&t<e},dt=Math.min;var ft=function(t,e){for(var o=t.length,i=dt(e.length,o),n=D(t);i--;){var r=e[i];t[i]=pt(r,o)?n[r]:void 0}return t},gt=o(2),yt=1,mt=2,Mt=8,wt=16,bt=128,vt=512;var St=function t(e,o,i,n,s,h,a,l,c,u){var d=o&bt,f=o&yt,g=o&mt,y=o&(Mt|wt),M=o&vt,v=g?void 0:p(e);return function S(){for(var x=arguments.length,C=Array(x),P=x;P--;)C[P]=arguments[P];if(y)var k=Object(lt.a)(S),T=b(C,k);if(n&&(C=m(C,n,s,y)),h&&(C=w(C,h,a,y)),x-=T,y&&x<u){var I=Object(gt.a)(C,k);return at(e,o,t,S.placeholder,i,C,I,l,c,u-x)}var B=f?i:this,E=g?B[e]:e;return x=C.length,l?C=ft(C,l):M&&x>1&&C.reverse(),d&&c<x&&(C.length=c),this&&this!==r.a&&this instanceof S&&(E=v||p(E)),E.apply(B,C)}};var xt=function(t,e,o){var i=p(t);return function n(){for(var s=arguments.length,h=Array(s),a=s,l=Object(lt.a)(n);a--;)h[a]=arguments[a];var c=s<3&&h[0]!==l&&h[s-1]!==l?[]:Object(gt.a)(h,l);if((s-=c.length)<o)return at(t,e,St,n.placeholder,void 0,h,c,void 0,void 0,o-s);var u=this&&this!==r.a&&this instanceof n?i:t;return Object(g.a)(u,this,h)}},Ct=1;var Pt=function(t,e,o,i){var n=e&Ct,s=p(t);return function e(){for(var h=-1,a=arguments.length,l=-1,c=i.length,u=Array(c+a),p=this&&this!==r.a&&this instanceof e?s:t;++l<c;)u[l]=i[l];for(;a--;)u[l++]=arguments[++h];return Object(g.a)(p,n?o:this,u)}},kt="__lodash_placeholder__",Tt=1,It=2,Bt=4,Et=8,Ot=128,Lt=256,Dt=Math.min;var Ft=function(t,e){var o=t[1],i=e[1],n=o|i,r=n<(Tt|It|Ot),s=i==Ot&&o==Et||i==Ot&&o==Lt&&t[7].length<=e[8]||i==(Ot|Lt)&&e[7].length<=e[8]&&o==Et;if(!r&&!s)return t;i&Tt&&(t[2]=e[2],n|=o&Tt?0:Bt);var h=e[3];if(h){var a=t[3];t[3]=a?m(a,h,e[4]):h,t[4]=a?Object(gt.a)(t[3],kt):e[4]}return(h=e[5])&&(a=t[5],t[5]=a?w(a,h,e[6]):h,t[6]=a?Object(gt.a)(t[5],kt):e[6]),(h=e[7])&&(t[7]=h),i&Ot&&(t[8]=null==t[8]?e[8]:Dt(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=n,t},Rt=o(10),jt=1/0,Nt=17976931348623157e292;var At=function(t){return t?(t=Object(Rt.a)(t))===jt||t===-jt?(t<0?-1:1)*Nt:t==t?t:0:0===t?t:0};var Wt=function(t){var e=At(t),o=e%1;return e==e?o?e-o:e:0},_t="Expected a function",Ht=1,zt=2,Kt=8,Ut=16,Gt=32,Vt=64,qt=Math.max;e.a=function(t,e,o,i,n,r,s,h){var l=e&zt;if(!l&&"function"!=typeof t)throw new TypeError(_t);var c=i?i.length:0;if(c||(e&=~(Gt|Vt),i=n=void 0),s=void 0===s?s:qt(Wt(s),0),h=void 0===h?h:Wt(h),c-=n?n.length:0,e&Vt){var u=i,p=n;i=n=void 0}var d=l?void 0:P(t),g=[t,e,o,i,n,u,p,r,s,h];if(d&&Ft(g,d),t=g[0],e=g[1],o=g[2],i=g[3],n=g[4],!(h=g[9]=void 0===g[9]?l?0:t.length:qt(g[9]-c,0))&&e&(Kt|Ut)&&(e&=~(Kt|Ut)),e&&e!=Ht)y=e==Kt||e==Ut?xt(t,e,h):e!=Gt&&e!=(Ht|Gt)||n.length?St.apply(void 0,g):Pt(t,e,o,i);else var y=f(t,e,o);return et((d?a:_)(y,g),t,e)}},function(t,e,o){"use strict";var i=o(19),n=o(1),r="[object AsyncFunction]",s="[object Function]",h="[object GeneratorFunction]",a="[object Proxy]";var l,c=function(t){if(!Object(n.a)(t))return!1;var e=Object(i.a)(t);return e==s||e==h||e==r||e==a},u=o(0).a["__core-js_shared__"],p=(l=/[^.]+$/.exec(u&&u.keys&&u.keys.IE_PROTO||""))?"Symbol(src)_1."+l:"";var d=function(t){return!!p&&p in t},f=Function.prototype.toString;var g=function(t){if(null!=t){try{return f.call(t)}catch(t){}try{return t+""}catch(t){}}return""},y=/^\[object .+?Constructor\]$/,m=Function.prototype,M=Object.prototype,w=m.toString,b=M.hasOwnProperty,v=RegExp("^"+w.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var S=function(t){return!(!Object(n.a)(t)||d(t))&&(c(t)?v:y).test(g(t))};var x=function(t,e){return null==t?void 0:t[e]};e.a=function(t,e){var o=x(t,e);return S(o)?o:void 0}},function(t,e,o){"use strict";var i=function(t){return function(){return t}},n=o(17),r=function(){try{var t=Object(n.a)(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),s=o(7),h=r?function(t,e){return r(t,"toString",{configurable:!0,enumerable:!1,value:i(e),writable:!0})}:s.a,a=o(14),l=Object(a.a)(h);e.a=l},function(t,e,o){"use strict";var i=o(0).a.Symbol,n=Object.prototype,r=n.hasOwnProperty,s=n.toString,h=i?i.toStringTag:void 0;var a=function(t){var e=r.call(t,h),o=t[h];try{t[h]=void 0;var i=!0}catch(t){}var n=s.call(t);return i&&(e?t[h]=o:delete t[h]),n},l=Object.prototype.toString;var c=function(t){return l.call(t)},u="[object Null]",p="[object Undefined]",d=i?i.toStringTag:void 0;e.a=function(t){return null==t?void 0===t?p:u:d&&d in Object(t)?a(t):c(t)}},function(t,e,o){"use strict";var i=o(7),n=o(8),r=Math.max;var s=function(t,e,o){return e=r(void 0===e?t.length-1:e,0),function(){for(var i=arguments,s=-1,h=r(i.length-e,0),a=Array(h);++s<h;)a[s]=i[e+s];s=-1;for(var l=Array(e+1);++s<e;)l[s]=i[s];return l[e]=o(a),Object(n.a)(t,this,l)}},h=o(18);e.a=function(t,e){return Object(h.a)(s(t,e,i.a),t+"")}},,function(t,e,o){"use strict";var i=function(t,e){this.allApps=t,this.getCurrent=e.getCurrent,this.setCurrent=e.setCurrent};e.a=i},function(t,e,o){"use strict";(function(t,i){var n,r=o(35);n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:i;var s=Object(r.a)(n);e.a=s}).call(this,o(13),o(51)(t))},function(module,exports){var morphicVersion="2018-March-19",modules={},useBlurredShadows=getBlurredShadowSupport(),standardSettings={minimumFontHeight:getMinimumFontHeight(),globalFontFamily:"",menuFontName:"sans-serif",menuFontSize:12,bubbleHelpFontSize:10,prompterFontName:"sans-serif",prompterFontSize:12,prompterSliderSize:10,handleSize:15,scrollBarSize:12,mouseScrollAmount:40,useSliderForInput:!1,useVirtualKeyboard:!0,isTouchDevice:!1,rasterizeSVGs:!1,isFlat:!1,grabThreshold:5},touchScreenSettings={minimumFontHeight:standardSettings.minimumFontHeight,globalFontFamily:"",menuFontName:"sans-serif",menuFontSize:24,bubbleHelpFontSize:18,prompterFontName:"sans-serif",prompterFontSize:24,prompterSliderSize:20,handleSize:26,scrollBarSize:24,mouseScrollAmount:40,useSliderForInput:!0,useVirtualKeyboard:!0,isTouchDevice:!1,rasterizeSVGs:!1,isFlat:!1,grabThreshold:5},MorphicPreferences=standardSettings,Morph,WorldMorph,HandMorph,ShadowMorph,FrameMorph,MenuMorph,HandleMorph,StringFieldMorph,ColorPickerMorph,SliderMorph,ScrollFrameMorph,InspectorMorph,StringMorph,TextMorph,PenMorph,ColorPaletteMorph,GrayPaletteMorph,BlinkerMorph,CursorMorph,BoxMorph,SpeechBubbleMorph,DialMorph,CircleBoxMorph,SliderButtonMorph,MouseSensorMorph,ListMorph,TriggerMorph,MenuItemMorph,MenuItemMorph,BouncerMorph;function nop(){return null}function localize(t){return t}function isNil(t){return null==t}function contains(t,e){return-1!==t.indexOf(e)}function detect(t,e){var o,i=t.length;for(o=0;o<i;o+=1)if(e.call(null,t[o]))return t[o];return null}function sizeOf(t){var e,o=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o+=1);return o}function isString(t){return"string"==typeof t||t instanceof String}function isObject(t){return null!==t&&("object"==typeof t||t instanceof Object)}function radians(t){return t*Math.PI/180}function degrees(t){return 180*t/Math.PI}function fontHeight(t){return 1.2*Math.max(t,MorphicPreferences.minimumFontHeight)}function isWordChar(t){return t.match(/[A-zÀ-ÿ0-9]/)}function newCanvas(t,e){var o,i;return i=t||{x:0,y:0},(o=document.createElement("canvas")).width=i.x,o.height=i.y,e&&o.isRetinaEnabled&&(o.isRetinaEnabled=!1),o}function getMinimumFontHeight(){var t,e,o,i,n=document.createElement("canvas");for(n.width=50,n.height=50,(t=n.getContext("2d")).font="1px serif",e=t.measureText("I").width,t.fillStyle="black",t.textBaseline="bottom",t.fillText("I",0,50),i=0;i<50;i+=1)for(o=0;o<e;o+=1)if(0!==t.getImageData(o,i,1,1).data[3])return 50-i+1;return 0}function getBlurredShadowSupport(){var t,e,o;return(t=document.createElement("canvas")).width=10,t.height=10,(o=t.getContext("2d")).fillStyle="rgb(255, 0, 0)",o.beginPath(),o.arc(5,5,5,0,2*Math.PI,!0),o.closePath(),o.fill(),(e=document.createElement("canvas")).width=10,e.height=10,(o=e.getContext("2d")).shadowBlur=10,o.shadowColor="rgba(0, 0, 255, 1)",o.drawImage(t,0,0),!!o.getImageData(0,0,1,1).data[3]}function getDocumentPositionOf(t){var e,o;if(null===t)return{x:0,y:0};for(e={x:t.offsetLeft,y:t.offsetTop},o=t.offsetParent;null!==o;)e.x+=o.offsetLeft,e.y+=o.offsetTop,o!==document.body&&o!==document.documentElement&&(e.x-=o.scrollLeft,e.y-=o.scrollTop),o=o.offsetParent;return e}function copy(t){var e,o,i,n,r,s;if("object"!=typeof t)return t;if(e=t.valueOf(),t!==e)return new t.constructor(e);if(t instanceof t.constructor&&t.constructor!==Object)for(o=Object.create(t.constructor.prototype),r=(n=Object.keys(t)).length,s=0;s<r;s+=1)o[i=n[s]]=t[i];else for(i in o={},t)o[i]=t[i];return o}function enableRetinaSupport(){var t=document.createElement("canvas").getContext("2d"),e=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,o=Math.ceil(window.devicePixelRatio),i=HTMLCanvasElement.prototype,n=CanvasRenderingContext2D.prototype,r={drawImage:n.drawImage,getImageData:n.getImageData,width:Object.getOwnPropertyDescriptor(i,"width"),height:Object.getOwnPropertyDescriptor(i,"height"),shadowOffsetX:Object.getOwnPropertyDescriptor(n,"shadowOffsetX"),shadowOffsetY:Object.getOwnPropertyDescriptor(n,"shadowOffsetY"),shadowBlur:Object.getOwnPropertyDescriptor(n,"shadowBlur")};function s(t){return t.isRetinaEnabled?(o||1)/e:1}e!==o&&(Object.keys(r).some((function(t){var e=r[t];return e.hasOwnProperty("configurable")&&!e.configurable}))||(i._isRetinaEnabled=!0,i._bak=r,Object.defineProperty(i,"isRetinaEnabled",{get:function(){return this._isRetinaEnabled},set:function(t){var e=s(this),o=this.width,i=this.height;this._isRetinaEnabled=t,s(this)!=e&&(this.width=o,this.height=i)},configurable:!0}),Object.defineProperty(i,"width",{get:function(){return r.width.get.call(this)/s(this)},set:function(t){try{var e,o=s(this);r.width.set.call(this,t*o),(e=this.getContext("2d")).restore(),e.save(),e.scale(o,o)}catch(e){console.log("Retina Display Support Problem",e),r.width.set.call(this,t)}}}),Object.defineProperty(i,"height",{get:function(){return r.height.get.call(this)/s(this)},set:function(t){var e,o=s(this);r.height.set.call(this,t*o),(e=this.getContext("2d")).restore(),e.save(),e.scale(o,o)}}),n.drawImage=function(t){var e,o,i,n,h,a,l,c,u=s(t);switch(arguments.length){case 9:e=arguments[1],o=arguments[2],i=arguments[3],n=arguments[4],h=arguments[5],a=arguments[6],l=arguments[7],c=arguments[8];break;case 5:e=0,o=0,i=t.width,n=t.height,h=arguments[1],a=arguments[2],l=arguments[3],c=arguments[4];break;case 3:e=0,o=0,i=t.width,n=t.height,h=arguments[1],a=arguments[2],l=t.width,c=t.height;break;default:throw Error("Called drawImage() with "+arguments.length+" arguments")}r.drawImage.call(this,t,e*u,o*u,i*u,n*u,h,a,l,c)},n.getImageData=function(t,e,o,i){var n=s(this.canvas);return r.getImageData.call(this,t*n,e*n,o*n,i*n)},Object.defineProperty(n,"shadowOffsetX",{get:function(){return r.shadowOffsetX.get.call(this)/s(this.canvas)},set:function(t){var e=s(this.canvas);r.shadowOffsetX.set.call(this,t*e)}}),Object.defineProperty(n,"shadowOffsetY",{get:function(){return r.shadowOffsetY.get.call(this)/s(this.canvas)},set:function(t){var e=s(this.canvas);r.shadowOffsetY.set.call(this,t*e)}}),Object.defineProperty(n,"shadowBlur",{get:function(){return r.shadowBlur.get.call(this)/s(this.canvas)},set:function(t){var e=s(this.canvas);r.shadowBlur.set.call(this,t*e)}})))}function isRetinaSupported(){var t=document.createElement("canvas").getContext("2d"),e=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,o=HTMLCanvasElement.prototype,i=CanvasRenderingContext2D.prototype,n={drawImage:i.drawImage,getImageData:i.getImageData,width:Object.getOwnPropertyDescriptor(o,"width"),height:Object.getOwnPropertyDescriptor(o,"height"),shadowOffsetX:Object.getOwnPropertyDescriptor(i,"shadowOffsetX"),shadowOffsetY:Object.getOwnPropertyDescriptor(i,"shadowOffsetY"),shadowBlur:Object.getOwnPropertyDescriptor(i,"shadowBlur")};return e!==window.devicePixelRatio&&!Object.keys(n).some((function(t){var e=n[t];return e.hasOwnProperty("configurable")&&!e.configurable}))}function isRetinaEnabled(){return HTMLCanvasElement.prototype.hasOwnProperty("_isRetinaEnabled")}function disableRetinaSupport(){var t,e,o;isRetinaEnabled()&&(t=HTMLCanvasElement.prototype,e=CanvasRenderingContext2D.prototype,o=t._bak,Object.defineProperty(t,"width",o.width),Object.defineProperty(t,"height",o.height),e.drawImage=o.drawImage,e.getImageData=o.getImageData,Object.defineProperty(e,"shadowOffsetX",o.shadowOffsetX),Object.defineProperty(e,"shadowOffsetY",o.shadowOffsetY),Object.defineProperty(e,"shadowBlur",o.shadowBlur),delete t._isRetinaEnabled,delete t.isRetinaEnabled,delete t._bak)}function normalizeCanvas(t,e){var o;return t.isRetinaEnabled?((o=newCanvas(new Point(t.width,t.height),!0)).getContext("2d").drawImage(t,0,0),e?o:(t.isRetinaEnabled=!1,t.width=o.width,t.height=o.height,t.getContext("2d").drawImage(o,0,0),t)):t}function Animation(t,e,o,i,n,r){this.setter=t,this.getter=e,this.delta=o||0,this.duration=i||0,this.easing=isString(n)?this.easings[n]||this.easings.sinusoidal:n||this.easings.sinusoidal,this.onComplete=r||null,this.endTime=null,this.destination=null,this.isActive=!1,this.start()}function Color(t,e,o,i){this.r=t||0,this.g=e||0,this.b=o||0,this.a=i||(0===i?0:1)}function Point(t,e){this.x=t||0,this.y=e||0}function Rectangle(t,e,o,i){this.init(new Point(t||0,e||0),new Point(o||0,i||0))}function Node(t,e){this.init(t||null,e||[])}function Morph(){this.init()}function ShadowMorph(){this.init()}function HandleMorph(t,e,o,i,n,r){this.init(t,e,o,i,n,r)}function PenMorph(){this.init()}function ColorPaletteMorph(t,e){this.init(t||null,e||new Point(80,50))}function GrayPaletteMorph(t,e){this.init(t||null,e||new Point(80,10))}function ColorPickerMorph(t){this.init(t||new Color(255,255,255))}function BlinkerMorph(t){this.init(t)}function CursorMorph(t){this.init(t)}function BoxMorph(t,e,o){this.init(t,e,o)}function SpeechBubbleMorph(t,e,o,i,n,r,s){this.init(t,e,o,i,n,r,s)}function DialMorph(t,e,o,i,n){this.init(t,e,o,i,n)}function CircleBoxMorph(t){this.init(t||"vertical")}function SliderButtonMorph(t){this.init(t)}function SliderMorph(t,e,o,i,n,r){this.init(t||1,e||100,o||50,i||10,n||"vertical",r)}function MouseSensorMorph(t,e,o){this.init(t,e,o)}function InspectorMorph(t){this.init(t)}function MenuMorph(t,e,o,i){this.init(t,e,o,i)}function StringMorph(t,e,o,i,n,r,s,h,a,l){this.init(t,e,o,i,n,r,s,h,a,l)}function TextMorph(t,e,o,i,n,r,s,h,a,l){this.init(t,e,o,i,n,r,s,h,a,l)}function TriggerMorph(t,e,o,i,n,r,s,h,a,l,c){this.init(t,e,o,i,n,r,s,h,a,l,c)}function MenuItemMorph(t,e,o,i,n,r,s,h,a,l,c,u){this.shortcutString=u||null,this.shortcut=null,this.init(t,e,o,i,n,r,s,h,a,l,c)}function FrameMorph(t){this.init(t)}function ScrollFrameMorph(t,e,o){this.init(t,e,o)}function ListMorph(t,e,o,i){this.init(t||[],e||function(t){return isString(t)?t:t.toSource?t.toSource():t.toString()},o||[],i)}function StringFieldMorph(t,e,o,i,n,r,s){this.init(t||"",e||100,o||12,i||"sans-serif",n||!1,r||!1,s)}function BouncerMorph(){this.init()}function HandMorph(t){this.init(t)}function WorldMorph(t,e){this.init(t,e)}enableRetinaSupport(),Animation.prototype.easings={linear:function(t){return t},sinusoidal:function(t){return 1-Math.cos(radians(90*t))},quadratic:function(t){return t<.5?2*t*t:(4-2*t)*t-1},cubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},elastic:function(t){return(t-=.5)<0?(.01+.01/t)*Math.sin(50*t):(.02-.01/t)*Math.sin(50*t)+1},sine_in:function(t){return 1-Math.sin(radians(90+90*t))},quad_in:function(t){return t*t},cubic_in:function(t){return t*t*t},elastic_in:function(t){return(.04-.04/t)*Math.sin(25*t)+1},sine_out:function(t){return Math.sin(radians(90*t))},quad_out:function(t){return t*(2-t)},elastic_out:function(t){return.04*t/--t*Math.sin(25*t)}},Animation.prototype.start=function(){this.endTime=Date.now()+this.duration,this.destination=this.getter.call(this)+this.delta,this.isActive=!0},Animation.prototype.step=function(){if(this.isActive){var t=Date.now();t>this.endTime?(this.setter(this.destination),this.isActive=!1,this.onComplete&&this.onComplete()):this.setter(this.destination-this.delta*this.easing((this.endTime-t)/this.duration))}},Color.prototype.toString=function(){return"rgba("+Math.round(this.r)+","+Math.round(this.g)+","+Math.round(this.b)+","+this.a+")"},Color.prototype.toRGBstring=function(){return"rgb("+Math.round(this.r)+","+Math.round(this.g)+","+Math.round(this.b)+")"},Color.fromString=function(t){var e=t.split(/[\(),]/).slice(1,5);return new Color(e[0],e[1],e[2],e[3])},Color.prototype.copy=function(){return new Color(this.r,this.g,this.b,this.a)},Color.prototype.eq=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b},Color.prototype.hsv=function(){var t,e,o,i,n,r,s=this.r/255,h=this.g/255,a=this.b/255;if(o=t=Math.max(s,h,a),t,n=t,r=t-(e=Math.min(s,h,a)),i=0===t?0:r/t,t===e)o=0;else{switch(t){case s:o=(h-a)/r+(h<a?6:0);break;case h:o=(a-s)/r+2;break;case a:o=(s-h)/r+4}o/=6}return[o,i,n]},Color.prototype.set_hsv=function(t,e,o){var i,n,r,s,h;switch(r=o*(1-e),s=o*(1-(n=6*t-(i=Math.floor(6*t)))*e),h=o*(1-(1-n)*e),i%6){case 0:this.r=o,this.g=h,this.b=r;break;case 1:this.r=s,this.g=o,this.b=r;break;case 2:this.r=r,this.g=o,this.b=h;break;case 3:this.r=r,this.g=s,this.b=o;break;case 4:this.r=h,this.g=r,this.b=o;break;case 5:this.r=o,this.g=r,this.b=s}this.r*=255,this.g*=255,this.b*=255},Color.prototype.mixed=function(t,e){var o=Math.min(Math.max(t,0),1),i=1-o;return new Color(this.r*o+e.r*i,this.g*o+e.g*i,this.b*o+e.b*i)},Color.prototype.darker=function(t){var e=.8333;return t&&(e=(100-t)/100),this.mixed(e,new Color(0,0,0))},Color.prototype.lighter=function(t){var e=.8333;return t&&(e=(100-t)/100),this.mixed(e,new Color(255,255,255))},Color.prototype.dansDarker=function(){var t=this.hsv(),e=new Color,o=Math.max(t[2]-.16,0);return e.set_hsv(t[0],t[1],o),e},Color.prototype.inverted=function(){return new Color(255-this.r,255-this.g,255-this.b)},Point.prototype.toString=function(){return Math.round(this.x.toString())+"@"+Math.round(this.y.toString())},Point.prototype.copy=function(){return new Point(this.x,this.y)},Point.prototype.eq=function(t){return this.x===t.x&&this.y===t.y},Point.prototype.lt=function(t){return this.x<t.x&&this.y<t.y},Point.prototype.gt=function(t){return this.x>t.x&&this.y>t.y},Point.prototype.ge=function(t){return this.x>=t.x&&this.y>=t.y},Point.prototype.le=function(t){return this.x<=t.x&&this.y<=t.y},Point.prototype.max=function(t){return new Point(Math.max(this.x,t.x),Math.max(this.y,t.y))},Point.prototype.min=function(t){return new Point(Math.min(this.x,t.x),Math.min(this.y,t.y))},Point.prototype.round=function(){return new Point(Math.round(this.x),Math.round(this.y))},Point.prototype.abs=function(){return new Point(Math.abs(this.x),Math.abs(this.y))},Point.prototype.neg=function(){return new Point(-this.x,-this.y)},Point.prototype.mirror=function(){return new Point(this.y,this.x)},Point.prototype.floor=function(){return new Point(Math.max(Math.floor(this.x),0),Math.max(Math.floor(this.y),0))},Point.prototype.ceil=function(){return new Point(Math.ceil(this.x),Math.ceil(this.y))},Point.prototype.add=function(t){return t instanceof Point?new Point(this.x+t.x,this.y+t.y):new Point(this.x+t,this.y+t)},Point.prototype.subtract=function(t){return t instanceof Point?new Point(this.x-t.x,this.y-t.y):new Point(this.x-t,this.y-t)},Point.prototype.multiplyBy=function(t){return t instanceof Point?new Point(this.x*t.x,this.y*t.y):new Point(this.x*t,this.y*t)},Point.prototype.divideBy=function(t){return t instanceof Point?new Point(this.x/t.x,this.y/t.y):new Point(this.x/t,this.y/t)},Point.prototype.floorDivideBy=function(t){return t instanceof Point?new Point(Math.floor(this.x/t.x),Math.floor(this.y/t.y)):new Point(Math.floor(this.x/t),Math.floor(this.y/t))},Point.prototype.r=function(){var t=this.multiplyBy(this);return Math.sqrt(t.x+t.y)},Point.prototype.degrees=function(){var t,e;return 0===this.x?this.y>=0?90:270:(t=this.y/this.x,e=Math.atan(t),this.x>=0?this.y>=0?degrees(e):360+degrees(e):180+degrees(e))},Point.prototype.theta=function(){var t,e;return 0===this.x?this.y>=0?radians(90):radians(270):(t=this.y/this.x,e=Math.atan(t),this.x>=0?this.y>=0?e:radians(360)+e:radians(180)+e)},Point.prototype.crossProduct=function(t){return this.multiplyBy(t.mirror())},Point.prototype.distanceTo=function(t){return t.subtract(this).r()},Point.prototype.rotate=function(t,e){var o=this.subtract(e);return"right"===t?new Point(-o.y,o.y).add(e):"left"===t?new Point(o.y,-o.y).add(e):e.subtract(o)},Point.prototype.flip=function(t,e){return"vertical"===t?new Point(this.x,2*e.y-this.y):new Point(2*e.x-this.x,this.y)},Point.prototype.distanceAngle=function(t,e){var o,i,n=e;return n>270?n-=360:n<-270&&(n+=360),-90<=n&&n<=90?(o=Math.sin(radians(n))*t,i=Math.sqrt(t*t-o*o),new Point(o+this.x,this.y-i)):(o=Math.sin(radians(180-n))*t,i=Math.sqrt(t*t-o*o),new Point(o+this.x,this.y+i))},Point.prototype.scaleBy=function(t){return this.multiplyBy(t)},Point.prototype.translateBy=function(t){return this.add(t)},Point.prototype.rotateBy=function(t,e){var o=e||new Point(0,0),i=this.subtract(o),n=i.r(),r=t-i.theta();return new Point(o.x+n*Math.cos(r),o.y-n*Math.sin(r))},Point.prototype.asArray=function(){return[this.x,this.y]},Rectangle.prototype.init=function(t,e){this.origin=t,this.corner=e},Rectangle.prototype.toString=function(){return"["+this.origin.toString()+" | "+this.extent().toString()+"]"},Rectangle.prototype.copy=function(){return new Rectangle(this.left(),this.top(),this.right(),this.bottom())},Point.prototype.corner=function(t){return new Rectangle(this.x,this.y,t.x,t.y)},Point.prototype.rectangle=function(t){var e,o;return e=this.min(t),o=this.max(t),new Rectangle(e.x,e.y,o.x,o.y)},Point.prototype.extent=function(t){var e=this.add(t);return new Rectangle(this.x,this.y,e.x,e.y)},Rectangle.prototype.setTo=function(t,e,o,i){this.origin=new Point(t||(0===t?0:this.left()),e||(0===e?0:this.top())),this.corner=new Point(o||(0===o?0:this.right()),i||(0===i?0:this.bottom()))},Rectangle.prototype.area=function(){var t=this.width();return t<0?0:Math.max(t*this.height(),0)},Rectangle.prototype.bottom=function(){return this.corner.y},Rectangle.prototype.bottomCenter=function(){return new Point(this.center().x,this.bottom())},Rectangle.prototype.bottomLeft=function(){return new Point(this.origin.x,this.corner.y)},Rectangle.prototype.bottomRight=function(){return this.corner.copy()},Rectangle.prototype.boundingBox=function(){return this},Rectangle.prototype.center=function(){return this.origin.add(this.corner.subtract(this.origin).floorDivideBy(2))},Rectangle.prototype.corners=function(){return[this.origin,this.bottomLeft(),this.corner,this.topRight()]},Rectangle.prototype.extent=function(){return this.corner.subtract(this.origin)},Rectangle.prototype.height=function(){return this.corner.y-this.origin.y},Rectangle.prototype.left=function(){return this.origin.x},Rectangle.prototype.leftCenter=function(){return new Point(this.left(),this.center().y)},Rectangle.prototype.right=function(){return this.corner.x},Rectangle.prototype.rightCenter=function(){return new Point(this.right(),this.center().y)},Rectangle.prototype.top=function(){return this.origin.y},Rectangle.prototype.topCenter=function(){return new Point(this.center().x,this.top())},Rectangle.prototype.topLeft=function(){return this.origin},Rectangle.prototype.topRight=function(){return new Point(this.corner.x,this.origin.y)},Rectangle.prototype.width=function(){return this.corner.x-this.origin.x},Rectangle.prototype.position=function(){return this.origin},Rectangle.prototype.eq=function(t){return this.origin.eq(t.origin)&&this.corner.eq(t.corner)},Rectangle.prototype.abs=function(){var t,e;return t=this.origin.abs(),e=this.corner.max(t),t.corner(e)},Rectangle.prototype.insetBy=function(t){var e=new Rectangle;return e.origin=this.origin.add(t),e.corner=this.corner.subtract(t),e},Rectangle.prototype.expandBy=function(t){var e=new Rectangle;return e.origin=this.origin.subtract(t),e.corner=this.corner.add(t),e},Rectangle.prototype.growBy=function(t){var e=new Rectangle;return e.origin=this.origin.copy(),e.corner=this.corner.add(t),e},Rectangle.prototype.intersect=function(t){var e=new Rectangle;return e.origin=this.origin.max(t.origin),e.corner=this.corner.min(t.corner),e},Rectangle.prototype.merge=function(t){var e=new Rectangle;return e.origin=this.origin.min(t.origin),e.corner=this.corner.max(t.corner),e},Rectangle.prototype.mergeWith=function(t){this.origin=this.origin.min(t.origin),this.corner=this.corner.max(t.corner)},Rectangle.prototype.round=function(){return this.origin.round().corner(this.corner.round())},Rectangle.prototype.spread=function(){return this.origin.floor().corner(this.corner.ceil()).expandBy(1)},Rectangle.prototype.amountToTranslateWithin=function(t){var e=0,o=0;return this.right()>t.right()&&(e=t.right()-this.right()),this.bottom()>t.bottom()&&(o=t.bottom()-this.bottom()),this.left()+e<t.left()&&(e=t.left()-this.left()),this.top()+o<t.top()&&(o=t.top()-this.top()),new Point(e,o)},Rectangle.prototype.containsPoint=function(t){return this.origin.le(t)&&t.lt(this.corner)},Rectangle.prototype.containsRectangle=function(t){return t.origin.gt(this.origin)&&t.corner.lt(this.corner)},Rectangle.prototype.intersects=function(t){var e=t.origin,o=t.corner;return o.x>=this.origin.x&&o.y>=this.origin.y&&e.x<=this.corner.x&&e.y<=this.corner.y},Rectangle.prototype.isNearTo=function(t,e){var o=t.origin,i=t.corner,n=e||0;return i.x+n>=this.origin.x&&i.y+n>=this.origin.y&&o.x-n<=this.corner.x&&o.y-n<=this.corner.y},Rectangle.prototype.scaleBy=function(t){var e=this.origin.multiplyBy(t),o=this.corner.multiplyBy(t);return new Rectangle(e.x,e.y,o.x,o.y)},Rectangle.prototype.translateBy=function(t){var e=this.origin.add(t),o=this.corner.add(t);return new Rectangle(e.x,e.y,o.x,o.y)},Rectangle.prototype.asArray=function(){return[this.left(),this.top(),this.right(),this.bottom()]},Rectangle.prototype.asArray_xywh=function(){return[this.left(),this.top(),this.width(),this.height()]},Node.prototype.init=function(t,e){this.parent=t||null,this.children=e||[]},Node.prototype.toString=function(){return"a Node["+this.children.length.toString()+"]"},Node.prototype.addChild=function(t){this.children.push(t),t.parent=this},Node.prototype.addChildFirst=function(t){this.children.splice(0,null,t),t.parent=this},Node.prototype.removeChild=function(t){var e=this.children.indexOf(t);-1!==e&&this.children.splice(e,1)},Node.prototype.root=function(){return null===this.parent?this:this.parent.root()},Node.prototype.depth=function(){return null===this.parent?0:this.parent.depth()+1},Node.prototype.allChildren=function(){var t=[this];return this.children.forEach((function(e){t=t.concat(e.allChildren())})),t},Node.prototype.forAllChildren=function(t){this.children.length>0&&this.children.forEach((function(e){e.forAllChildren(t)})),t.call(null,this)},Node.prototype.anyChild=function(t){var e;if(t.call(null,this))return!0;for(e=0;e<this.children.length;e+=1)if(this.children[e].anyChild(t))return!0;return!1},Node.prototype.allLeafs=function(){var t=[];return this.allChildren().forEach((function(e){0===e.children.length&&t.push(e)})),t},Node.prototype.allParents=function(){var t=[this];return null!==this.parent&&(t=t.concat(this.parent.allParents())),t},Node.prototype.siblings=function(){var t=this;return null===this.parent?[]:this.parent.children.filter((function(e){return e!==t}))},Node.prototype.parentThatIsA=function(t){return this instanceof t?this:this.parent?this.parent.parentThatIsA(t):null},Node.prototype.parentThatIsAnyOf=function(t){var e=!1,o=this;return t.forEach((function(t){o.constructor!==t||(e=!0)})),e?this:this.parent?this.parent.parentThatIsAnyOf(t):null},Morph.prototype=new Node,Morph.prototype.constructor=Morph,Morph.uber=Node.prototype,Morph.prototype.trackChanges=!0,Morph.prototype.shadowBlur=4,Morph.prototype.init=function(t){Morph.uber.init.call(this),this.isMorph=!0,this.image=null,this.bounds=new Rectangle(0,0,50,40),this.cachedFullImage=null,this.cachedFullBounds=null,this.color=new Color(80,80,80),this.texture=null,this.cachedTexture=null,this.alpha=1,this.isVisible=!0,this.isDraggable=!1,this.isTemplate=!1,this.acceptsDrops=!1,this.noticesTransparentClick=!1,t||this.drawNew(),this.fps=0,this.customContextMenu=null,this.lastTime=Date.now(),this.onNextStep=null},Morph.prototype.toString=function(){return"a "+(this.constructor.name||this.constructor.toString().split(" ")[1].split("(")[0])+" "+this.children.length.toString()+" "+this.bounds},Morph.prototype.destroy=function(){null!==this.parent&&(this.fullChanged(),this.parent.removeChild(this))},Morph.prototype.stepFrame=function(){if(!this.step)return null;var t,e,o;e=(t=Date.now())-this.lastTime,(this.fps>0?1e3/this.fps-e:0)<1&&(this.lastTime=t,this.onNextStep&&(o=this.onNextStep,this.onNextStep=null,o.call(this)),this.step(),this.children.forEach((function(t){t.stepFrame()})))},Morph.prototype.nextSteps=function(t){var e=t||[],o=e.shift(),i=this;o&&(this.onNextStep=function(){o.call(i),i.nextSteps(e)})},Morph.prototype.step=nop,Morph.prototype.left=function(){return this.bounds.left()},Morph.prototype.right=function(){return this.bounds.right()},Morph.prototype.top=function(){return this.bounds.top()},Morph.prototype.bottom=function(){return this.bounds.bottom()},Morph.prototype.center=function(){return this.bounds.center()},Morph.prototype.bottomCenter=function(){return this.bounds.bottomCenter()},Morph.prototype.bottomLeft=function(){return this.bounds.bottomLeft()},Morph.prototype.bottomRight=function(){return this.bounds.bottomRight()},Morph.prototype.boundingBox=function(){return this.bounds},Morph.prototype.corners=function(){return this.bounds.corners()},Morph.prototype.leftCenter=function(){return this.bounds.leftCenter()},Morph.prototype.rightCenter=function(){return this.bounds.rightCenter()},Morph.prototype.topCenter=function(){return this.bounds.topCenter()},Morph.prototype.topLeft=function(){return this.bounds.topLeft()},Morph.prototype.topRight=function(){return this.bounds.topRight()},Morph.prototype.position=function(){return this.bounds.origin},Morph.prototype.extent=function(){return this.bounds.extent()},Morph.prototype.width=function(){return this.bounds.width()},Morph.prototype.height=function(){return this.bounds.height()},Morph.prototype.fullBounds=function(){var t;return t=this.bounds,this.children.forEach((function(e){e.isVisible&&(t=t.merge(e.fullBounds()))})),t},Morph.prototype.fullBoundsNoShadow=function(){var t;return t=this.bounds,this.children.forEach((function(e){e instanceof ShadowMorph||!e.isVisible||(t=t.merge(e.fullBounds()))})),t},Morph.prototype.visibleBounds=function(){var t=this.bounds;return this.allParents().filter((function(t){return t instanceof FrameMorph})).forEach((function(e){t=t.intersect(e.bounds)})),t},Morph.prototype.moveBy=function(t){this.fullChanged(),this.silentMoveBy(t),this.fullChanged()},Morph.prototype.silentMoveBy=function(t){var e=this.children,o=e.length;for(this.bounds=this.bounds.translateBy(t),this.cachedFullBounds&&(this.cachedFullBounds=this.cachedFullBounds.translateBy(t));o>0;o-=1)e[o-1].silentMoveBy(t)},Morph.prototype.setPosition=function(t){var e=t.subtract(this.topLeft());0===e.x&&0===e.y||this.moveBy(e)},Morph.prototype.silentSetPosition=function(t){var e=t.subtract(this.topLeft());0===e.x&&0===e.y||this.silentMoveBy(e)},Morph.prototype.setLeft=function(t){this.setPosition(new Point(t,this.top()))},Morph.prototype.setRight=function(t){this.setPosition(new Point(t-this.width(),this.top()))},Morph.prototype.setTop=function(t){this.setPosition(new Point(this.left(),t))},Morph.prototype.setBottom=function(t){this.setPosition(new Point(this.left(),t-this.height()))},Morph.prototype.setCenter=function(t){this.setPosition(t.subtract(this.extent().floorDivideBy(2)))},Morph.prototype.setFullCenter=function(t){this.setPosition(t.subtract(this.fullBounds().extent().floorDivideBy(2)))},Morph.prototype.keepWithin=function(t){var e,o,i,n;(o=this.fullBounds().right()-t.right())>0&&this.moveBy(new Point(-o,0)),(e=this.fullBounds().left()-t.left())<0&&this.moveBy(new Point(-e,0)),(n=this.fullBounds().bottom()-t.bottom())>0&&this.moveBy(new Point(0,-n)),(i=this.fullBounds().top()-t.top())<0&&this.moveBy(new Point(0,-i))},Morph.prototype.scrollIntoView=function(){var t,e,o,i,n=this.parentThatIsA(ScrollFrameMorph);n&&((e=Math.min(this.fullBounds().right()-n.right(),n.contents.right()-n.right()))>0&&n.contents.moveBy(new Point(-e,0)),(t=this.fullBounds().left()-n.left())<0&&n.contents.moveBy(new Point(-t,0)),(o=this.fullBounds().top()-n.top())<0&&n.contents.moveBy(new Point(0,-o)),(i=this.fullBounds().bottom()-n.bottom())>0&&n.contents.moveBy(new Point(0,-i)),n.adjustScrollBars())},Morph.prototype.setExtent=function(t,e){e?this.silentSetExtent(t):t.eq(this.extent())||(this.changed(),this.silentSetExtent(t),this.changed(),this.drawNew())},Morph.prototype.silentSetExtent=function(t){var e,o,i;e=t.round(),o=Math.max(e.x,0),i=Math.max(e.y,0),this.bounds.corner=new Point(this.bounds.origin.x+o,this.bounds.origin.y+i)},Morph.prototype.setWidth=function(t){this.setExtent(new Point(t||0,this.height()))},Morph.prototype.silentSetWidth=function(t){var e=Math.max(Math.round(t||0),0);this.bounds.corner=new Point(this.bounds.origin.x+e,this.bounds.corner.y)},Morph.prototype.setHeight=function(t){this.setExtent(new Point(this.width(),t||0))},Morph.prototype.silentSetHeight=function(t){var e=Math.max(Math.round(t||0),0);this.bounds.corner=new Point(this.bounds.corner.x,this.bounds.origin.y+e)},Morph.prototype.setColor=function(t){t&&(this.color.eq(t)||(this.color=t,this.changed(),this.drawNew()))},Morph.prototype.drawNew=function(){this.image=newCanvas(this.extent());var t=this.image.getContext("2d");t.fillStyle=this.color.toString(),t.fillRect(0,0,this.width(),this.height()),this.cachedTexture?this.drawCachedTexture():this.texture&&this.drawTexture(this.texture)},Morph.prototype.drawTexture=function(t){var e=this;this.cachedTexture=new Image,this.cachedTexture.onload=function(){e.drawCachedTexture()},this.cachedTexture.src=this.texture=t},Morph.prototype.drawCachedTexture=function(){var t,e,o=this.cachedTexture,i=Math.floor(this.image.width/o.width),n=Math.floor(this.image.height/o.height),r=this.image.getContext("2d");for(e=0;e<=n;e+=1)for(t=0;t<=i;t+=1)r.drawImage(o,t*o.width,e*o.height);this.changed()},Morph.prototype.drawOn=function(t,e){var o,i,n,r,s,h,a,l,c=this.cachedFullImage||this.image,u=this.cachedFullBounds||this.bounds;if(!this.isVisible)return null;if((o=(e||u).intersect(u)).extent().gt(new Point(0,0))){if(i=u.position().neg(),n=o.copy().translateBy(i),(r=t.getContext("2d")).globalAlpha=this.alpha,a=n.left(),l=n.top(),s=Math.min(n.width(),c.width-a),h=Math.min(n.height(),c.height-l),s<1||h<1)return null;r.drawImage(c,a,l,s,h,o.left(),o.top(),s,h)}},Morph.prototype.fullDrawOn=function(t,e){var o;if(!this.isVisible)return null;o=e||this.cachedFullBounds||this.fullBounds(),this.drawOn(t,o),this.cachedFullImage||this.children.forEach((function(e){e.fullDrawOn(t,o)}))},Morph.prototype.hide=function(){this.isVisible=!1,this.changed(),this.children.forEach((function(t){t.hide()}))},Morph.prototype.show=function(){this.isVisible=!0,this.changed(),this.children.forEach((function(t){t.show()}))},Morph.prototype.toggleVisibility=function(){this.isVisible=!this.isVisible,this.changed(),this.children.forEach((function(t){t.toggleVisibility()}))},Morph.prototype.fullImageClassic=function(){var t=this.cachedFullBounds||this.fullBounds(),e=newCanvas(t.extent());return e.getContext("2d").translate(-t.origin.x,-t.origin.y),this.fullDrawOn(e,t),e.globalAlpha=this.alpha,e},Morph.prototype.fullImage=function(){var t,e,o;return t=newCanvas(this.fullBounds().extent()),e=t.getContext("2d"),o=this.fullBounds(),this.allChildren().forEach((function(t){t.isVisible&&(e.globalAlpha=t.alpha,t.image.width&&t.image.height&&e.drawImage(t.image,t.bounds.origin.x-o.origin.x,t.bounds.origin.y-o.origin.y))})),t},Morph.prototype.shadowImage=function(t,e){var o,i,n,r,s,h=t||new Point(7,7),a=e||new Color(0,0,0);return o=this.fullBounds().extent(),i=this.fullImage(),(s=(n=newCanvas(o)).getContext("2d")).drawImage(i,0,0),s.globalCompositeOperation="destination-out",s.drawImage(i,-h.x,-h.y),(s=(r=newCanvas(o)).getContext("2d")).drawImage(n,0,0),s.globalCompositeOperation="source-atop",s.fillStyle=a.toString(),s.fillRect(0,0,o.x,o.y),r},Morph.prototype.shadowImageBlurred=function(t,e){var o,i,n,r,s=t||new Point(7,7),h=this.shadowBlur,a=e||new Color(0,0,0);return o=this.fullBounds().extent().add(2*h),i=this.fullImage(),(r=(n=newCanvas(o)).getContext("2d")).shadowOffsetX=s.x,r.shadowOffsetY=s.y,r.shadowBlur=h,r.shadowColor=a.toString(),r.drawImage(i,h-s.x,h-s.y),r.shadowOffsetX=0,r.shadowOffsetY=0,r.shadowBlur=0,r.globalCompositeOperation="destination-out",r.drawImage(i,h-s.x,h-s.y),n},Morph.prototype.shadow=function(t,e,o){var i=new ShadowMorph,n=t||new Point(7,7),r=e||(0===e?0:.2),s=this.fullBounds();return i.setExtent(s.extent().add(2*this.shadowBlur)),useBlurredShadows&&!MorphicPreferences.isFlat?(i.image=this.shadowImageBlurred(n,o),i.alpha=r,i.setPosition(s.origin.add(n).subtract(this.shadowBlur))):(i.image=this.shadowImage(n,o),i.alpha=r,i.setPosition(s.origin.add(n))),i},Morph.prototype.addShadow=function(t,e,o){var i,n=t||new Point(7,7),r=e||(0===e?0:.2);return i=this.shadow(n,r,o),this.addBack(i),this.fullChanged(),i},Morph.prototype.getShadow=function(){var t;return 0!==(t=this.children.slice(0).reverse().filter((function(t){return t instanceof ShadowMorph}))).length?t[0]:null},Morph.prototype.removeShadow=function(){var t=this.getShadow();null!==t&&(this.fullChanged(),this.removeChild(t))},Morph.prototype.penTrails=function(){return this.image},Morph.prototype.changed=function(){if(this.trackChanges){var t=this.root();t instanceof WorldMorph&&t.broken.push(this.visibleBounds().spread())}this.parent&&this.parent.childChanged(this)},Morph.prototype.fullChanged=function(){if(this.trackChanges){var t=this.root();t instanceof WorldMorph&&t.broken.push((this.cachedFullBounds||this.fullBounds()).spread())}},Morph.prototype.childChanged=function(){this.parent&&this.parent.childChanged(this)},Morph.prototype.world=function(){var t=this.root();return t instanceof WorldMorph?t:t instanceof HandMorph?t.world:null},Morph.prototype.add=function(t){var e=t.parent;null!==e&&e.removeChild(t),this.addChild(t)},Morph.prototype.addBack=function(t){var e=t.parent;null!==e&&e.removeChild(t),this.addChildFirst(t)},Morph.prototype.topMorphAt=function(t){var e,o;if(!this.isVisible)return null;for(e=this.children.length-1;e>=0;e-=1)if(o=this.children[e].topMorphAt(t))return o;return!this.bounds.containsPoint(t)||!this.noticesTransparentClick&&this.isTransparentAt(t)?null:this},Morph.prototype.topMorphSuchThat=function(t){var e;return t.call(null,this)?(e=detect(this.children.slice(0).reverse(),t))?e.topMorphSuchThat(t):this:null},Morph.prototype.overlappedMorphs=function(){var t=this.world(),e=this.fullBounds(),o=this,i=this.allParents(),n=this.allChildren();return t.allChildren().filter((function(r){return r.isVisible&&r!==o&&r!==t&&!contains(i,r)&&!contains(n,r)&&r.fullBounds().intersects(e)}))},Morph.prototype.getPixelColor=function(t){var e,o;return e=t.subtract(this.bounds.origin),new Color((o=this.image.getContext("2d").getImageData(e.x,e.y,1,1)).data[0],o.data[1],o.data[2],o.data[3]/255)},Morph.prototype.isTransparentAt=function(t){var e;return!!this.bounds.containsPoint(t)&&(!this.texture&&(e=t.subtract(this.bounds.origin),0===this.image.getContext("2d").getImageData(Math.floor(e.x),Math.floor(e.y),1,1).data[3]))},Morph.prototype.copy=function(){var t=copy(this);return t.parent=null,t.children=[],t.bounds=this.bounds.copy(),t},Morph.prototype.fullCopy=function(){var t,e=new Map;return(t=this.copyRecordingReferences(e)).forAllChildren((function(t){t.updateReferences(e)})),t},Morph.prototype.copyRecordingReferences=function(t){var e=this.copy();return t.set(this,e),this.children.forEach((function(o){e.add(o.copyRecordingReferences(t))})),e},Morph.prototype.updateReferences=function(t){var e,o,i,n,r=Object.keys(this),s=r.length;for(n=0;n<s;n+=1)(o=this[e=r[n]])&&o.isMorph&&(i=t.get(o))&&(this[e]=i)},Morph.prototype.rootForGrab=function(){return this instanceof ShadowMorph?this.parent.rootForGrab():this.parent instanceof ScrollFrameMorph?this.parent:null===this.parent||this.parent instanceof WorldMorph||this.parent instanceof FrameMorph||!0===this.isDraggable?this:this.parent.rootForGrab()},Morph.prototype.isCorrectingOutsideDrag=function(){return!0},Morph.prototype.wantsDropOf=function(t){return!(t instanceof HandleMorph||t instanceof MenuMorph||t instanceof InspectorMorph)&&this.acceptsDrops},Morph.prototype.pickUp=function(t){var e=t||this.world();this.setPosition(e.hand.position().subtract(this.extent().floorDivideBy(2))),e.hand.grab(this)},Morph.prototype.isPickedUp=function(){return null!==this.parentThatIsA(HandMorph)},Morph.prototype.situation=function(){return this.parent?{origin:this.parent,position:this.position().subtract(this.parent.position())}:null},Morph.prototype.slideBackTo=function(t,e,o,i){var n=t.origin.position().add(t.position),r=this;this.glideTo(n,e,null,(function(){t.origin.add(r),o&&o(),r.justDropped&&r.justDropped(),t.origin.reactToDropOf&&t.origin.reactToDropOf(r),i&&i()}))},Morph.prototype.glideTo=function(t,e,o,i){var n=this.world(),r=this;n.animations.push(new Animation((function(t){r.setLeft(t)}),(function(){return r.left()}),-(this.left()-t.x),e||100,o,i)),n.animations.push(new Animation((function(t){r.setTop(t)}),(function(){return r.top()}),-(this.top()-t.y),e||100,o))},Morph.prototype.fadeTo=function(t,e,o,i){var n=this.world(),r=this,s=this.alpha;this.children.forEach((function(i){i.fadeTo(t,e,o)})),n.animations.push(new Animation((function(t){r.alpha=t,r.changed()}),(function(){return r.alpha}),t-this.alpha,e||200,o,(function(){r.alpha=s,i&&i()})))},Morph.prototype.perish=function(t,e){var o=this;this.fadeTo(0,t||100,null,(function(){o.destroy(),e&&e()}))},Morph.prototype.nop=nop,Morph.prototype.resize=function(){this.world().activeHandle=new HandleMorph(this)},Morph.prototype.move=function(){this.world().activeHandle=new HandleMorph(this,null,null,null,null,"move")},Morph.prototype.moveCenter=function(){this.world().activeHandle=new HandleMorph(this,null,null,null,null,"moveCenter")},Morph.prototype.hint=function(t){var e,o;o=t,t?t.toString&&(o=t.toString()):o="NULL",(e=new MenuMorph(this,o)).isDraggable=!0,e.popUpCenteredAtHand(this.world())},Morph.prototype.inform=function(t){var e,o;o=t,t?t.toString&&(o=t.toString()):o="NULL",(e=new MenuMorph(this,o)).addItem("Ok"),e.isDraggable=!0,e.popUpCenteredAtHand(this.world())},Morph.prototype.prompt=function(t,e,o,i,n,r,s,h){var a,l,c,u;s&&(u=!0),a=new MenuMorph(e||null,t||"",o||null),l=new StringFieldMorph(i||"",n||100,MorphicPreferences.prompterFontSize,MorphicPreferences.prompterFontName,!1,!1,u),a.items.push(l),(s||MorphicPreferences.useSliderForInput)&&((c=new SliderMorph(r||0,s,parseFloat(i),Math.floor((s-r)/4),"horizontal")).alpha=1,c.color=new Color(225,225,225),c.button.color=a.borderColor,c.button.highlightColor=c.button.color.copy(),c.button.highlightColor.b+=100,c.button.pressColor=c.button.color.copy(),c.button.pressColor.b+=150,c.setHeight(MorphicPreferences.prompterSliderSize),c.action=h?function(t){l.changed(),l.text.text=Math.round(t).toString(),l.text.drawNew(),l.text.changed(),l.text.edit()}:function(t){l.changed(),l.text.text=t.toString(),l.text.drawNew(),l.text.changed()},a.items.push(c)),a.addLine(2),a.addItem("Ok",(function(){return l.string()})),a.addItem("Cancel",(function(){return null})),a.isDraggable=!0,a.popUpAtHand(this.world()),l.text.edit()},Morph.prototype.pickColor=function(t,e,o,i){var n,r;n=new MenuMorph(e||null,t||"",o||null),r=new ColorPickerMorph(i),n.items.push(r),n.addLine(2),n.addItem("Ok",(function(){return r.getChoice()})),n.addItem("Cancel",(function(){return null})),n.isDraggable=!0,n.popUpAtHand(this.world())},Morph.prototype.inspect=function(t){var e,o=this.world instanceof Function?this.world():this.root()||this.world,i=this;t&&(i=t),(e=new InspectorMorph(i)).setPosition(o.hand.position()),e.keepWithin(o),o.add(e),e.changed()},Morph.prototype.contextMenu=function(){var t;return this.customContextMenu?this.customContextMenu:(t=this.world instanceof Function?this.world():this.world)&&t.isDevMode?this.parent===t?this.developersMenu():this.hierarchyMenu():this.userMenu()||this.parent&&this.parent.userMenu()},Morph.prototype.hierarchyMenu=function(){var t=this.allParents(),e=this.world instanceof Function?this.world():this.world,o=new MenuMorph(this,null);return t.forEach((function(t){t.developersMenu&&t!==e&&o.addMenu(t.toString().slice(0,50),t.developersMenu())})),o},Morph.prototype.developersMenu=function(){var t=this.world instanceof Function?this.world():this.world,e=this.userMenu()||this.parent&&this.parent.userMenu(),o=new MenuMorph(this,this.constructor.name||this.constructor.toString().split(" ")[1].split("(")[0]);return e&&(o.addMenu("user features",e),o.addLine()),o.addItem("color...",(function(){this.pickColor(o.title+localize("\ncolor:"),this.setColor,this,this.color)}),"choose another color \nfor this morph.js"),o.addItem("transparency...",(function(){this.prompt(o.title+localize("\nalpha\nvalue:"),this.setAlphaScaled,this,(100*this.alpha).toString(),null,1,100,!0)}),"set this morph.js's\nalpha value"),o.addItem("resize...","resize","show a handle\nwhich can be dragged\nto change this morph.js's extent"),o.addLine(),o.addItem("duplicate",(function(){this.fullCopy().pickUp(this.world())}),"make a copy\nand pick it up"),o.addItem("pick up","pickUp","detach and put \ninto the hand"),o.addItem("attach...","attach","stick this morph.js\nto another one"),o.addItem("move...","move","show a handle\nwhich can be dragged\nto move this morph.js"),o.addItem("inspect...","inspect","open a window\non all properties"),o.addItem("pic...",(function(){window.open(this.fullImageClassic().toDataURL())}),"open a new window\nwith a picture of this morph.js"),o.addLine(),this.isDraggable?o.addItem("lock","toggleIsDraggable","make this morph.js\nunmovable"):o.addItem("unlock","toggleIsDraggable","make this morph.js\nmovable"),o.addItem("hide","hide"),o.addItem("delete","destroy"),this instanceof WorldMorph||(o.addLine(),o.addItem("World...",(function(){t.contextMenu().popUpAtHand(t)}),"show the\nWorld's menu")),o},Morph.prototype.userMenu=function(){return null},Morph.prototype.setAlphaScaled=function(t){var e,o;"number"==typeof t?(o=t/100,this.alpha=Math.min(Math.max(o,.1),1)):(e=parseFloat(t),isNaN(e)||(o=e/100,this.alpha=Math.min(Math.max(o,.1),1))),this.changed()},Morph.prototype.attach=function(){var t=this.overlappedMorphs(),e=new MenuMorph(this,"choose new parent:"),o=this;t.forEach((function(t){e.addItem(t.toString().slice(0,50),(function(){t.add(o),o.isDraggable=!1}))})),t.length>0&&e.popUpAtHand(this.world())},Morph.prototype.toggleIsDraggable=function(){this.isDraggable=!this.isDraggable},Morph.prototype.colorSetters=function(){return["color"]},Morph.prototype.numericalSetters=function(){return["setLeft","setTop","setWidth","setHeight","setAlphaScaled"]},Morph.prototype.allEntryFields=function(){return this.allChildren().filter((function(t){return t.isEditable&&(t instanceof StringMorph||t instanceof TextMorph)}))},Morph.prototype.nextEntryField=function(t){var e=this.allEntryFields(),o=e.indexOf(t);return-1!==o&&e.length>o+1?e[o+1]:e[0]},Morph.prototype.previousEntryField=function(t){var e=this.allEntryFields(),o=e.indexOf(t);return-1!==o?o>0?e[o-1]:e[e.length-1]:e[0]},Morph.prototype.tab=function(t){this.nextTab?this.nextTab(t):this.parent&&this.parent.tab(t)},Morph.prototype.backTab=function(t){this.previousTab?this.previousTab(t):this.parent&&this.parent.backTab(t)},Morph.prototype.escalateEvent=function(t,e){for(var o=this.parent;!o[t]&&null!==o.parent;)o=o.parent;o[t]&&o[t](e)},Morph.prototype.evaluateString=function(code){var result;try{result=eval(code),this.drawNew(),this.changed()}catch(t){this.inform(t)}return result},Morph.prototype.isTouching=function(t){var e=this.overlappingImage(t);return!(!e.width||!e.height)&&null!==detect(e.getContext("2d").getImageData(1,1,e.width,e.height).data,(function(t){return 0!==t}))},Morph.prototype.overlappingImage=function(t){var e=this.fullBounds(),o=t.fullBounds(),i=e.intersect(o),n=newCanvas(i.extent()),r=n.getContext("2d");return i.width()<1||i.height()<1?newCanvas(new Point(1,1)):(r.drawImage(this.fullImage(),i.origin.x-e.origin.x,i.origin.y-e.origin.y),r.globalCompositeOperation="source-in",r.drawImage(t.fullImage(),o.origin.x-i.origin.x,o.origin.y-i.origin.y),n)},ShadowMorph.prototype=new Morph,ShadowMorph.prototype.constructor=ShadowMorph,ShadowMorph.uber=Morph.prototype,ShadowMorph.prototype.topMorphAt=function(){return null},HandleMorph.prototype=new Morph,HandleMorph.prototype.constructor=HandleMorph,HandleMorph.uber=Morph.prototype,HandleMorph.prototype.init=function(t,e,o,i,n,r){var s=MorphicPreferences.handleSize;this.target=t||null,this.minExtent=new Point(e||0,o||0),this.inset=new Point(i||0,n||i||0),this.type=r||"resize",HandleMorph.uber.init.call(this),this.color=new Color(255,255,255),this.isDraggable=!1,this.noticesTransparentClick=!0,"movePivot"===this.type&&(s*=2),this.setExtent(new Point(s,s))},HandleMorph.prototype.drawNew=function(){this.normalImage=newCanvas(this.extent()),this.highlightImage=newCanvas(this.extent()),"movePivot"===this.type?(this.drawCrosshairsOnCanvas(this.normalImage,.6),this.drawCrosshairsOnCanvas(this.highlightImage,.5)):(this.drawOnCanvas(this.normalImage,this.color,new Color(100,100,100)),this.drawOnCanvas(this.highlightImage,new Color(100,100,255),new Color(255,255,255))),this.image=this.normalImage,this.target&&("moveCenter"===this.type?this.setCenter(this.target.center()):"movePivot"===this.type?this.setCenter(this.target.rotationCenter()):this.setPosition(this.target.bottomRight().subtract(this.extent().add(this.inset))),this.target.add(this),this.target.changed())},HandleMorph.prototype.drawCrosshairsOnCanvas=function(t,e){var o=t.getContext("2d"),i=t.width/2;o.fillStyle="rgba(255, 255, 255, 0.5)",o.arc(i,i,.9*i,radians(0),radians(360),!1),o.fill(),o.strokeStyle="black",o.lineWidth=1,o.beginPath(),o.arc(i,i,i*e,radians(0),radians(360),!1),o.stroke(),o.moveTo(0,i),o.lineTo(t.width,i),o.stroke(),o.moveTo(i,0),o.lineTo(i,t.height),o.stroke()},HandleMorph.prototype.drawOnCanvas=function(t,e,o){var i,n,r,s,h,a=t.getContext("2d"),l=0===this.type.indexOf("move");if(a.lineWidth=1,a.lineCap="round",a.strokeStyle=e.toString(),l)for(n=(i=this.bottomLeft().subtract(this.position())).copy(),s=(r=this.topRight().subtract(this.position())).copy(),h=0;h<=this.height();h+=6)n.y=i.y-h,s.y=r.y-h,a.beginPath(),a.moveTo(n.x,n.y),a.lineTo(s.x,s.y),a.closePath(),a.stroke();for(n=(i=this.bottomLeft().subtract(this.position())).copy(),s=(r=this.topRight().subtract(this.position())).copy(),h=0;h<=this.width();h+=6)n.x=i.x+h,s.x=r.x+h,a.beginPath(),a.moveTo(n.x,n.y),a.lineTo(s.x,s.y),a.closePath(),a.stroke();if(a.strokeStyle=o.toString(),l)for(n=(i=this.bottomLeft().subtract(this.position())).copy(),s=(r=this.topRight().subtract(this.position())).copy(),h=-2;h<=this.height();h+=6)n.y=i.y-h,s.y=r.y-h,a.beginPath(),a.moveTo(n.x,n.y),a.lineTo(s.x,s.y),a.closePath(),a.stroke();for(n=(i=this.bottomLeft().subtract(this.position())).copy(),s=(r=this.topRight().subtract(this.position())).copy(),h=2;h<=this.width();h+=6)n.x=i.x+h,s.x=r.x+h,a.beginPath(),a.moveTo(n.x,n.y),a.lineTo(s.x,s.y),a.closePath(),a.stroke()},HandleMorph.prototype.step=null,HandleMorph.prototype.mouseDownLeft=function(t){var e,o=this.root(),i=this;if(!this.target)return null;e=0===this.type.indexOf("move")?t.subtract(this.center()):t.subtract(this.bounds.origin),this.step=function(){var t,n;o.hand.mouseButton?(t=o.hand.bounds.origin.copy().subtract(e),"resize"===this.type?(n=(n=t.add(i.extent().add(i.inset)).subtract(i.target.bounds.origin)).max(i.minExtent),i.target.setExtent(n),i.setPosition(i.target.bottomRight().subtract(i.extent().add(i.inset)))):"moveCenter"===this.type?i.target.setCenter(t):"movePivot"===this.type?(i.target.setPivot(t),i.setCenter(this.target.rotationCenter())):i.target.setPosition(t.subtract(this.target.extent()).add(this.extent()))):this.step=null},this.target.step||(this.target.step=function(){nop()})},HandleMorph.prototype.rootForGrab=function(){return this},HandleMorph.prototype.mouseEnter=function(){this.image=this.highlightImage,this.changed()},HandleMorph.prototype.mouseLeave=function(){this.image=this.normalImage,this.changed()},HandleMorph.prototype.attach=function(){var t=this.overlappedMorphs(),e=new MenuMorph(this,"choose target:"),o=this;t.forEach((function(t){e.addItem(t.toString().slice(0,50),(function(){o.isDraggable=!1,o.target=t,o.drawNew(),o.noticesTransparentClick=!0}))})),t.length>0&&e.popUpAtHand(this.world())},PenMorph.prototype=new Morph,PenMorph.prototype.constructor=PenMorph,PenMorph.uber=Morph.prototype,PenMorph.prototype.init=function(){var t=4*MorphicPreferences.handleSize;this.isWarped=!1,this.heading=0,this.isDown=!0,this.size=1,this.wantsRedraw=!1,this.penPoint="tip",this.penBounds=null,HandleMorph.uber.init.call(this),this.setExtent(new Point(t,t))},PenMorph.prototype.changed=function(){if(!1===this.isWarped){var t=this.root();t instanceof WorldMorph&&t.broken.push(this.visibleBounds().spread()),this.parent&&this.parent.childChanged(this)}},PenMorph.prototype.drawNew=function(t){var e,o,i,n,r,s,h=t||this.heading;this.isWarped?this.wantsRedraw=!0:(this.image=newCanvas(this.extent()),e=this.image.getContext("2d"),s=this.width()/2,o=this.center().subtract(this.bounds.origin),"tip"===this.penPoint?(i=o.distanceAngle(.75*s,h-180),n=o.distanceAngle(s,h+195),r=o.distanceAngle(s,h-195)):(i=o.distanceAngle(.75*s,h),n=o.distanceAngle(.33*s,h+230),r=o.distanceAngle(.33*s,h-230)),this.penBounds=new Rectangle(Math.min(o.x,i.x,n.x,r.x),Math.min(o.y,i.y,n.y,r.y),Math.max(o.x,i.x,n.x,r.x),Math.max(o.y,i.y,n.y,r.y)),e.fillStyle=this.color.toString(),e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(n.x,n.y),e.lineTo(i.x,i.y),e.lineTo(r.x,r.y),e.closePath(),e.strokeStyle="white",e.lineWidth=3,e.stroke(),e.strokeStyle="black",e.lineWidth=1,e.stroke(),e.fill())},PenMorph.prototype.setHeading=function(t){this.heading=(+t%360+360)%360,this.drawNew(),this.changed()},PenMorph.prototype.numericalSetters=function(){return["setLeft","setTop","setWidth","setHeight","setAlphaScaled","setHeading"]},PenMorph.prototype.developersMenu=function(){var t=PenMorph.uber.developersMenu.call(this);return t.addLine(),t.addItem("set rotation","setRotation","interactively turn this morph.jsk\nusing a dial widget"),t},PenMorph.prototype.setRotation=function(){var t,e,o=this.name||this.constructor.name;o.length>10&&(o=o.slice(0,9)+"..."),t=new MenuMorph(this,o),(e=new DialMorph(null,null,this.heading)).rootForGrab=function(){return this},e.target=this,e.action="setHeading",t.items.push(e),t.addLine(),t.addItem("(90) right",(function(){this.setHeading(90)})),t.addItem("(-90) left",(function(){this.setHeading(-90)})),t.addItem("(0) up",(function(){this.setHeading(0)})),t.addItem("(180) down",(function(){this.setHeading(180)})),t.isDraggable=!0,t.popUpAtHand(this.world())},PenMorph.prototype.drawLine=function(t,e){var o=this.parent.penTrails().getContext("2d"),i=t.subtract(this.parent.bounds.origin),n=e.subtract(this.parent.bounds.origin);this.isDown&&(o.lineWidth=this.size,o.strokeStyle=this.color.toString(),o.lineCap="round",o.lineJoin="round",o.beginPath(),o.moveTo(i.x,i.y),o.lineTo(n.x,n.y),o.stroke(),!1===this.isWarped&&this.world().broken.push(t.rectangle(e).expandBy(Math.max(this.size/2,1)).intersect(this.parent.visibleBounds()).spread()))},PenMorph.prototype.turn=function(t){this.setHeading(this.heading+parseFloat(t))},PenMorph.prototype.forward=function(t){var e,o=this.center(),i=parseFloat(t);e=i>=0?this.position().distanceAngle(i,this.heading):this.position().distanceAngle(Math.abs(i),this.heading-180),this.setPosition(e),this.drawLine(o,this.center())},PenMorph.prototype.down=function(){this.isDown=!0},PenMorph.prototype.up=function(){this.isDown=!1},PenMorph.prototype.clear=function(){this.parent.drawNew(),this.parent.changed()},PenMorph.prototype.startWarp=function(){this.wantsRedraw=!1,this.isWarped=!0},PenMorph.prototype.endWarp=function(){this.isWarped=!1,this.wantsRedraw&&(this.drawNew(),this.wantsRedraw=!1),this.parent.changed()},PenMorph.prototype.warp=function(t){this.startWarp(),t.call(this),this.endWarp()},PenMorph.prototype.warpOp=function(t,e){this.startWarp(),this[t].apply(this,e),this.endWarp()},PenMorph.prototype.warpSierpinski=function(t,e){this.warpOp("sierpinski",[t,e])},PenMorph.prototype.sierpinski=function(t,e){var o;if(t>e)for(o=0;o<3;o+=1)this.sierpinski(.5*t,e),this.turn(120),this.forward(t)},PenMorph.prototype.warpTree=function(t,e,o){this.warpOp("tree",[t,e,o])},PenMorph.prototype.tree=function(t,e,o){t>0&&(this.size=t,this.forward(e),this.turn(o),this.tree(t-1,.75*e,o),this.turn(-2*o),this.tree(t-1,.75*e,o),this.turn(o),this.forward(-e))},ColorPaletteMorph.prototype=new Morph,ColorPaletteMorph.prototype.constructor=ColorPaletteMorph,ColorPaletteMorph.uber=Morph.prototype,ColorPaletteMorph.prototype.init=function(t,e){ColorPaletteMorph.uber.init.call(this),this.target=t,this.targetSetter="color",this.silentSetExtent(e),this.choice=null,this.drawNew()},ColorPaletteMorph.prototype.drawNew=function(){var t,e,o,i,n,r;for(e=this.extent(),this.image=newCanvas(this.extent()),t=this.image.getContext("2d"),this.choice=new Color,o=0;o<=e.x;o+=1)for(n=360*o/e.x,i=0;i<=e.y;i+=1)r=100-i/e.y*100,t.fillStyle="hsl("+n+",100%,"+r+"%)",t.fillRect(o,i,1,1)},ColorPaletteMorph.prototype.mouseMove=function(t){this.choice=this.getPixelColor(t),this.updateTarget()},ColorPaletteMorph.prototype.mouseDownLeft=function(t){this.choice=this.getPixelColor(t),this.updateTarget()},ColorPaletteMorph.prototype.updateTarget=function(){this.target instanceof Morph&&null!==this.choice&&(this.target[this.targetSetter]instanceof Function?this.target[this.targetSetter](this.choice):(this.target[this.targetSetter]=this.choice,this.target.drawNew(),this.target.changed()))},ColorPaletteMorph.prototype.developersMenu=function(){var t=ColorPaletteMorph.uber.developersMenu.call(this);return t.addLine(),t.addItem("set target","setTarget","choose another morph.jsk\nwhose color property\n will be controlled by this one"),t},ColorPaletteMorph.prototype.setTarget=function(){var t=this.overlappedMorphs(),e=new MenuMorph(this,"choose target:"),o=this;t.push(this.world()),t.forEach((function(t){e.addItem(t.toString().slice(0,50),(function(){o.target=t,o.setTargetSetter()}))})),1===t.length?(this.target=t[0],this.setTargetSetter()):t.length>0&&e.popUpAtHand(this.world())},ColorPaletteMorph.prototype.setTargetSetter=function(){var t=this.target.colorSetters(),e=new MenuMorph(this,"choose target property:"),o=this;t.forEach((function(t){e.addItem(t,(function(){o.targetSetter=t}))})),1===t.length?this.targetSetter=t[0]:t.length>0&&e.popUpAtHand(this.world())},GrayPaletteMorph.prototype=new ColorPaletteMorph,GrayPaletteMorph.prototype.constructor=GrayPaletteMorph,GrayPaletteMorph.uber=ColorPaletteMorph.prototype,GrayPaletteMorph.prototype.drawNew=function(){var t,e,o;e=this.extent(),this.image=newCanvas(this.extent()),t=this.image.getContext("2d"),this.choice=new Color,(o=t.createLinearGradient(0,0,e.x,e.y)).addColorStop(0,"black"),o.addColorStop(1,"white"),t.fillStyle=o,t.fillRect(0,0,e.x,e.y)},ColorPickerMorph.prototype=new Morph,ColorPickerMorph.prototype.constructor=ColorPickerMorph,ColorPickerMorph.uber=Morph.prototype,ColorPickerMorph.prototype.init=function(t){this.choice=t,ColorPickerMorph.uber.init.call(this),this.color=new Color(255,255,255),this.silentSetExtent(new Point(80,80)),this.drawNew()},ColorPickerMorph.prototype.drawNew=function(){ColorPickerMorph.uber.drawNew.call(this),this.buildSubmorphs()},ColorPickerMorph.prototype.buildSubmorphs=function(){var t,e,o,i;this.children.forEach((function(t){t.destroy()})),this.children=[],this.feedback=new Morph,this.feedback.color=this.choice,this.feedback.setExtent(new Point(20,20)),t=new ColorPaletteMorph(this.feedback,new Point(this.width(),50)),e=new GrayPaletteMorph(this.feedback,new Point(this.width(),5)),t.setPosition(this.bounds.origin),this.add(t),e.setPosition(t.bottomLeft()),this.add(e),o=e.left()+Math.floor((e.width()-this.feedback.width())/2),i=e.bottom()+Math.floor((this.bottom()-e.bottom()-this.feedback.height())/2),this.feedback.setPosition(new Point(o,i)),this.add(this.feedback)},ColorPickerMorph.prototype.getChoice=function(){return this.feedback.color},ColorPickerMorph.prototype.rootForGrab=function(){return this},BlinkerMorph.prototype=new Morph,BlinkerMorph.prototype.constructor=BlinkerMorph,BlinkerMorph.uber=Morph.prototype,BlinkerMorph.prototype.init=function(t){BlinkerMorph.uber.init.call(this),this.color=new Color(0,0,0),this.fps=t||2,this.drawNew()},BlinkerMorph.prototype.step=function(){this.toggleVisibility()},CursorMorph.prototype=new BlinkerMorph,CursorMorph.prototype.constructor=CursorMorph,CursorMorph.uber=BlinkerMorph.prototype,CursorMorph.prototype.viewPadding=1,CursorMorph.prototype.init=function(t){var e;this.keyDownEventUsed=!1,this.target=t,this.originalContents=this.target.text,this.originalAlignment=this.target.alignment,this.slot=this.target.text.length,CursorMorph.uber.init.call(this),e=fontHeight(this.target.fontSize),this.setExtent(new Point(Math.max(Math.floor(e/20),1),e)),this.drawNew(),this.image.getContext("2d").font=this.target.font(),this.target instanceof TextMorph&&"left"!==this.target.alignment&&this.target.setAlignmentToLeft(),this.gotoSlot(this.slot),this.initializeClipboardHandler()},CursorMorph.prototype.initializeClipboardHandler=function(){var t=this,e=this.target.world();this.clipboardHandler=document.createElement("textarea"),this.clipboardHandler.style.position="absolute",this.clipboardHandler.style.top=window.outerHeight,this.clipboardHandler.style.right="101%",document.body.appendChild(this.clipboardHandler),this.clipboardHandler.value=this.target.selection(),this.clipboardHandler.focus(),this.clipboardHandler.select(),this.clipboardHandler.addEventListener("keypress",(function(e){t.processKeyPress(e),this.value=t.target.selection(),this.select()}),!1),this.clipboardHandler.addEventListener("keydown",(function(o){t.processKeyDown(o),o.shiftKey&&(e.currentKey=16),this.value=t.target.selection(),this.select(),"U+0009"!==o.key&&"Tab"!==o.key||(t.processKeyPress(o),o.preventDefault())}),!1),this.clipboardHandler.addEventListener("keyup",(function(t){e.currentKey=null}),!1),this.clipboardHandler.addEventListener("input",(function(e){""===this.value&&(t.gotoSlot(t.target.selectionStartSlot()),t.target.deleteSelection())}),!1)},CursorMorph.prototype.processKeyPress=function(t){return this.keyDownEventUsed?(this.keyDownEventUsed=!1,null):40===t.keyCode||40===t.charCode?(this.insert("("),null):37===t.keyCode||37===t.charCode?(this.insert("%"),null):(t.keyCode?t.ctrlKey&&!t.altKey?this.ctrl(t.keyCode,t.shiftKey):t.metaKey?this.cmd(t.keyCode,t.shiftKey):this.insert(String.fromCharCode(t.keyCode),t.shiftKey):t.charCode&&(t.ctrlKey&&!t.altKey?this.ctrl(t.charCode,t.shiftKey):t.metaKey?this.cmd(t.charCode,t.shiftKey):this.insert(String.fromCharCode(t.charCode),t.shiftKey)),void this.target.escalateEvent("reactToKeystroke",t))},CursorMorph.prototype.processKeyDown=function(t){var e=t.shiftKey,o=t.ctrlKey||t.altKey,i=this.target.selection().length>0;switch(this.keyDownEventUsed=!1,t.ctrlKey&&!t.altKey&&(this.ctrl(t.keyCode,t.shiftKey),this.target.escalateEvent("reactToKeystroke",t)),t.metaKey&&(this.cmd(t.keyCode,t.shiftKey),this.target.escalateEvent("reactToKeystroke",t)),t.keyCode){case 37:!i||e||o?this.goLeft(e,o?this.slot-this.target.previousWordFrom(this.slot):1):(this.gotoSlot(Math.min(this.target.startMark,this.target.endMark)),this.target.clearSelection()),this.keyDownEventUsed=!0;break;case 39:!i||e||o?this.goRight(e,o?this.target.nextWordFrom(this.slot)-this.slot:1):(this.gotoSlot(Math.max(this.target.startMark,this.target.endMark)),this.target.clearSelection()),this.keyDownEventUsed=!0;break;case 38:this.goUp(e),this.keyDownEventUsed=!0;break;case 40:this.goDown(e),this.keyDownEventUsed=!0;break;case 36:this.goHome(e),this.keyDownEventUsed=!0;break;case 35:this.goEnd(e),this.keyDownEventUsed=!0;break;case 46:this.deleteRight(),this.keyDownEventUsed=!0;break;case 8:this.deleteLeft(),this.keyDownEventUsed=!0;break;case 13:this.target instanceof StringMorph||e?this.accept():this.insert("\n"),this.keyDownEventUsed=!0;break;case 27:this.cancel(),this.keyDownEventUsed=!0;break;default:nop()}this.target.escalateEvent("reactToKeystroke",t)},CursorMorph.prototype.gotoSlot=function(t){var e,o,i=this.target.text.length,n=this.target.slotPosition(t);this.slot=t<0?0:t>i?i:t,this.parent&&this.target.isScrollable&&(e=this.parent.right()-this.viewPadding,o=this.parent.left()+this.viewPadding,n.x>e&&(this.target.setLeft(this.target.left()+e-n.x),n.x=e),n.x<o&&(o=Math.min(this.parent.left(),o),this.target.setLeft(this.target.left()+o-n.x),n.x=o),this.target.right()<e&&e-this.target.width()<o&&(n.x+=e-this.target.right(),this.target.setRight(e))),this.show(),this.setPosition(n),this.parent&&this.parent.parent instanceof ScrollFrameMorph&&this.target.isScrollable&&this.parent.parent.scrollCursorIntoView(this)},CursorMorph.prototype.goLeft=function(t,e){this.updateSelection(t),this.gotoSlot(this.slot-(e||1)),this.updateSelection(t)},CursorMorph.prototype.goRight=function(t,e){this.updateSelection(t),this.gotoSlot(this.slot+(e||1)),this.updateSelection(t)},CursorMorph.prototype.goUp=function(t){this.updateSelection(t),this.gotoSlot(this.target.upFrom(this.slot)),this.updateSelection(t)},CursorMorph.prototype.goDown=function(t){this.updateSelection(t),this.gotoSlot(this.target.downFrom(this.slot)),this.updateSelection(t)},CursorMorph.prototype.goHome=function(t){this.updateSelection(t),this.gotoSlot(this.target.startOfLine(this.slot)),this.updateSelection(t)},CursorMorph.prototype.goEnd=function(t){this.updateSelection(t),this.gotoSlot(this.target.endOfLine(this.slot)),this.updateSelection(t)},CursorMorph.prototype.gotoPos=function(t){this.gotoSlot(this.target.slotAt(t)),this.show()},CursorMorph.prototype.updateSelection=function(t){t?isNil(this.target.endMark)&&isNil(this.target.startMark)?(this.target.startMark=this.slot,this.target.endMark=this.slot):this.target.endMark!==this.slot&&(this.target.endMark=this.slot,this.target.drawNew(),this.target.changed()):this.target.clearSelection()},CursorMorph.prototype.accept=function(){var t=this.root();t&&t.stopEditing(),this.escalateEvent("accept",this)},CursorMorph.prototype.cancel=function(){var t=this.root();this.undo(),t&&t.stopEditing(),this.escalateEvent("cancel",this)},CursorMorph.prototype.undo=function(){this.target.text=this.originalContents,this.target.changed(),this.target.drawNew(),this.target.changed(),this.gotoSlot(0)},CursorMorph.prototype.insert=function(t,e){var o;if("\t"===t)return this.target.escalateEvent("reactToEdit",this.target),e?this.target.backTab(this.target):this.target.tab(this.target);this.target.isNumeric&&isNaN(parseFloat(t))&&!contains(["-","."],t)||(""!==this.target.selection()&&(this.gotoSlot(this.target.selectionStartSlot()),this.target.deleteSelection()),o=(o=this.target.text).slice(0,this.slot)+t+o.slice(this.slot),this.target.text=o,this.target.drawNew(),this.target.changed(),this.goRight(!1,t.length))},CursorMorph.prototype.ctrl=function(t,e){64===t||65===t&&e?this.insert("@"):65===t?this.target.selectAll():90===t?this.undo():123===t?this.insert("{"):125===t?this.insert("}"):91===t?this.insert("["):93===t?this.insert("]"):isNil(this.target.receiver)||(68===t?this.target.doIt():73===t?this.target.inspectIt():80===t&&this.target.showIt())},CursorMorph.prototype.cmd=function(t,e){64===t||65===t&&e?this.insert("@"):65===t?this.target.selectAll():90===t?this.undo():isNil(this.target.receiver)||(68===t?this.target.doIt():73===t?this.target.inspectIt():80===t&&this.target.showIt())},CursorMorph.prototype.deleteRight=function(){var t;""!==this.target.selection()?(this.gotoSlot(this.target.selectionStartSlot()),this.target.deleteSelection()):(t=this.target.text,this.target.changed(),t=t.slice(0,this.slot)+t.slice(this.slot+1),this.target.text=t,this.target.drawNew())},CursorMorph.prototype.deleteLeft=function(){var t;if(this.target.selection())return this.gotoSlot(this.target.selectionStartSlot()),this.target.deleteSelection();t=this.target.text,this.target.changed(),this.target.text=t.substring(0,this.slot-1)+t.substr(this.slot),this.target.drawNew(),this.goLeft()},CursorMorph.prototype.destroy=function(){this.target.alignment!==this.originalAlignment&&(this.target.alignment=this.originalAlignment,this.target.drawNew(),this.target.changed()),this.destroyClipboardHandler(),CursorMorph.uber.destroy.call(this)},CursorMorph.prototype.destroyClipboardHandler=function(){var t,e=document.body.children;if(this.clipboardHandler)for(t=0;t<e.length;t+=1)e[t]===this.clipboardHandler&&(document.body.removeChild(this.clipboardHandler),this.clipboardHandler=null)},CursorMorph.prototype.inspectKeyEvent=function(t){this.inform("Key pressed: "+String.fromCharCode(t.charCode)+"\n------------------------\ncharCode: "+t.charCode.toString()+"\nkeyCode: "+t.keyCode.toString()+"\nshiftKey: "+t.shiftKey.toString()+"\naltKey: "+t.altKey.toString()+"\nctrlKey: "+t.ctrlKey.toString()+"\ncmdKey: "+t.metaKey.toString())},BoxMorph.prototype=new Morph,BoxMorph.prototype.constructor=BoxMorph,BoxMorph.uber=Morph.prototype,BoxMorph.prototype.init=function(t,e,o){this.edge=t||4,this.border=e||(0===e?0:2),this.borderColor=o||new Color,BoxMorph.uber.init.call(this)},BoxMorph.prototype.drawNew=function(){var t;if(this.image=newCanvas(this.extent()),t=this.image.getContext("2d"),0===this.edge&&0===this.border)return BoxMorph.uber.drawNew.call(this),null;t.fillStyle=this.color.toString(),t.beginPath(),this.outlinePath(t,Math.max(this.edge-this.border,0),this.border),t.closePath(),t.fill(),this.border>0&&(t.lineWidth=this.border,t.strokeStyle=this.borderColor.toString(),t.beginPath(),this.outlinePath(t,this.edge,this.border/2),t.closePath(),t.stroke())},BoxMorph.prototype.outlinePath=function(t,e,o){var i=e+o,n=this.width(),r=this.height();t.arc(i,i,e,radians(-180),radians(-90),!1),t.arc(n-i,i,e,radians(-90),radians(-0),!1),t.arc(n-i,r-i,e,radians(0),radians(90),!1),t.arc(i,r-i,e,radians(90),radians(180),!1)},BoxMorph.prototype.developersMenu=function(){var t=BoxMorph.uber.developersMenu.call(this);return t.addLine(),t.addItem("border width...",(function(){this.prompt(t.title+"\nborder\nwidth:",this.setBorderWidth,this,this.border.toString(),null,0,100,!0)}),"set the border's\nline size"),t.addItem("border color...",(function(){this.pickColor(t.title+"\nborder color:",this.setBorderColor,this,this.borderColor)}),"set the border's\nline color"),t.addItem("corner size...",(function(){this.prompt(t.title+"\ncorner\nsize:",this.setCornerSize,this,this.edge.toString(),null,0,100,!0)}),"set the corner's\nradius"),t},BoxMorph.prototype.setBorderWidth=function(t){var e;"number"==typeof t?this.border=Math.max(t,0):(e=parseFloat(t),isNaN(e)||(this.border=Math.max(e,0))),this.drawNew(),this.changed()},BoxMorph.prototype.setBorderColor=function(t){t&&(this.borderColor=t,this.drawNew(),this.changed())},BoxMorph.prototype.setCornerSize=function(t){var e;"number"==typeof t?this.edge=Math.max(t,0):(e=parseFloat(t),isNaN(e)||(this.edge=Math.max(e,0))),this.drawNew(),this.changed()},BoxMorph.prototype.colorSetters=function(){return["color","borderColor"]},BoxMorph.prototype.numericalSetters=function(){var t=BoxMorph.uber.numericalSetters.call(this);return t.push("setBorderWidth","setCornerSize"),t},SpeechBubbleMorph.prototype=new BoxMorph,SpeechBubbleMorph.prototype.constructor=SpeechBubbleMorph,SpeechBubbleMorph.uber=BoxMorph.prototype,SpeechBubbleMorph.prototype.init=function(t,e,o,i,n,r,s){this.isPointingRight=!0,this.contents=t||"",this.padding=r||0,this.isThought=s||!1,this.isClickable=!1,SpeechBubbleMorph.uber.init.call(this,o||6,i||(0===i?0:1),n||new Color(140,140,140)),this.color=e||new Color(230,230,230),this.drawNew()},SpeechBubbleMorph.prototype.popUp=function(t,e,o){this.drawNew(),this.setPosition(e.subtract(new Point(0,this.height()))),this.addShadow(new Point(2,2),80),this.keepWithin(t),t.add(this),this.fullChanged(),t.hand.destroyTemporaries(),t.hand.temporaries.push(this),o?this.isClickable=!0:this.mouseEnter=function(){this.destroy()}},SpeechBubbleMorph.prototype.drawNew=function(){this.contentsMorph&&this.contentsMorph.destroy(),this.contents instanceof Morph?this.contentsMorph=this.contents:isString(this.contents)?this.contentsMorph=new TextMorph(this.contents,MorphicPreferences.bubbleHelpFontSize,null,!1,!0,"center"):this.contents instanceof HTMLCanvasElement?(this.contentsMorph=new Morph,this.contentsMorph.silentSetWidth(this.contents.width),this.contentsMorph.silentSetHeight(this.contents.height),this.contentsMorph.image=this.contents):this.contentsMorph=new TextMorph(this.contents.toString(),MorphicPreferences.bubbleHelpFontSize,null,!1,!0,"center"),this.add(this.contentsMorph),this.silentSetWidth(this.contentsMorph.width()+(this.padding?2*this.padding:2*this.edge)),this.silentSetHeight(this.contentsMorph.height()+this.edge+2*this.border+2*this.padding+2),SpeechBubbleMorph.uber.drawNew.call(this),this.contentsMorph.setPosition(this.position().add(new Point(this.padding||this.edge,this.border+this.padding+1)))},SpeechBubbleMorph.prototype.outlinePath=function(t,e,o){var i,n=e+o,r=this.width(),s=this.height();function h(e,o,i){t.moveTo(e+i,o),t.arc(e,o,i,radians(0),radians(360))}t.arc(n,n,e,radians(-180),radians(-90),!1),t.arc(r-n,n,e,radians(-90),radians(-0),!1),t.arc(r-n,s-n-e,e,radians(0),radians(90),!1),this.isThought||(this.isPointingRight?(t.lineTo(n+e,s-n),t.lineTo(e/2+o,s-o)):(t.lineTo(r-(e/2+o),s-o),t.lineTo(r-(n+e),s-n))),t.arc(n,s-n-e,e,radians(90),radians(180),!1),!0===this.isThought&&(t.lineTo(o,n),this.isPointingRight?(h((i=e/4)+o,s-i-o,i),h(2*(i=e/3.2)+o,s-i-2*o,i),h(3*(i=e/2.8)+2*o,s-i-4*o,i)):(h(r-((i=e/4)+o),s-i-o,i),h(r-(2*(i=e/3.2)+o),s-i-2*o,i),h(r-(3*(i=e/2.8)+2*o),s-i-4*o,i)))},SpeechBubbleMorph.prototype.shadowImage=function(t,e){var o,i,n,r,s,h=t||new Point(7,7),a=e||new Color(0,0,0);return o=this.extent(),i=this.image,(s=(n=newCanvas(o)).getContext("2d")).drawImage(i,0,0),s.globalCompositeOperation="destination-out",s.drawImage(i,-h.x,-h.y),(s=(r=newCanvas(o)).getContext("2d")).drawImage(n,0,0),s.globalCompositeOperation="source-atop",s.fillStyle=a.toString(),s.fillRect(0,0,o.x,o.y),r},SpeechBubbleMorph.prototype.shadowImageBlurred=function(t,e){var o,i,n,r,s=t||new Point(7,7),h=this.shadowBlur,a=e||new Color(0,0,0);return o=this.extent().add(2*h),i=this.image,(r=(n=newCanvas(o)).getContext("2d")).shadowOffsetX=s.x,r.shadowOffsetY=s.y,r.shadowBlur=h,r.shadowColor=a.toString(),r.drawImage(i,h-s.x,h-s.y),r.shadowOffsetX=0,r.shadowOffsetY=0,r.shadowBlur=0,r.globalCompositeOperation="destination-out",r.drawImage(i,h-s.x,h-s.y),n},SpeechBubbleMorph.prototype.fixLayout=function(){this.removeShadow(),this.drawNew(),this.addShadow(new Point(2,2),80)},DialMorph.prototype=new Morph,DialMorph.prototype.constructor=DialMorph,DialMorph.uber=Morph.prototype,DialMorph.prototype.init=function(t,e,o,i,n){this.target=null,this.action=null,this.min=t||0,this.max=e||360,this.value=Math.max(this.min,(o||0)%this.max),this.tick=i||15,this.fillColor=null,DialMorph.uber.init.call(this),this.color=new Color(230,230,230),this.noticesTransparentClick=!0,this.setRadius(n||4*MorphicPreferences.menuFontSize)},DialMorph.prototype.setRadius=function(t){this.radius=t,this.setExtent(new Point(2*this.radius,2*this.radius))},DialMorph.prototype.setValue=function(t,e,o){var i=this.max-this.min;t=t||0,this.value=this.min+(+t%i+i)%i,e&&(this.value<this.tick?this.value=this.min:this.value-=this.value%this.tick%this.value),this.drawNew(),this.changed(),o||this.updateTarget()},DialMorph.prototype.getValueOf=function(t){var e=this.max-this.min,o=this.center(),i=t.x-o.x,n=o.y-t.y;return e*(((Math.abs(i)<.001?n<0?90:270:Math.round((i>=0?0:180)-57.2957795131*Math.atan(n/i)))+90)/360)+this.min},DialMorph.prototype.setExtent=function(t){var e=Math.min(t.x,t.y);this.radius=e/2,DialMorph.uber.setExtent.call(this,new Point(e,e))},DialMorph.prototype.drawNew=function(){var t,e,o,i,n,r,s,h=this.color.lighter().toString(),a=this.max-this.min,l=a/this.tick,c=.75*this.radius,u=.85*c,p=.95*c;for(this.image=newCanvas(this.extent()),(t=this.image.getContext("2d")).fillStyle=h,t.beginPath(),t.arc(this.radius,this.radius,c+Math.min(1,this.radius-c),0,2*Math.PI,!1),t.closePath(),t.fill(),t.fillStyle=this.color.toString(),t.beginPath(),t.arc(this.radius,this.radius,c,0,2*Math.PI,!1),t.closePath(),t.fill(),o=(this.value-this.min)*(2*Math.PI)/a-Math.PI/2,t.fillStyle=(this.fillColor||this.color.darker()).toString(),t.beginPath(),t.arc(this.radius,this.radius,c,Math.PI/-2,o,!1),t.lineTo(this.radius,this.radius),t.closePath(),t.fill(),t.strokeStyle=new Color(35,35,35).toString(),t.lineWidth=1,e=0;e<l;e+=1)o=(e-3)*(2*Math.PI)/l-Math.PI/2,t.beginPath(),i=this.radius+Math.cos(o)*u,n=this.radius+Math.sin(o)*u,r=this.radius+Math.cos(o)*p,s=this.radius+Math.sin(o)*p,t.moveTo(i,n),t.lineTo(r,s),t.stroke();u=.05*c,t.fillStyle="black",t.beginPath(),t.arc(this.radius,this.radius,u,0,2*Math.PI,!1),t.closePath(),t.fill(),t.strokeStyle="black",t.lineWidth=1,o=(this.value-this.min)*(2*Math.PI)/a-Math.PI/2,p=.8*c,i=this.radius+Math.cos(o)*u,n=this.radius+Math.sin(o)*u,r=this.radius+Math.cos(o)*p,s=this.radius+Math.sin(o)*p,t.beginPath(),t.moveTo(i,n),t.lineTo(r,s),t.stroke(),u*=2,r=this.radius+Math.cos(o)*(p+u),s=this.radius+Math.sin(o)*(p+u),t.fillStyle="black",t.beginPath(),t.arc(r,s,u,0,2*Math.PI,!1),t.closePath(),t.stroke(),o=(this.value-this.min)*(2*Math.PI)/a-Math.PI/2,i=this.radius+Math.cos(o)*c,n=this.radius+Math.sin(o)*c,r=this.radius+Math.cos(o)*(this.radius-1),s=this.radius+Math.sin(o)*(this.radius-1),t.beginPath(),t.moveTo(i,n),t.lineTo(r,s),t.lineWidth=3,t.strokeStyle=h,t.stroke(),t.lineWidth=1,t.strokeStyle="black",t.stroke(),o=radians(degrees(o)-4),i=this.radius+Math.cos(o)*this.radius*.9,n=this.radius+Math.sin(o)*this.radius*.9,t.beginPath(),t.moveTo(i,n),o=radians(degrees(o)+8),i=this.radius+Math.cos(o)*this.radius*.9,n=this.radius+Math.sin(o)*this.radius*.9,t.lineTo(i,n),t.lineTo(r,s),t.closePath(),t.lineWidth=3,t.strokeStyle=h,t.stroke(),t.lineWidth=1,t.strokeStyle="black",t.stroke(),t.fill()},DialMorph.prototype.step=null,DialMorph.prototype.mouseDownLeft=function(t){var e,o=this;e=this.root(),this.step=function(){e.hand.mouseButton?o.setValue(o.getValueOf(e.hand.bounds.origin),16!==e.currentKey):this.step=null}},DialMorph.prototype.developersMenu=function(){var t=DialMorph.uber.developersMenu.call(this);return t.addLine(),t.addItem("set target","setTarget","select another morph.jsk\nwhose numerical property\nwill be controlled by this one"),t},DialMorph.prototype.setTarget=function(){var t=this.overlappedMorphs(),e=new MenuMorph(this,"choose target:"),o=this;t.push(this.world()),t.forEach((function(t){e.addItem(t.toString().slice(0,50),(function(){o.target=t,o.setTargetSetter()}))})),1===t.length?(this.target=t[0],this.setTargetSetter()):t.length>0&&e.popUpAtHand(this.world())},DialMorph.prototype.setTargetSetter=function(){var t=this.target.numericalSetters(),e=new MenuMorph(this,"choose target property:"),o=this;t.forEach((function(t){e.addItem(t,(function(){o.action=t}))})),1===t.length?this.action=t[0]:t.length>0&&e.popUpAtHand(this.world())},DialMorph.prototype.updateTarget=function(){this.action&&("function"==typeof this.action?this.action.call(this.target,this.value):this.target[this.action](this.value))},CircleBoxMorph.prototype=new Morph,CircleBoxMorph.prototype.constructor=CircleBoxMorph,CircleBoxMorph.uber=Morph.prototype,CircleBoxMorph.prototype.init=function(t){CircleBoxMorph.uber.init.call(this),this.orientation=t,this.autoOrient=!0,this.setExtent(new Point(20,100))},CircleBoxMorph.prototype.autoOrientation=function(){this.height()>this.width()?this.orientation="vertical":this.orientation="horizontal"},CircleBoxMorph.prototype.drawNew=function(){var t,e,o,i,n,r,s,h,a=this;this.autoOrient&&this.autoOrientation(),this.image=newCanvas(this.extent()),s=this.image.getContext("2d"),"vertical"===this.orientation?(t=this.width()/2,e=new Point(n=this.center().x,this.top()+t),o=new Point(n,this.bottom()-t),i=this.bounds.origin.add(new Point(0,t)).corner(this.bounds.corner.subtract(new Point(0,t)))):(t=this.height()/2,r=this.center().y,e=new Point(this.left()+t,r),o=new Point(this.right()-t,r),i=this.bounds.origin.add(new Point(t,0)).corner(this.bounds.corner.subtract(new Point(t,0)))),[e.subtract(this.bounds.origin),o.subtract(this.bounds.origin)].forEach((function(e){s.fillStyle=a.color.toString(),s.beginPath(),s.arc(e.x,e.y,t,0,2*Math.PI,!1),s.closePath(),s.fill()})),(h=(i=i.translateBy(this.bounds.origin.neg())).extent()).x>0&&h.y>0&&s.fillRect(i.origin.x,i.origin.y,i.width(),i.height())},CircleBoxMorph.prototype.developersMenu=function(){var t=CircleBoxMorph.uber.developersMenu.call(this);return t.addLine(),"vertical"===this.orientation?t.addItem("horizontal...","toggleOrientation","toggle the\norientation"):t.addItem("vertical...","toggleOrientation","toggle the\norientation"),t},CircleBoxMorph.prototype.toggleOrientation=function(){var t=this.center();this.changed(),"vertical"===this.orientation?this.orientation="horizontal":this.orientation="vertical",this.silentSetExtent(new Point(this.height(),this.width())),this.setCenter(t),this.drawNew(),this.changed()},SliderButtonMorph.prototype=new CircleBoxMorph,SliderButtonMorph.prototype.constructor=SliderButtonMorph,SliderButtonMorph.uber=CircleBoxMorph.prototype,SliderButtonMorph.prototype.init=function(t){this.color=new Color(80,80,80),this.highlightColor=new Color(90,90,140),this.pressColor=new Color(80,80,160),this.is3D=!1,this.hasMiddleDip=!0,SliderButtonMorph.uber.init.call(this,t)},SliderButtonMorph.prototype.autoOrientation=nop,SliderButtonMorph.prototype.drawNew=function(){var t=this.color.copy();SliderButtonMorph.uber.drawNew.call(this),!this.is3D&&MorphicPreferences.isFlat||this.drawEdges(),this.normalImage=this.image,this.color=this.highlightColor.copy(),SliderButtonMorph.uber.drawNew.call(this),!this.is3D&&MorphicPreferences.isFlat||this.drawEdges(),this.highlightImage=this.image,this.color=this.pressColor.copy(),SliderButtonMorph.uber.drawNew.call(this),!this.is3D&&MorphicPreferences.isFlat||this.drawEdges(),this.pressImage=this.image,this.color=t,this.image=this.normalImage},SliderButtonMorph.prototype.drawEdges=function(){var t,e,o=this.image.getContext("2d"),i=this.width(),n=this.height();o.lineJoin="round",o.lineCap="round","vertical"===this.orientation?(o.lineWidth=i/3,(t=o.createLinearGradient(0,0,o.lineWidth,0)).addColorStop(0,"white"),t.addColorStop(1,this.color.toString()),o.strokeStyle=t,o.beginPath(),o.moveTo(.5*o.lineWidth,i/2),o.lineTo(.5*o.lineWidth,n-i/2),o.stroke(),(t=o.createLinearGradient(i-o.lineWidth,0,i,0)).addColorStop(0,this.color.toString()),t.addColorStop(1,"black"),o.strokeStyle=t,o.beginPath(),o.moveTo(i-.5*o.lineWidth,i/2),o.lineTo(i-.5*o.lineWidth,n-i/2),o.stroke(),this.hasMiddleDip&&(e=i/4,(t=o.createLinearGradient(o.lineWidth,0,i-o.lineWidth,0)).addColorStop(0,"black"),t.addColorStop(.35,this.color.toString()),t.addColorStop(.65,this.color.toString()),t.addColorStop(1,"white"),o.fillStyle=t,o.beginPath(),o.arc(i/2,n/2,e,radians(0),radians(360),!1),o.closePath(),o.fill())):"horizontal"===this.orientation&&(o.lineWidth=n/3,(t=o.createLinearGradient(0,0,0,o.lineWidth)).addColorStop(0,"white"),t.addColorStop(1,this.color.toString()),o.strokeStyle=t,o.beginPath(),o.moveTo(n/2,.5*o.lineWidth),o.lineTo(i-n/2,.5*o.lineWidth),o.stroke(),(t=o.createLinearGradient(0,n-o.lineWidth,0,n)).addColorStop(0,this.color.toString()),t.addColorStop(1,"black"),o.strokeStyle=t,o.beginPath(),o.moveTo(n/2,n-.5*o.lineWidth),o.lineTo(i-n/2,n-.5*o.lineWidth),o.stroke(),this.hasMiddleDip&&(e=n/4,(t=o.createLinearGradient(0,o.lineWidth,0,n-o.lineWidth)).addColorStop(0,"black"),t.addColorStop(.35,this.color.toString()),t.addColorStop(.65,this.color.toString()),t.addColorStop(1,"white"),o.fillStyle=t,o.beginPath(),o.arc(this.width()/2,this.height()/2,e,radians(0),radians(360),!1),o.closePath(),o.fill()))},SliderButtonMorph.prototype.mouseEnter=function(){this.image=this.highlightImage,this.changed()},SliderButtonMorph.prototype.mouseLeave=function(){this.image=this.normalImage,this.changed()},SliderButtonMorph.prototype.mouseDownLeft=function(t){this.image=this.pressImage,this.changed(),this.escalateEvent("mouseDownLeft",t)},SliderButtonMorph.prototype.mouseClickLeft=function(){this.image=this.highlightImage,this.changed()},SliderButtonMorph.prototype.mouseMove=function(){nop()},SliderMorph.prototype=new CircleBoxMorph,SliderMorph.prototype.constructor=SliderMorph,SliderMorph.uber=CircleBoxMorph.prototype,SliderMorph.prototype.init=function(t,e,o,i,n,r){this.target=null,this.action=null,this.start=t,this.stop=e,this.value=o,this.size=i,this.offset=null,this.button=new SliderButtonMorph,this.button.isDraggable=!1,this.button.color=new Color(200,200,200),this.button.highlightColor=new Color(210,210,255),this.button.pressColor=new Color(180,180,255),SliderMorph.uber.init.call(this,n),this.add(this.button),this.alpha=.3,this.color=r||new Color(0,0,0),this.setExtent(new Point(20,100))},SliderMorph.prototype.autoOrientation=nop,SliderMorph.prototype.rangeSize=function(){return this.stop-this.start},SliderMorph.prototype.ratio=function(){return this.size/(this.rangeSize()+1)},SliderMorph.prototype.unitSize=function(){return"vertical"===this.orientation?(this.height()-this.button.height())/this.rangeSize():(this.width()-this.button.width())/this.rangeSize()},SliderMorph.prototype.drawNew=function(){var t,e,o,i;SliderMorph.uber.drawNew.call(this),this.button.orientation=this.orientation,"vertical"===this.orientation?(t=this.width()-2,e=Math.max(t,Math.round(this.height()*this.ratio())),this.button.silentSetExtent(new Point(t,e)),o=1,i=Math.min(Math.round((this.value-this.start)*this.unitSize()),this.height()-this.button.height())):(e=this.height()-2,t=Math.max(e,Math.round(this.width()*this.ratio())),this.button.silentSetExtent(new Point(t,e)),i=1,o=Math.min(Math.round((this.value-this.start)*this.unitSize()),this.width()-this.button.width())),this.button.setPosition(new Point(o,i).add(this.bounds.origin)),this.button.drawNew(),this.button.changed()},SliderMorph.prototype.updateValue=function(){var t;t="vertical"===this.orientation?this.button.top()-this.top():this.button.left()-this.left(),this.value=Math.round(t/this.unitSize()+this.start),this.updateTarget()},SliderMorph.prototype.updateTarget=function(){this.action&&("function"==typeof this.action?this.action.call(this.target,this.value):this.target[this.action](this.value))},SliderMorph.prototype.developersMenu=function(){var t=SliderMorph.uber.developersMenu.call(this);return t.addItem("show value...","showValue","display a dialog box\nshowing the selected number"),t.addItem("floor...",(function(){this.prompt(t.title+"\nfloor:",this.setStart,this,this.start.toString(),null,0,this.stop-this.size,!0)}),"set the minimum value\nwhich can be selected"),t.addItem("ceiling...",(function(){this.prompt(t.title+"\nceiling:",this.setStop,this,this.stop.toString(),null,this.start+this.size,100*this.size,!0)}),"set the maximum value\nwhich can be selected"),t.addItem("button size...",(function(){this.prompt(t.title+"\nbutton size:",this.setSize,this,this.size.toString(),null,1,this.stop-this.start,!0)}),"set the range\ncovered by\nthe slider button"),t.addLine(),t.addItem("set target","setTarget","select another morph.jsk\nwhose numerical property\nwill be controlled by this one"),t},SliderMorph.prototype.showValue=function(){this.inform(this.value)},SliderMorph.prototype.userSetStart=function(t){this.start=Math.max(t,this.stop)},SliderMorph.prototype.setStart=function(t,e){var o;"number"==typeof t?this.start=Math.min(t,this.stop-this.size):(o=parseFloat(t),isNaN(o)||(this.start=Math.min(o,this.stop-this.size))),this.value=Math.max(this.value,this.start),e||this.updateTarget(),this.drawNew(),this.changed()},SliderMorph.prototype.setStop=function(t,e){var o;"number"==typeof t?this.stop=Math.max(t,this.start+this.size):(o=parseFloat(t),isNaN(o)||(this.stop=Math.max(o,this.start+this.size))),this.value=Math.min(this.value,this.stop),e||this.updateTarget(),this.drawNew(),this.changed()},SliderMorph.prototype.setSize=function(t,e){var o;"number"==typeof t?this.size=Math.min(Math.max(t,1),this.stop-this.start):(o=parseFloat(t),isNaN(o)||(this.size=Math.min(Math.max(o,1),this.stop-this.start))),this.value=Math.min(this.value,this.stop-this.size),e||this.updateTarget(),this.drawNew(),this.changed()},SliderMorph.prototype.setTarget=function(){var t=this.overlappedMorphs(),e=new MenuMorph(this,"choose target:"),o=this;t.push(this.world()),t.forEach((function(t){e.addItem(t.toString().slice(0,50),(function(){o.target=t,o.setTargetSetter()}))})),1===t.length?(this.target=t[0],this.setTargetSetter()):t.length>0&&e.popUpAtHand(this.world())},SliderMorph.prototype.setTargetSetter=function(){var t=this.target.numericalSetters(),e=new MenuMorph(this,"choose target property:"),o=this;t.forEach((function(t){e.addItem(t,(function(){o.action=t}))})),1===t.length?this.action=t[0]:t.length>0&&e.popUpAtHand(this.world())},SliderMorph.prototype.numericalSetters=function(){var t=SliderMorph.uber.numericalSetters.call(this);return t.push("setStart","setStop","setSize"),t},SliderMorph.prototype.step=null,SliderMorph.prototype.mouseDownLeft=function(t){var e,o=this;this.button.bounds.containsPoint(t)?this.offset=t.subtract(this.button.bounds.origin):this.offset=new Point,e=this.root(),this.step=function(){var t,i,n;e.hand.mouseButton?(t=e.hand.bounds.origin,"vertical"===o.orientation?(i=o.button.bounds.origin.x,n=Math.max(Math.min(t.y-o.offset.y,o.bottom()-o.button.height()),o.top())):(n=o.button.bounds.origin.y,i=Math.max(Math.min(t.x-o.offset.x,o.right()-o.button.width()),o.left())),o.button.setPosition(new Point(i,n)),o.updateValue()):this.step=null}},MouseSensorMorph.prototype=new BoxMorph,MouseSensorMorph.prototype.constructor=MouseSensorMorph,MouseSensorMorph.uber=BoxMorph.prototype,MouseSensorMorph.prototype.init=function(t,e,o){MouseSensorMorph.uber.init.call(this),this.edge=t||4,this.border=e||2,this.color=new Color(255,255,255),this.borderColor=o||new Color,this.isTouched=!1,this.upStep=.05,this.downStep=.02,this.noticesTransparentClick=!1,this.drawNew()},MouseSensorMorph.prototype.touch=function(){var t=this;this.isTouched||(this.isTouched=!0,this.alpha=.6,this.step=function(){t.isTouched?t.alpha<1&&(t.alpha=t.alpha+t.upStep):t.alpha>t.downStep?t.alpha=t.alpha-t.downStep:(t.alpha=0,t.step=null),t.changed()})},MouseSensorMorph.prototype.unTouch=function(){this.isTouched=!1},MouseSensorMorph.prototype.mouseEnter=function(){this.touch()},MouseSensorMorph.prototype.mouseLeave=function(){this.unTouch()},MouseSensorMorph.prototype.mouseDownLeft=function(){this.touch()},MouseSensorMorph.prototype.mouseClickLeft=function(){this.unTouch()},InspectorMorph.prototype=new BoxMorph,InspectorMorph.prototype.constructor=InspectorMorph,InspectorMorph.uber=BoxMorph.prototype,InspectorMorph.prototype.init=function(t){this.target=t,this.currentProperty=null,this.showing="attributes",this.markOwnProperties=!1,this.hasUserEditedDetails=!1,InspectorMorph.uber.init.call(this),this.silentSetExtent(new Point(20*MorphicPreferences.handleSize,20*MorphicPreferences.handleSize*2/3)),this.isDraggable=!0,this.border=1,this.edge=MorphicPreferences.isFlat?1:5,this.color=new Color(60,60,60),this.borderColor=new Color(95,95,95),this.fps=25,this.drawNew(),this.label=null,this.list=null,this.detail=null,this.work=null,this.buttonInspect=null,this.buttonClose=null,this.buttonSubset=null,this.buttonEdit=null,this.resizer=null,this.target&&this.buildPanes()},InspectorMorph.prototype.setTarget=function(t){this.target=t,this.currentProperty=null,this.buildPanes()},InspectorMorph.prototype.updateCurrentSelection=function(){var t,e,o,i=this.list.selected,n=this.detail.contents.children[0],r=this.root();r&&r.keyboardReceiver instanceof CursorMorph&&r.keyboardReceiver.target===n?this.hasUserEditedDetails=!0:isNil(i)||this.hasUserEditedDetails||(t=this.target[i],this.currentProperty=t,e=isNil(t)?"NULL":isString(t)?t:t.toString(),n.text!==e&&((o=new TextMorph(e)).isEditable=!0,o.enableSelecting(),o.setReceiver(this.target),this.detail.setContents(o)))},InspectorMorph.prototype.buildPanes=function(){var t,e,o,i,n=[],r=this;for(t in this.children.forEach((function(t){t!==this.work&&t.destroy()})),this.children=[],this.label=new TextMorph(this.target.toString()),this.label.fontSize=MorphicPreferences.menuFontSize,this.label.isBold=!0,this.label.color=new Color(255,255,255),this.label.drawNew(),this.add(this.label),this.target)t&&n.push(t);"attributes"===this.showing?n=n.filter((function(t){return"function"!=typeof r.target[t]})):"methods"===this.showing&&(n=n.filter((function(t){return"function"==typeof r.target[t]}))),i=function(){var t,e;isObject(r.currentProperty)&&(t=r.world(),(e=new InspectorMorph(r.currentProperty)).setPosition(t.hand.position()),e.keepWithin(t),t.add(e),e.changed())},this.list=new ListMorph(this.target instanceof Array?n:n.sort(),null,this.markOwnProperties?[[new Color(0,0,180),function(t){return Object.prototype.hasOwnProperty.call(r.target,t)}]]:null,i),this.list.action=function(){r.hasUserEditedDetails=!1,r.updateCurrentSelection()},this.list.hBar.alpha=.6,this.list.vBar.alpha=.6,this.list.contents.step=null,this.add(this.list),this.detail=new ScrollFrameMorph,this.detail.acceptsDrops=!1,this.detail.contents.acceptsDrops=!1,this.detail.isTextLineWrapping=!0,this.detail.color=new Color(255,255,255),this.detail.hBar.alpha=.6,this.detail.vBar.alpha=.6,(e=new TextMorph("")).isEditable=!0,e.enableSelecting(),e.setReceiver(this.target),this.detail.setContents(e),this.add(this.detail),null===this.work&&(this.work=new ScrollFrameMorph,this.work.acceptsDrops=!1,this.work.contents.acceptsDrops=!1,this.work.isTextLineWrapping=!0,this.work.color=new Color(255,255,255),this.work.hBar.alpha=.6,this.work.vBar.alpha=.6,(o=new TextMorph("")).isEditable=!0,o.enableSelecting(),o.setReceiver(this.target),this.work.setContents(o)),this.add(this.work),this.buttonSubset=new TriggerMorph,this.buttonSubset.labelString="show...",this.buttonSubset.action=function(){var t;(t=new MenuMorph).addItem("attributes",(function(){r.showing="attributes",r.buildPanes()})),t.addItem("methods",(function(){r.showing="methods",r.buildPanes()})),t.addItem("all",(function(){r.showing="all",r.buildPanes()})),t.addLine(),t.addItem(r.markOwnProperties?"un-mark own":"mark own",(function(){r.markOwnProperties=!r.markOwnProperties,r.buildPanes()}),"highlight\n'own' properties"),t.popUpAtHand(r.world())},this.add(this.buttonSubset),this.buttonInspect=new TriggerMorph,this.buttonInspect.labelString="inspect...",this.buttonInspect.action=function(){var t,e,o;isObject(r.currentProperty)?((t=new MenuMorph).addItem("in new inspector...",(function(){e=r.world(),(o=new InspectorMorph(r.currentProperty)).setPosition(e.hand.position()),o.keepWithin(e),e.add(o),o.changed()})),t.addItem("here...",(function(){r.setTarget(r.currentProperty)})),t.popUpAtHand(r.world())):r.inform((null===r.currentProperty?"null":typeof r.currentProperty)+"\nis not inspectable")},this.add(this.buttonInspect),this.buttonEdit=new TriggerMorph,this.buttonEdit.labelString="edit...",this.buttonEdit.action=function(){var t;(t=new MenuMorph(r)).addItem("save","save","accept changes"),t.addLine(),t.addItem("add property...","addProperty"),t.addItem("rename...","renameProperty"),t.addItem("remove...","removeProperty"),t.popUpAtHand(r.world())},this.add(this.buttonEdit),this.buttonClose=new TriggerMorph,this.buttonClose.labelString="close",this.buttonClose.action=function(){r.destroy()},this.add(this.buttonClose),this.resizer=new HandleMorph(this,150,100,this.edge,this.edge),this.fixLayout()},InspectorMorph.prototype.fixLayout=function(){var t,e,o,i;Morph.prototype.trackChanges=!1,t=this.left()+this.edge,e=this.top()+this.edge,o=this.right()-this.edge-t,this.label.setPosition(new Point(t,e)),this.label.setWidth(o),this.label.height()>this.height()-50&&(this.silentSetHeight(this.label.height()+50),this.drawNew(),this.changed(),this.resizer.drawNew()),e=this.label.bottom()+2,o=Math.min(Math.floor(this.width()/3),this.list.listContents.width()),o-=this.edge,i=this.bottom()-2*this.edge-MorphicPreferences.handleSize-e,this.list.setPosition(new Point(t,e)),this.list.setExtent(new Point(o,i)),t=this.list.right()+this.edge,o=this.right()-this.edge-t,this.detail.setPosition(new Point(t,e)),this.detail.setExtent(new Point(o,2*i/3-this.edge)),e=this.detail.bottom()+this.edge,this.work.setPosition(new Point(t,e)),this.work.setExtent(new Point(o,i/3)),t=this.list.left(),e=this.list.bottom()+this.edge,o=this.list.width(),i=MorphicPreferences.handleSize,this.buttonSubset.setPosition(new Point(t,e)),this.buttonSubset.setExtent(new Point(o,i)),t=this.detail.left(),o=(o=this.detail.width()-this.edge-MorphicPreferences.handleSize)/3-this.edge/3,this.buttonInspect.setPosition(new Point(t,e)),this.buttonInspect.setExtent(new Point(o,i)),t=this.buttonInspect.right()+this.edge,this.buttonEdit.setPosition(new Point(t,e)),this.buttonEdit.setExtent(new Point(o,i)),t=this.buttonEdit.right()+this.edge,o=this.detail.right()-this.edge-MorphicPreferences.handleSize-t,this.buttonClose.setPosition(new Point(t,e)),this.buttonClose.setExtent(new Point(o,i)),Morph.prototype.trackChanges=!0,this.changed()},InspectorMorph.prototype.setExtent=function(t){InspectorMorph.uber.setExtent.call(this,t),this.fixLayout()},InspectorMorph.prototype.save=function(){var t=this.detail.contents.children[0].text.toString(),e=this.list.selected;try{this.target.evaluateString("this."+e+" = "+t),this.hasUserEditedDetails=!1,this.target.drawNew&&(this.target.changed(),this.target.drawNew(),this.target.changed())}catch(t){this.inform(t)}},InspectorMorph.prototype.addProperty=function(){var t=this;this.prompt("new property name:",(function(e){e&&(t.target[e]=null,t.buildPanes(),t.target.drawNew&&(t.target.changed(),t.target.drawNew(),t.target.changed()))}),this,"property")},InspectorMorph.prototype.renameProperty=function(){var t=this,e=this.list.selected;this.prompt("property name:",(function(o){try{delete t.target[e],t.target[o]=t.currentProperty}catch(e){t.inform(e)}t.buildPanes(),t.target.drawNew&&(t.target.changed(),t.target.drawNew(),t.target.changed())}),this,e)},InspectorMorph.prototype.removeProperty=function(){var t=this.list.selected;try{delete this.target[t],this.currentProperty=null,this.buildPanes(),this.target.drawNew&&(this.target.changed(),this.target.drawNew(),this.target.changed())}catch(t){this.inform(t)}},InspectorMorph.prototype.step=function(){this.updateCurrentSelection();var t=this.target.toString();this.label.text!==t&&(this.label.text=t,this.label.drawNew(),this.fixLayout())},InspectorMorph.prototype.updateReferences=function(t){var e=this.list.activeIndex();InspectorMorph.uber.updateReferences.call(this,t),this.buildPanes(),this.list.activateIndex(e)},MenuMorph.prototype=new BoxMorph,MenuMorph.prototype.constructor=MenuMorph,MenuMorph.uber=BoxMorph.prototype,MenuMorph.prototype.init=function(t,e,o,i){this.target=t,this.title=e||null,this.environment=o||null,this.fontSize=i||null,this.items=[],this.label=null,this.world=null,this.isListContents=!1,this.hasFocus=!1,this.selection=null,this.submenu=null,MenuMorph.uber.init.call(this),this.isDraggable=!1,this.border=null,this.edge=null},MenuMorph.prototype.addItem=function(t,e,o,i,n,r,s,h){this.items.push([localize(t||"close"),e||nop,o,i,n||!1,r||!1,s,h])},MenuMorph.prototype.addMenu=function(t,e,o){this.addPair(t,e,isNil(o)?"►":o)},MenuMorph.prototype.addPair=function(t,e,o,i){this.addItem(t,e,i,null,null,null,null,o)},MenuMorph.prototype.addLine=function(t){this.items.push([0,t||1])},MenuMorph.prototype.createLabel=function(){var t;null!==this.label&&this.label.destroy(),(t=new TextMorph(localize(this.title),this.fontSize||MorphicPreferences.menuFontSize,MorphicPreferences.menuFontName,!0,!1,"center")).alignment="center",t.color=new Color(255,255,255),t.backgroundColor=this.borderColor,t.drawNew(),this.label=new BoxMorph(3,0),MorphicPreferences.isFlat&&(this.label.edge=0),this.label.color=this.borderColor,this.label.borderColor=this.borderColor,this.label.setExtent(t.extent().add(4)),this.label.drawNew(),this.label.add(t),this.label.text=t},MenuMorph.prototype.drawNew=function(){var t,e,o,i,n=this,r=!1;this.children.forEach((function(t){t.destroy()})),this.children=[],this.isListContents||(this.edge=MorphicPreferences.isFlat?0:5,this.border=MorphicPreferences.isFlat?1:2),this.color=new Color(255,255,255),this.borderColor=new Color(60,60,60),this.silentSetExtent(new Point(0,0)),i=2,o=this.left()+4,this.isListContents||(this.title?(this.createLabel(),this.label.setPosition(this.bounds.origin.add(4)),this.add(this.label),i=this.label.bottom()):i=this.top()+4),i+=1,this.items.forEach((function(e){r=!1,e instanceof StringFieldMorph||e instanceof ColorPickerMorph||e instanceof SliderMorph||e instanceof DialMorph?t=e:0===e[0]?(r=!0,(t=new Morph).color=n.borderColor,t.setHeight(e[1])):t=new MenuItemMorph(n.target,e[1],e[0],n.fontSize||MorphicPreferences.menuFontSize,MorphicPreferences.menuFontName,n.environment,e[2],e[3],e[4],e[5],e[6],e[7]),r&&(i+=1),t.setPosition(new Point(o,i)),n.add(t),i+=t.height(),r&&(i+=1)})),e=this.fullBounds(),this.silentSetExtent(e.extent().add(4)),this.adjustWidths(),MenuMorph.uber.drawNew.call(this)},MenuMorph.prototype.maxWidth=function(){var t=0;return this.parent instanceof FrameMorph&&this.parent.scrollFrame instanceof ScrollFrameMorph&&(t=this.parent.scrollFrame.width()),this.children.forEach((function(e){e instanceof MenuItemMorph?t=Math.max(t,e.label.width()+8+(e.shortcut?e.shortcut.width()+4:0)):(e instanceof StringFieldMorph||e instanceof ColorPickerMorph||e instanceof SliderMorph||e instanceof DialMorph)&&(t=Math.max(t,e.width()))})),this.label&&(t=Math.max(t,this.label.width())),t},MenuMorph.prototype.adjustWidths=function(){var t,e=this.maxWidth(),o=this;this.children.forEach((function(i){i instanceof DialMorph||i.silentSetWidth(e),i instanceof MenuItemMorph?(i.fixLayout(),t=i.image===i.pressImage,i.createBackgrounds(),t&&(i.image=i.pressImage)):(i.drawNew(),i===o.label&&i.text.setPosition(i.center().subtract(i.text.extent().floorDivideBy(2))))}))},MenuMorph.prototype.unselectAllItems=function(){this.children.forEach((function(t){t instanceof MenuItemMorph?t.image=t.normalImage:t instanceof ScrollFrameMorph&&t.contents.children.forEach((function(t){t instanceof MenuItemMorph&&(t.image=t.normalImage)}))})),this.changed()},MenuMorph.prototype.popup=function(t,e){var o;this.drawNew(),this.setPosition(e),this.addShadow(new Point(2,2),80),this.keepWithin(t),this.bottom()>t.bottom()&&(this.removeShadow(),o=this.scroll(),this.bounds.corner.y=t.bottom()-2,MenuMorph.uber.drawNew.call(this),this.addShadow(new Point(2,2),80),o.setHeight(t.bottom()-o.top()-6),o.adjustScrollBars()),t.activeMenu&&t.activeMenu.destroy(),this.items.length<1&&!this.title||(t.add(this),t.activeMenu=this,this.world=t,this.fullChanged())},MenuMorph.prototype.scroll=function(){var t=new ScrollFrameMorph,e=this.label?1:0,o=this.children[e];return t.setPosition(o.position()),this.children.slice(e).forEach((function(e){t.addContents(e)})),this.add(t),t.setWidth(o.width()),t},MenuMorph.prototype.popUpAtHand=function(t){var e=t||this.world;this.popup(e,e.hand.position())},MenuMorph.prototype.popUpCenteredAtHand=function(t){var e=t||this.world;this.drawNew(),this.popup(e,e.hand.position().subtract(this.extent().floorDivideBy(2)))},MenuMorph.prototype.popUpCenteredInWorld=function(t){var e=t||this.world;this.drawNew(),this.popup(e,e.center().subtract(this.extent().floorDivideBy(2)))},MenuMorph.prototype.closeRootMenu=function(){this.parent instanceof MenuMorph?this.parent.closeRootMenu():this.destroy()},MenuMorph.prototype.closeSubmenu=function(){this.submenu&&(this.submenu.destroy(),this.submenu=null,this.unselectAllItems())},MenuMorph.prototype.getFocus=function(){this.world.keyboardReceiver=this,this.selection=null,this.selectFirst(),this.hasFocus=!0},MenuMorph.prototype.processKeyDown=function(t){switch(t.keyCode){case 13:case 32:return void(this.selection&&(this.selection.mouseClickLeft(),this.submenu&&this.submenu.getFocus()));case 27:return this.destroy();case 37:return this.leaveSubmenu();case 38:return this.selectUp();case 39:return this.enterSubmenu();case 40:return this.selectDown();default:nop()}},MenuMorph.prototype.processKeyUp=function(t){nop(t)},MenuMorph.prototype.processKeyPress=function(t){nop(t)},MenuMorph.prototype.selectFirst=function(){var t,e,o;for(e=(t=detect(this.children,(function(t){return t instanceof ScrollFrameMorph})))?t.contents.children:this.children,o=0;o<e.length;o+=1)if(e[o]instanceof MenuItemMorph)return void this.select(e[o])},MenuMorph.prototype.selectUp=function(){var t,e,o;e=((t=detect(this.children,(function(t){return t instanceof ScrollFrameMorph})))?t.contents.children:this.children).filter((function(t){return t instanceof MenuItemMorph})),this.selection?((o=e.indexOf(this.selection)-1)<0&&(o=e.length-1),this.select(e[o])):e.length&&this.select(e[0])},MenuMorph.prototype.selectDown=function(){var t,e,o;e=((t=detect(this.children,(function(t){return t instanceof ScrollFrameMorph})))?t.contents.children:this.children).filter((function(t){return t instanceof MenuItemMorph})),this.selection?((o=e.indexOf(this.selection)+1)>=e.length&&(o=0),this.select(e[o])):e.length&&this.select(e[0])},MenuMorph.prototype.enterSubmenu=function(){this.selection&&this.selection.action instanceof MenuMorph&&(this.selection.popUpSubmenu(),this.submenu&&this.submenu.getFocus())},MenuMorph.prototype.leaveSubmenu=function(){var t=this.parent;this.parent instanceof MenuMorph&&(t.submenu=null,t.hasFocus=!0,this.destroy(),t.world.keyboardReceiver=t)},MenuMorph.prototype.select=function(t){this.unselectAllItems(),t.image=t.highlightImage,t.changed(),t.scrollIntoView(),this.selection=t},MenuMorph.prototype.destroy=function(){this.hasFocus&&(this.world.keyboardReceiver=null),MenuMorph.uber.destroy.call(this)},StringMorph.prototype=new Morph,StringMorph.prototype.constructor=StringMorph,StringMorph.uber=Morph.prototype,StringMorph.prototype.init=function(t,e,o,i,n,r,s,h,a,l){this.text=t||(""===t?"":"StringMorph"),this.fontSize=e||12,this.fontName=l||MorphicPreferences.globalFontFamily,this.fontStyle=o||"sans-serif",this.isBold=i||!1,this.isItalic=n||!1,this.isEditable=!1,this.isNumeric=r||!1,this.isPassword=!1,this.shadowOffset=s||new Point(0,0),this.shadowColor=h||null,this.isShowingBlanks=!1,this.blanksColor=new Color(180,140,140),this.isScrollable=!0,this.currentlySelecting=!1,this.startMark=0,this.endMark=0,this.markedTextColor=new Color(255,255,255),this.markedBackgoundColor=new Color(60,60,120),StringMorph.uber.init.call(this,!0),this.color=a||new Color(0,0,0),this.noticesTransparentClick=!0,this.drawNew()},StringMorph.prototype.toString=function(){return"a "+(this.constructor.name||this.constructor.toString().split(" ")[1].split("(")[0])+'("'+this.text.slice(0,30)+'...")'},StringMorph.prototype.password=function(t,e){var o,i="";for(o=0;o<e;o+=1)i+=t;return i},StringMorph.prototype.font=function(){var t="";return this.isBold&&(t+="bold "),this.isItalic&&(t+="italic "),t+this.fontSize+"px "+(this.fontName?this.fontName+", ":"")+this.fontStyle},StringMorph.prototype.drawNew=function(){var t,e,o,i,n,r,s,h,a,l=this.shadowOffset||new Point,c=this.isPassword?this.password("*",this.text.length):this.text;for(this.image=newCanvas(),(t=this.image.getContext("2d")).font=this.font(),e=Math.max(t.measureText(c).width+Math.abs(l.x),1),this.bounds.corner=this.bounds.origin.add(new Point(e,fontHeight(this.fontSize)+Math.abs(l.y))),this.image.width=e,this.image.height=this.height(),t.font=this.font(),t.textAlign="left",t.textBaseline="bottom",this.shadowColor&&(h=Math.max(l.x,0),a=Math.max(l.y,0),t.fillStyle=this.shadowColor.toString(),t.fillText(c,h,fontHeight(this.fontSize)+a)),h=Math.abs(Math.min(l.x,0)),a=Math.abs(Math.min(l.y,0)),t.fillStyle=this.color.toString(),this.isShowingBlanks?this.renderWithBlanks(t,h,fontHeight(this.fontSize)+a):t.fillText(c,h,fontHeight(this.fontSize)+a),o=Math.min(this.startMark,this.endMark),i=Math.max(this.startMark,this.endMark),n=o;n<i;n+=1)r=this.slotPosition(n).subtract(this.position()),s=c.charAt(n),t.fillStyle=this.markedBackgoundColor.toString(),t.fillRect(r.x,r.y,t.measureText(s).width+1+h,fontHeight(this.fontSize)+a),t.fillStyle=this.markedTextColor.toString(),t.fillText(s,r.x+h,fontHeight(this.fontSize)+a);this.parent&&this.parent.fixLayout&&this.parent.fixLayout()},StringMorph.prototype.renderWithBlanks=function(t,e,o){var i=t.measureText(" ").width,n=newCanvas(new Point(i,this.height())),r=n.getContext("2d"),s=this.text.split(" "),h=e||0,a=!0;r.fillStyle=this.blanksColor.toString(),r.arc(i/2,n.height/2,i/2,radians(0),radians(360)),r.fill(),s.forEach((function(e){a||(t.drawImage(n,h,0),h+=i),a=!1,""!==e&&(t.fillText(e,h,o),h+=t.measureText(e).width)}))},StringMorph.prototype.slotPosition=function(t){var e,o,i=this.isPassword?this.password("*",this.text.length):this.text,n=Math.min(Math.max(t,0),i.length),r=this.image.getContext("2d");for(e=0,o=0;o<n;o+=1)e+=r.measureText(i[o]).width;return this.pos=n,new Point(this.left()+e,this.top())},StringMorph.prototype.slotAt=function(t){for(var e=this.isPassword?this.password("*",this.text.length):this.text,o=0,i=0,n=this.image.getContext("2d");t.x-this.left()>i;)if(i+=n.measureText(e[o]).width,(o+=1)===e.length&&n.measureText(e).width-n.measureText(e[o-1]).width/2<t.x-this.left())return o;return t.x-this.left()>i-n.measureText(e[o-1]).width/2?o:o-1},StringMorph.prototype.upFrom=function(t){return t},StringMorph.prototype.downFrom=function(t){return t},StringMorph.prototype.startOfLine=function(){return 0},StringMorph.prototype.endOfLine=function(){return this.text.length},StringMorph.prototype.previousWordFrom=function(t){for(var e=t-1;e>0&&!isWordChar(this.text[e]);)e-=1;for(;e>0&&isWordChar(this.text[e-1]);)e-=1;return e},StringMorph.prototype.nextWordFrom=function(t){for(var e=t;e<this.endOfLine()&&!isWordChar(this.text[e]);)e+=1;for(;e<this.endOfLine()&&isWordChar(this.text[e]);)e+=1;return e},StringMorph.prototype.rawHeight=function(){return this.height()/1.2},StringMorph.prototype.developersMenu=function(){var t=StringMorph.uber.developersMenu.call(this);return t.addLine(),t.addItem("edit","edit"),t.addItem("font size...",(function(){this.prompt(t.title+"\nfont\nsize:",this.setFontSize,this,this.fontSize.toString(),null,6,500,!0)}),"set this String's\nfont point size"),"serif"!==this.fontStyle&&t.addItem("serif","setSerif"),"sans-serif"!==this.fontStyle&&t.addItem("sans-serif","setSansSerif"),this.isBold?t.addItem("normal weight","toggleWeight"):t.addItem("bold","toggleWeight"),this.isItalic?t.addItem("normal style","toggleItalic"):t.addItem("italic","toggleItalic"),this.isShowingBlanks?t.addItem("hide blanks","toggleShowBlanks"):t.addItem("show blanks","toggleShowBlanks"),this.isPassword?t.addItem("show characters","toggleIsPassword"):t.addItem("hide characters","toggleIsPassword"),t},StringMorph.prototype.toggleIsDraggable=function(){this.isDraggable=!this.isDraggable,this.isDraggable?this.disableSelecting():this.enableSelecting()},StringMorph.prototype.toggleShowBlanks=function(){this.isShowingBlanks=!this.isShowingBlanks,this.changed(),this.drawNew(),this.changed()},StringMorph.prototype.toggleWeight=function(){this.isBold=!this.isBold,this.changed(),this.drawNew(),this.changed()},StringMorph.prototype.toggleItalic=function(){this.isItalic=!this.isItalic,this.changed(),this.drawNew(),this.changed()},StringMorph.prototype.toggleIsPassword=function(){this.isPassword=!this.isPassword,this.changed(),this.drawNew(),this.changed()},StringMorph.prototype.setSerif=function(){this.fontStyle="serif",this.changed(),this.drawNew(),this.changed()},StringMorph.prototype.setSansSerif=function(){this.fontStyle="sans-serif",this.changed(),this.drawNew(),this.changed()},StringMorph.prototype.setFontSize=function(t){var e;"number"==typeof t?this.fontSize=Math.round(Math.min(Math.max(t,4),500)):(e=parseFloat(t),isNaN(e)||(this.fontSize=Math.round(Math.min(Math.max(e,4),500)))),this.changed(),this.drawNew(),this.changed()},StringMorph.prototype.setText=function(t){this.text=Math.round(t).toString(),this.changed(),this.drawNew(),this.changed()},StringMorph.prototype.numericalSetters=function(){return["setLeft","setTop","setAlphaScaled","setFontSize","setText"]},StringMorph.prototype.edit=function(){this.root().edit(this)},StringMorph.prototype.selection=function(){var t,e;return t=Math.min(this.startMark,this.endMark),e=Math.max(this.startMark,this.endMark),this.text.slice(t,e)},StringMorph.prototype.selectionStartSlot=function(){return Math.min(this.startMark,this.endMark)},StringMorph.prototype.clearSelection=function(){!this.currentlySelecting&&isNil(this.startMark)&&isNil(this.endMark)||(this.currentlySelecting=!1,this.startMark=null,this.endMark=null,this.drawNew(),this.changed())},StringMorph.prototype.deleteSelection=function(){var t,e,o;o=this.text,t=Math.min(this.startMark,this.endMark),e=Math.max(this.startMark,this.endMark),this.text=o.slice(0,t)+o.slice(e),this.changed(),this.clearSelection()},StringMorph.prototype.selectAll=function(){var t;this.isEditable&&(this.startMark=0,(t=this.root().cursor)&&t.gotoSlot(this.text.length),this.endMark=this.text.length,this.drawNew(),this.changed())},StringMorph.prototype.mouseDownLeft=function(t){16===this.world().currentKey?this.shiftClick(t):this.isEditable?this.clearSelection():this.escalateEvent("mouseDownLeft",t)},StringMorph.prototype.shiftClick=function(t){var e=this.root().cursor;e&&(this.startMark||(this.startMark=e.slot),e.gotoPos(t),this.endMark=e.slot,this.drawNew(),this.changed()),this.currentlySelecting=!1,this.escalateEvent("mouseDownLeft",t)},StringMorph.prototype.mouseClickLeft=function(t){var e;this.isEditable?(this.currentlySelecting||this.edit(),(e=this.root().cursor)&&e.gotoPos(t),this.currentlySelecting=!0):this.escalateEvent("mouseClickLeft",t)},StringMorph.prototype.mouseDoubleClick=function(t){var e=this.slotAt(t);this.isEditable?(this.edit(),e===this.text.length&&(e-=1),this.text[e]&&isWordChar(this.text[e])?this.selectWordAt(e):this.text[e]?this.selectBetweenWordsAt(e):this.selectAll()):this.escalateEvent("mouseDoubleClick",t)},StringMorph.prototype.selectWordAt=function(t){var e=this.root().cursor;0===t||isWordChar(this.text[t-1])?(e.gotoSlot(this.previousWordFrom(t)),this.startMark=e.slot,this.endMark=this.nextWordFrom(e.slot)):(e.gotoSlot(t),this.startMark=t,this.endMark=this.nextWordFrom(t)),this.drawNew(),this.changed()},StringMorph.prototype.selectBetweenWordsAt=function(t){var e=this.root().cursor;for(e.gotoSlot(this.nextWordFrom(this.previousWordFrom(t))),this.startMark=e.slot,this.endMark=e.slot;this.endMark<this.text.length&&!isWordChar(this.text[this.endMark]);)this.endMark+=1;this.drawNew(),this.changed()},StringMorph.prototype.enableSelecting=function(){this.mouseDownLeft=function(t){var e=this.root().cursor,o=!!e&&e.target===this;16===this.world().currentKey?this.shiftClick(t):(this.clearSelection(),this.isEditable&&!this.isDraggable&&(this.edit(),this.root().cursor.gotoPos(t),this.startMark=this.slotAt(t),this.endMark=this.startMark,this.currentlySelecting=!0,o||this.escalateEvent("mouseDownLeft",t)))},this.mouseMove=function(t){if(this.isEditable&&this.currentlySelecting&&!this.isDraggable){var e=this.slotAt(t);e!==this.endMark&&(this.endMark=e,this.drawNew(),this.changed())}}},StringMorph.prototype.disableSelecting=function(){this.mouseDownLeft=StringMorph.prototype.mouseDownLeft,delete this.mouseMove},TextMorph.prototype=new Morph,TextMorph.prototype.constructor=TextMorph,TextMorph.uber=Morph.prototype,TextMorph.prototype.init=function(t,e,o,i,n,r,s,h,a,l){this.text=t||(""===t?t:"TextMorph"),this.words=[],this.lines=[],this.lineSlots=[],this.fontSize=e||12,this.fontName=h||MorphicPreferences.globalFontFamily,this.fontStyle=o||"sans-serif",this.isBold=i||!1,this.isItalic=n||!1,this.alignment=r||"left",this.shadowOffset=a||new Point(0,0),this.shadowColor=l||null,this.maxWidth=s||0,this.maxLineWidth=0,this.backgroundColor=null,this.isEditable=!1,this.receiver=null,this.isScrollable=!0,this.currentlySelecting=!1,this.startMark=0,this.endMark=0,this.markedTextColor=new Color(255,255,255),this.markedBackgoundColor=new Color(60,60,120),TextMorph.uber.init.call(this),this.color=new Color(0,0,0),this.noticesTransparentClick=!0,this.drawNew()},TextMorph.prototype.toString=function(){return'a TextMorph("'+this.text.slice(0,30)+'...")'},TextMorph.prototype.font=StringMorph.prototype.font,TextMorph.prototype.parse=function(){var t,e=this,o=this.text.split("\n"),i=newCanvas().getContext("2d"),n="",r=0;i.font=this.font(),this.maxLineWidth=0,this.lines=[],this.lineSlots=[0],this.words=[],o.forEach((function(t){e.words=e.words.concat(t.split(" ")),e.words.push("\n")})),this.words.forEach((function(o){"\n"===o?(e.lines.push(n),e.lineSlots.push(r),e.maxLineWidth=Math.max(e.maxLineWidth,i.measureText(n).width),n=""):(e.maxWidth>0?(t=n+o+" ",i.measureText(t).width>e.maxWidth?(e.lines.push(n),e.lineSlots.push(r),e.maxLineWidth=Math.max(e.maxLineWidth,i.measureText(n).width),n=o+" "):n=t):n=n+o+" ",r+=o.length+1)}))},TextMorph.prototype.drawNew=function(){var t,e,o,i,n,r,s,h,a,l,c,u,p,d,f;if(this.image=newCanvas(),(t=this.image.getContext("2d")).font=this.font(),this.parse(),s=Math.abs(this.shadowOffset.x),r=Math.abs(this.shadowOffset.y),e=this.lines.length*(fontHeight(this.fontSize)+r),0===this.maxWidth?this.bounds=this.bounds.origin.extent(new Point(this.maxLineWidth+s,e)):this.bounds=this.bounds.origin.extent(new Point(this.maxWidth+s,e)),this.image.width=this.width(),this.image.height=this.height(),(t=this.image.getContext("2d")).font=this.font(),t.textAlign="left",t.textBaseline="bottom",this.backgroundColor&&(t.fillStyle=this.backgroundColor.toString(),t.fillRect(0,0,this.width(),this.height())),this.shadowColor)for(h=Math.max(this.shadowOffset.x,0),a=Math.max(this.shadowOffset.y,0),t.fillStyle=this.shadowColor.toString(),o=0;o<this.lines.length;o+=1)i=this.lines[o],n=t.measureText(i).width+s,l="right"===this.alignment?this.width()-n:"center"===this.alignment?(this.width()-n)/2:0,c=(o+1)*(fontHeight(this.fontSize)+r)-r,t.fillText(i,l+h,c+a);for(h=Math.abs(Math.min(this.shadowOffset.x,0)),a=Math.abs(Math.min(this.shadowOffset.y,0)),t.fillStyle=this.color.toString(),o=0;o<this.lines.length;o+=1)i=this.lines[o],n=t.measureText(i).width+s,l="right"===this.alignment?this.width()-n:"center"===this.alignment?(this.width()-n)/2:0,c=(o+1)*(fontHeight(this.fontSize)+r)-r,t.fillText(i,l+h,c+a);for(u=Math.min(this.startMark,this.endMark),p=Math.max(this.startMark,this.endMark),o=u;o<p;o+=1)d=this.slotPosition(o).subtract(this.position()),f=this.text.charAt(o),t.fillStyle=this.markedBackgoundColor.toString(),t.fillRect(d.x,d.y,t.measureText(f).width+1,fontHeight(this.fontSize)),t.fillStyle=this.markedTextColor.toString(),t.fillText(f,d.x,d.y+fontHeight(this.fontSize));this.parent&&this.parent.layoutChanged&&this.parent.layoutChanged()},TextMorph.prototype.setExtent=function(t){this.maxWidth=Math.max(t.x,0),this.changed(),this.drawNew()},TextMorph.prototype.columnRow=function(t){var e,o,i=0;for(e=0;e<this.lines.length;e+=1)for(i=this.lineSlots[e],o=0;o<this.lines[e].length;o+=1){if(i===t)return new Point(o,e);i+=1}return new Point(this.lines[this.lines.length-1].length-1,this.lines.length-1)},TextMorph.prototype.slotPosition=function(t){var e,o,i=this.columnRow(t),n=this.image.getContext("2d"),r=Math.abs(this.shadowOffset.y),s=0;for(e=i.y*(fontHeight(this.fontSize)+r),o=0;o<i.x;o+=1)s+=n.measureText(this.lines[i.y][o]).width;return new Point(this.left()+s,this.top()+e)},TextMorph.prototype.slotAt=function(t){for(var e=0,o=0,i=0,n=Math.abs(this.shadowOffset.y),r=this.image.getContext("2d");t.y-this.top()>(fontHeight(this.fontSize)+n)*o;)o+=1;for(o=Math.max(o,1);t.x-this.left()>e;)e+=r.measureText(this.lines[o-1][i]).width,i+=1;return t.x-this.left()>e-r.measureText(this.lines[o-1][i]).width/2?this.lineSlots[Math.max(o-1,0)]+i:this.lineSlots[Math.max(o-1,0)]+i-1},TextMorph.prototype.upFrom=function(t){var e,o=this.columnRow(t);return o.y<1?t:(e=this.lines[o.y-1]).length<o.x-1?this.lineSlots[o.y-1]+e.length:this.lineSlots[o.y-1]+o.x},TextMorph.prototype.downFrom=function(t){var e,o=this.columnRow(t);return o.y>this.lines.length-2?t:(e=this.lines[o.y+1]).length<o.x-1?this.lineSlots[o.y+1]+e.length:this.lineSlots[o.y+1]+o.x},TextMorph.prototype.startOfLine=function(t){return this.lineSlots[this.columnRow(t).y]},TextMorph.prototype.endOfLine=function(t){return this.startOfLine(t)+this.lines[this.columnRow(t).y].length-1},TextMorph.prototype.previousWordFrom=StringMorph.prototype.previousWordFrom,TextMorph.prototype.nextWordFrom=StringMorph.prototype.nextWordFrom,TextMorph.prototype.edit=StringMorph.prototype.edit,TextMorph.prototype.selection=StringMorph.prototype.selection,TextMorph.prototype.selectionStartSlot=StringMorph.prototype.selectionStartSlot,TextMorph.prototype.clearSelection=StringMorph.prototype.clearSelection,TextMorph.prototype.deleteSelection=StringMorph.prototype.deleteSelection,TextMorph.prototype.selectAll=StringMorph.prototype.selectAll,TextMorph.prototype.mouseDownLeft=StringMorph.prototype.mouseDownLeft,TextMorph.prototype.shiftClick=StringMorph.prototype.shiftClick,TextMorph.prototype.mouseClickLeft=StringMorph.prototype.mouseClickLeft,TextMorph.prototype.mouseDoubleClick=StringMorph.prototype.mouseDoubleClick,TextMorph.prototype.selectWordAt=StringMorph.prototype.selectWordAt,TextMorph.prototype.selectBetweenWordsAt=StringMorph.prototype.selectBetweenWordsAt,TextMorph.prototype.enableSelecting=StringMorph.prototype.enableSelecting,TextMorph.prototype.disableSelecting=StringMorph.prototype.disableSelecting,TextMorph.prototype.selectAllAndEdit=function(){this.edit(),this.selectAll()},TextMorph.prototype.developersMenu=function(){var t=TextMorph.uber.developersMenu.call(this);return t.addLine(),t.addItem("edit","edit"),t.addItem("font size...",(function(){this.prompt(t.title+"\nfont\nsize:",this.setFontSize,this,this.fontSize.toString(),null,6,100,!0)}),"set this Text's\nfont point size"),"left"!==this.alignment&&t.addItem("align left","setAlignmentToLeft"),"right"!==this.alignment&&t.addItem("align right","setAlignmentToRight"),"center"!==this.alignment&&t.addItem("align center","setAlignmentToCenter"),t.addLine(),"serif"!==this.fontStyle&&t.addItem("serif","setSerif"),"sans-serif"!==this.fontStyle&&t.addItem("sans-serif","setSansSerif"),this.isBold?t.addItem("normal weight","toggleWeight"):t.addItem("bold","toggleWeight"),this.isItalic?t.addItem("normal style","toggleItalic"):t.addItem("italic","toggleItalic"),t},TextMorph.prototype.setAlignmentToLeft=function(){this.alignment="left",this.drawNew(),this.changed()},TextMorph.prototype.setAlignmentToRight=function(){this.alignment="right",this.drawNew(),this.changed()},TextMorph.prototype.setAlignmentToCenter=function(){this.alignment="center",this.drawNew(),this.changed()},TextMorph.prototype.toggleIsDraggable=StringMorph.prototype.toggleIsDraggable,TextMorph.prototype.toggleWeight=StringMorph.prototype.toggleWeight,TextMorph.prototype.toggleItalic=StringMorph.prototype.toggleItalic,TextMorph.prototype.setSerif=StringMorph.prototype.setSerif,TextMorph.prototype.setSansSerif=StringMorph.prototype.setSansSerif,TextMorph.prototype.setText=StringMorph.prototype.setText,TextMorph.prototype.setFontSize=StringMorph.prototype.setFontSize,TextMorph.prototype.numericalSetters=StringMorph.prototype.numericalSetters,TextMorph.prototype.evaluationMenu=function(){var t=new MenuMorph(this,null);return t.addItem("do it","doIt","evaluate the\nselected expression"),t.addItem("show it","showIt","evaluate the\nselected expression\nand show the result"),t.addItem("inspect it","inspectIt","evaluate the\nselected expression\nand inspect the result"),t.addLine(),t.addItem("select all","selectAllAndEdit"),t},TextMorph.prototype.setReceiver=function(t){this.receiver=t,this.customContextMenu=this.evaluationMenu()},TextMorph.prototype.doIt=function(){this.receiver.evaluateString(this.selection()),this.edit()},TextMorph.prototype.showIt=function(){var t=this.receiver.evaluateString(this.selection());null!==t&&this.inform(t)},TextMorph.prototype.inspectIt=function(){var t,e=this.receiver.evaluateString(this.selection()),o=this.world();isObject(e)&&((t=new InspectorMorph(e)).setPosition(o.hand.position()),t.keepWithin(o),o.add(t),t.changed())},TriggerMorph.prototype=new Morph,TriggerMorph.prototype.constructor=TriggerMorph,TriggerMorph.uber=Morph.prototype,TriggerMorph.prototype.init=function(t,e,o,i,n,r,s,h,a,l,c){this.target=t||null,this.action=e||null,this.doubleClickAction=c||null,this.environment=r||null,this.labelString=o||null,this.label=null,this.hint=s||null,this.schedule=null,this.fontSize=i||MorphicPreferences.menuFontSize,this.fontStyle=n||"sans-serif",this.highlightColor=new Color(192,192,192),this.pressColor=new Color(128,128,128),this.labelColor=h||new Color(0,0,0),this.labelBold=a||!1,this.labelItalic=l||!1,TriggerMorph.uber.init.call(this),this.color=new Color(255,255,255),this.drawNew()},TriggerMorph.prototype.drawNew=function(){this.createBackgrounds(),null!==this.labelString&&this.createLabel()},TriggerMorph.prototype.createBackgrounds=function(){var t,e=this.extent();this.normalImage=newCanvas(e),(t=this.normalImage.getContext("2d")).fillStyle=this.color.toString(),t.fillRect(0,0,e.x,e.y),this.highlightImage=newCanvas(e),(t=this.highlightImage.getContext("2d")).fillStyle=this.highlightColor.toString(),t.fillRect(0,0,e.x,e.y),this.pressImage=newCanvas(e),(t=this.pressImage.getContext("2d")).fillStyle=this.pressColor.toString(),t.fillRect(0,0,e.x,e.y),this.image=this.normalImage},TriggerMorph.prototype.createLabel=function(){null!==this.label&&this.label.destroy(),this.label=new StringMorph(this.labelString,this.fontSize,this.fontStyle,this.labelBold,this.labelItalic,!1,null,null,this.labelColor),this.label.setPosition(this.center().subtract(this.label.extent().floorDivideBy(2))),this.add(this.label)},TriggerMorph.prototype.trigger=function(){this.schedule&&(this.schedule.isActive=!1),"function"==typeof this.target?"function"==typeof this.action?this.target.call(this.environment,this.action.call(),this):this.target.call(this.environment,this.action,this):"function"==typeof this.action?this.action.call(this.target):this.target[this.action]()},TriggerMorph.prototype.triggerDoubleClick=function(){this.doubleClickAction&&(this.schedule&&(this.schedule.isActive=!1),"function"==typeof this.target?"function"==typeof this.doubleClickAction?this.target.call(this.environment,this.doubleClickAction.call(),this):this.target.call(this.environment,this.doubleClickAction,this):"function"==typeof this.doubleClickAction?this.doubleClickAction.call(this.target):this.target[this.doubleClickAction]())},TriggerMorph.prototype.mouseEnter=function(){var t=this.hint instanceof Function?this.hint():this.hint;this.image=this.highlightImage,this.changed(),t&&this.bubbleHelp(t)},TriggerMorph.prototype.mouseLeave=function(){this.image=this.normalImage,this.changed(),this.schedule&&(this.schedule.isActive=!1),this.hint&&this.world().hand.destroyTemporaries()},TriggerMorph.prototype.mouseDownLeft=function(){this.image=this.pressImage,this.changed()},TriggerMorph.prototype.mouseClickLeft=function(){this.image=this.highlightImage,this.changed(),this.trigger()},TriggerMorph.prototype.mouseDoubleClick=function(){this.triggerDoubleClick()},TriggerMorph.prototype.rootForGrab=function(){return this.isDraggable?TriggerMorph.uber.rootForGrab.call(this):null},TriggerMorph.prototype.bubbleHelp=function(t){var e=this.world(),o=this;this.schedule=new Animation(nop,nop,0,500,nop,(function(){o.popUpbubbleHelp(t)})),e.animations.push(this.schedule)},TriggerMorph.prototype.popUpbubbleHelp=function(t){new SpeechBubbleMorph(localize(t),null,null,1).popUp(this.world(),this.rightCenter().add(new Point(-8,0)))},MenuItemMorph.prototype=new TriggerMorph,MenuItemMorph.prototype.constructor=MenuItemMorph,MenuItemMorph.uber=TriggerMorph.prototype,MenuItemMorph.prototype.createLabel=function(){var t,e;this.label&&this.label.destroy(),this.label=this.createLabelPart(this.labelString),this.add(this.label),t=this.label.width(),e=this.label.height(),this.shortcut&&this.shortcut.destroy(),this.shortcutString&&(this.shortcut=this.createLabelPart(this.shortcutString),t+=this.shortcut.width()+4,e=Math.max(e,this.shortcut.height()),this.add(this.shortcut)),this.silentSetExtent(new Point(t+8,e)),this.fixLayout()},MenuItemMorph.prototype.fixLayout=function(){var t=this.center();this.label.setCenter(t),this.label.setLeft(this.left()+4),this.shortcut&&(this.shortcut.setCenter(t),this.shortcut.setRight(this.right()-4))},MenuItemMorph.prototype.createLabelPart=function(t){var e,o,i;return isString(t)?this.createLabelString(t):t instanceof Array?((e=new Morph).alpha=0,o=this.createIcon(t[0]),e.add(o),i=this.createLabelString(t[1]),e.add(i),i.setCenter(o.center()),i.setLeft(o.right()+4),e.bounds=o.bounds.merge(i.bounds),e.drawNew(),e):this.createIcon(t)},MenuItemMorph.prototype.createIcon=function(t){var e,o=new Morph;return o.image=t instanceof Morph?t.fullImage():t,t instanceof Morph&&t.getShadow()&&(e=o.image,o.image=newCanvas(t.fullBounds().extent().subtract(this.shadowBlur*(useBlurredShadows?1:2))),o.image.getContext("2d").drawImage(e,0,0)),o.silentSetWidth(o.image.width),o.silentSetHeight(o.image.height),o},MenuItemMorph.prototype.createLabelString=function(t){var e=new TextMorph(t,this.fontSize,this.fontStyle,this.labelBold,this.labelItalic);return e.setColor(this.labelColor),e},MenuItemMorph.prototype.mouseEnter=function(){var t=this.parentThatIsA(MenuMorph);this.isShowingSubmenu()||(t&&t.closeSubmenu(),this.isListItem()||(this.image=this.highlightImage,this.changed()),this.action instanceof MenuMorph?this.delaySubmenu():this.hint&&this.bubbleHelp(this.hint))},MenuItemMorph.prototype.mouseLeave=function(){this.isListItem()||(this.isShowingSubmenu()?this.image=this.highlightImage:this.image=this.normalImage,this.changed()),this.schedule&&(this.schedule.isActive=!1),this.hint&&this.world().hand.destroyTemporaries()},MenuItemMorph.prototype.mouseDownLeft=function(t){this.isListItem()&&(this.parentThatIsA(MenuMorph).unselectAllItems(),this.escalateEvent("mouseDownLeft",t)),this.image=this.pressImage,this.changed()},MenuItemMorph.prototype.mouseMove=function(){this.isListItem()&&this.escalateEvent("mouseMove")},MenuItemMorph.prototype.mouseClickLeft=function(){this.action instanceof MenuMorph?this.popUpSubmenu():(this.isListItem()||(this.parentThatIsA(MenuMorph).closeRootMenu(),this.world().activeMenu=null),this.trigger())},MenuItemMorph.prototype.isListItem=function(){var t=this.parentThatIsA(MenuMorph);return!!t&&t.isListContents},MenuItemMorph.prototype.isSelectedListItem=function(){return!!this.isListItem()&&this.image===this.pressImage},MenuItemMorph.prototype.isShowingSubmenu=function(){var t=this.parentThatIsA(MenuMorph);return!!(t&&this.action instanceof MenuMorph)&&t.submenu===this.action},MenuItemMorph.prototype.delaySubmenu=function(){var t=this.world(),e=this;this.schedule=new Animation(nop,nop,0,500,nop,(function(){e.popUpSubmenu()})),t.animations.push(this.schedule)},MenuItemMorph.prototype.popUpSubmenu=function(){var t=this.parentThatIsA(MenuMorph);this.action instanceof MenuMorph&&(this.action.drawNew(),this.action.setPosition(this.topRight().subtract(new Point(0,5))),this.action.addShadow(new Point(2,2),80),this.action.keepWithin(this.world()),this.action.items.length<1&&!this.action.title||(t.add(this.action),t.submenu=this.action,t.submenu.world=t.world,this.action.fullChanged()))},FrameMorph.prototype=new Morph,FrameMorph.prototype.constructor=FrameMorph,FrameMorph.uber=Morph.prototype,FrameMorph.prototype.init=function(t){this.scrollFrame=t||null,FrameMorph.uber.init.call(this),this.color=new Color(255,250,245),this.drawNew(),this.acceptsDrops=!0,this.scrollFrame&&(this.isDraggable=!1,this.noticesTransparentClick=!1,this.alpha=0)},FrameMorph.prototype.fullBounds=function(){var t=this.getShadow();return null!==t?this.bounds.merge(t.bounds):this.bounds},FrameMorph.prototype.fullImage=function(){return this.image},FrameMorph.prototype.fullDrawOn=function(t,e){var o,i;return this.isVisible?(o=e||this.fullBounds(),(i=this.bounds.intersect(o)).extent().gt(new Point(0,0))?(this.drawOn(t,i),void this.children.forEach((function(e){e instanceof ShadowMorph?e.fullDrawOn(t,o):e.fullDrawOn(t,i)}))):null):null},FrameMorph.prototype.topMorphAt=function(t){var e,o;if(!this.isVisible||!this.bounds.containsPoint(t))return null;for(e=this.children.length-1;e>=0;e-=1)if(o=this.children[e].topMorphAt(t))return o;return this.noticesTransparentClick||!this.isTransparentAt(t)?this:null},FrameMorph.prototype.submorphBounds=function(){var t=null;return this.children.length>0&&(t=this.children[0].bounds,this.children.forEach((function(e){t=t.merge(e.fullBounds())}))),t},FrameMorph.prototype.keepInScrollFrame=function(){if(null===this.scrollFrame)return null;this.left()>this.scrollFrame.left()&&this.moveBy(new Point(this.scrollFrame.left()-this.left(),0)),this.right()<this.scrollFrame.right()&&this.moveBy(new Point(this.scrollFrame.right()-this.right(),0)),this.top()>this.scrollFrame.top()&&this.moveBy(new Point(0,this.scrollFrame.top()-this.top())),this.bottom()<this.scrollFrame.bottom()&&this.moveBy(0,new Point(this.scrollFrame.bottom()-this.bottom(),0))},FrameMorph.prototype.adjustBounds=function(){var t,e,o=this;if(null===this.scrollFrame)return null;e=(t=this.submorphBounds())&&!this.scrollFrame.isTextLineWrapping?t.expandBy(this.scrollFrame.padding).growBy(this.scrollFrame.growth).merge(this.scrollFrame.bounds):this.scrollFrame.bounds.copy(),this.bounds.eq(e)||(this.bounds=e,this.drawNew(),this.keepInScrollFrame()),this.scrollFrame.isTextLineWrapping&&this.children.forEach((function(t){t instanceof TextMorph&&(t.setWidth(o.width()),o.setHeight(Math.max(t.height(),o.scrollFrame.height())))})),this.scrollFrame.adjustScrollBars()},FrameMorph.prototype.reactToDropOf=function(){this.adjustBounds()},FrameMorph.prototype.reactToGrabOf=function(){this.adjustBounds()},FrameMorph.prototype.developersMenu=function(){var t=FrameMorph.uber.developersMenu.call(this);return this.children.length>0&&(t.addLine(),t.addItem("move all inside...","keepAllSubmorphsWithin","keep all submorphs\nwithin and visible")),t},FrameMorph.prototype.keepAllSubmorphsWithin=function(){var t=this;this.children.forEach((function(e){e.keepWithin(t)}))},ScrollFrameMorph.prototype=new FrameMorph,ScrollFrameMorph.prototype.constructor=ScrollFrameMorph,ScrollFrameMorph.uber=FrameMorph.prototype,ScrollFrameMorph.prototype.init=function(t,e,o){var i=this;ScrollFrameMorph.uber.init.call(this),this.scrollBarSize=e||MorphicPreferences.scrollBarSize,this.autoScrollTrigger=null,this.enableAutoScrolling=!0,this.isScrollingByDragging=!0,this.hasVelocity=!0,this.padding=0,this.growth=0,this.isTextLineWrapping=!1,this.contents=t||new FrameMorph(this),this.add(this.contents),this.hBar=new SliderMorph(null,null,null,null,"horizontal",o),this.hBar.setHeight(this.scrollBarSize),this.hBar.action=function(t){i.contents.setPosition(new Point(i.left()-t,i.contents.position().y))},this.hBar.isDraggable=!1,this.add(this.hBar),this.vBar=new SliderMorph(null,null,null,null,"vertical",o),this.vBar.setWidth(this.scrollBarSize),this.vBar.action=function(t){i.contents.setPosition(new Point(i.contents.position().x,i.top()-t))},this.vBar.isDraggable=!1,this.add(this.vBar),this.toolBar=null},ScrollFrameMorph.prototype.adjustScrollBars=function(){var t=this.width()-this.scrollBarSize,e=this.height()-this.scrollBarSize;this.changed(),this.contents.width()>this.width()+MorphicPreferences.scrollBarSize?(this.hBar.show(),this.hBar.width()!==t&&this.hBar.setWidth(t),this.hBar.setPosition(new Point(this.left(),this.bottom()-this.hBar.height())),this.hBar.start=0,this.hBar.stop=this.contents.width()-this.width(),this.hBar.size=this.width()/this.contents.width()*this.hBar.stop,this.hBar.value=this.left()-this.contents.left(),this.hBar.drawNew()):this.hBar.hide(),this.contents.height()>this.height()+this.scrollBarSize?(this.vBar.show(),this.vBar.height()!==e&&this.vBar.setHeight(e),this.vBar.setPosition(new Point(this.right()-this.vBar.width(),this.top())),this.vBar.start=0,this.vBar.stop=this.contents.height()-this.height(),this.vBar.size=this.height()/this.contents.height()*this.vBar.stop,this.vBar.value=this.top()-this.contents.top(),this.vBar.drawNew()):this.vBar.hide(),this.adjustToolBar()},ScrollFrameMorph.prototype.adjustToolBar=function(){this.toolBar&&(this.toolBar.setTop(this.top()+3),this.toolBar.setRight((this.vBar.isVisible?this.vBar.left():this.right())-3))},ScrollFrameMorph.prototype.addContents=function(t){this.contents.add(t),this.contents.adjustBounds()},ScrollFrameMorph.prototype.setContents=function(t){this.contents.children.forEach((function(t){t.destroy()})),this.contents.children=[],t.setPosition(this.position().add(this.padding+2)),this.addContents(t)},ScrollFrameMorph.prototype.setExtent=function(t){this.isTextLineWrapping&&this.contents.setPosition(this.position().copy()),ScrollFrameMorph.uber.setExtent.call(this,t),this.contents.adjustBounds()},ScrollFrameMorph.prototype.scrollX=function(t){var e,o=this.contents.left(),i=this.left(),n=this.contents.width(),r=this.right();(e=o+t)+n<r&&(e=r-n),e>i&&(e=i),e!==o&&this.contents.setLeft(e)},ScrollFrameMorph.prototype.scrollY=function(t){var e,o=this.contents.top(),i=this.top(),n=this.contents.height(),r=this.bottom();(e=o+t)+n<r&&(e=r-n),e>i&&(e=i),e!==o&&this.contents.setTop(e)},ScrollFrameMorph.prototype.step=nop,ScrollFrameMorph.prototype.mouseDownLeft=function(t){if(!this.isScrollingByDragging)return null;var e=this.root().hand,o=t,i=this,n=0,r=0;this.step=function(){var t;if(e.mouseButton&&0===e.children.length&&i.bounds.containsPoint(e.bounds.origin)){if(e.grabPosition&&e.grabPosition.distanceTo(e.position())<=MorphicPreferences.grabThreshold)return null;t=e.bounds.origin,0!==(n=t.x-o.x)&&i.scrollX(n),0!==(r=t.y-o.y)&&i.scrollY(r),o=t}else i.hasVelocity?Math.abs(n)<.5&&Math.abs(r)<.5?i.step=function(){nop()}:(n*=.8,i.scrollX(Math.round(n)),r*=.8,i.scrollY(Math.round(r))):i.step=function(){nop()};this.adjustScrollBars()}},ScrollFrameMorph.prototype.startAutoScrolling=function(){var t,e,o,i=this,n=3*MorphicPreferences.scrollBarSize,r=this.world();if(!r)return null;t=r.hand,this.autoScrollTrigger||(this.autoScrollTrigger=Date.now()),this.step=function(){o=t.bounds.origin,e=i.bounds.insetBy(n),i.bounds.containsPoint(o)&&!e.containsPoint(o)&&t.children.length>0?i.autoScroll(o):(i.step=function(){nop()},i.autoScrollTrigger=null)}},ScrollFrameMorph.prototype.autoScroll=function(t){var e;if(Date.now()-this.autoScrollTrigger<500)return null;e=3*MorphicPreferences.scrollBarSize,this.topLeft().extent(new Point(this.width(),e)).containsPoint(t)&&this.scrollY(e-(t.y-this.top())),this.topLeft().extent(new Point(e,this.height())).containsPoint(t)&&this.scrollX(e-(t.x-this.left())),new Point(this.right()-e,this.top()).extent(new Point(e,this.height())).containsPoint(t)&&this.scrollX(-(e-(this.right()-t.x))),new Point(this.left(),this.bottom()-e).extent(new Point(this.width(),e)).containsPoint(t)&&this.scrollY(-(e-(this.bottom()-t.y))),this.adjustScrollBars()},ScrollFrameMorph.prototype.scrollCursorIntoView=function(t){var e=t.target,o=e.position().subtract(this.contents.position()),i=this.top()+this.padding,n=this.bottom()-this.padding;this.contents.setExtent(e.extent().add(o).add(this.padding)),t.top()<i?(this.contents.setTop(this.contents.top()+i-t.top()),t.setTop(i)):t.bottom()>n&&(this.contents.setBottom(this.contents.bottom()+n-t.bottom()),t.setBottom(n)),this.adjustScrollBars()},ScrollFrameMorph.prototype.mouseScroll=function(t,e){t&&this.scrollY(t*MorphicPreferences.mouseScrollAmount),e&&this.scrollX(e*MorphicPreferences.mouseScrollAmount),this.adjustScrollBars()},ScrollFrameMorph.prototype.updateReferences=function(t){var e=this;ScrollFrameMorph.uber.updateReferences.call(this,t),this.hBar&&(this.hBar.action=function(t){e.contents.setPosition(new Point(e.left()-t,e.contents.position().y))}),this.vBar&&(this.vBar.action=function(t){e.contents.setPosition(new Point(e.contents.position().x,e.top()-t))})},ScrollFrameMorph.prototype.developersMenu=function(){var t=ScrollFrameMorph.uber.developersMenu.call(this);return this.isTextLineWrapping?t.addItem("auto line wrap off...","toggleTextLineWrapping","turn automatic\nline wrapping\noff"):t.addItem("auto line wrap on...","toggleTextLineWrapping","enable automatic\nline wrapping"),t},ScrollFrameMorph.prototype.toggleTextLineWrapping=function(){this.isTextLineWrapping=!this.isTextLineWrapping},ListMorph.prototype=new ScrollFrameMorph,ListMorph.prototype.constructor=ListMorph,ListMorph.uber=ScrollFrameMorph.prototype,ListMorph.prototype.init=function(t,e,o,i){ListMorph.uber.init.call(this),this.contents.acceptsDrops=!1,this.color=new Color(255,255,255),this.hBar.alpha=.6,this.vBar.alpha=.6,this.elements=t||[],this.labelGetter=e,this.format=o,this.listContents=null,this.selected=null,this.active=null,this.action=null,this.doubleClickAction=i||null,this.acceptsDrops=!1,this.buildListContents()},ListMorph.prototype.buildListContents=function(){var t=this;this.listContents&&this.listContents.destroy(),this.listContents=new MenuMorph(this.select,null,this),0===this.elements.length&&(this.elements=["(empty)"]),this.elements.forEach((function(e){var o=null,i=!1,n=!1;t.format.forEach((function(t){t[1].call(null,e)&&("bold"===t[0]?i=!0:"italic"===t[0]?n=!0:o=t[0])})),t.listContents.addItem(t.labelGetter(e),e,null,o,i,n,t.doubleClickAction)})),this.listContents.isListContents=!0,this.listContents.drawNew(),this.listContents.setPosition(this.contents.position()),this.addContents(this.listContents)},ListMorph.prototype.select=function(t,e){isNil(t)||(this.selected=t,this.active=e,this.action&&this.action.call(null,t))},ListMorph.prototype.setExtent=function(t){var e=this.listContents.bounds,o=this.bounds.origin.copy().corner(this.bounds.origin.add(t));o.right()>e.right()&&o.width()<=e.width()&&this.listContents.setRight(o.right()),o.bottom()>e.bottom()&&o.height()<=e.height()&&this.listContents.setBottom(o.bottom()),ListMorph.uber.setExtent.call(this,t)},ListMorph.prototype.activeIndex=function(){return this.listContents.children.indexOf(this.active)},ListMorph.prototype.activateIndex=function(t){var e=this.listContents.children[t];e&&(e.image=e.pressImage,e.changed(),e.trigger())},StringFieldMorph.prototype=new FrameMorph,StringFieldMorph.prototype.constructor=StringFieldMorph,StringFieldMorph.uber=FrameMorph.prototype,StringFieldMorph.prototype.init=function(t,e,o,i,n,r,s){this.defaultContents=t,this.minWidth=e,this.fontSize=o,this.fontStyle=i,this.isBold=n,this.isItalic=r,this.isNumeric=s||!1,this.text=null,StringFieldMorph.uber.init.call(this),this.color=new Color(255,255,255),this.isEditable=!0,this.acceptsDrops=!1,this.drawNew()},StringFieldMorph.prototype.drawNew=function(){var t;t=this.text?this.string():this.defaultContents,this.text=null,this.children.forEach((function(t){t.destroy()})),this.children=[],this.text=new StringMorph(t,this.fontSize,this.fontStyle,this.isBold,this.isItalic,this.isNumeric),this.text.isNumeric=this.isNumeric,this.text.setPosition(this.bounds.origin.copy()),this.text.isEditable=this.isEditable,this.text.isDraggable=!1,this.text.enableSelecting(),this.silentSetExtent(new Point(Math.max(this.width(),this.minWidth),this.text.height())),StringFieldMorph.uber.drawNew.call(this),this.add(this.text)},StringFieldMorph.prototype.string=function(){return this.text.text},StringFieldMorph.prototype.mouseClickLeft=function(t){this.isEditable?this.text.edit():this.escalateEvent("mouseClickLeft",t)},BouncerMorph.prototype=new Morph,BouncerMorph.prototype.constructor=BouncerMorph,BouncerMorph.uber=Morph.prototype,BouncerMorph.prototype.init=function(t,e){BouncerMorph.uber.init.call(this),this.fps=50,this.isStopped=!1,this.type=t||"vertical","vertical"===this.type?this.direction="down":this.direction="right",this.speed=e||1},BouncerMorph.prototype.moveUp=function(){this.moveBy(new Point(0,-this.speed))},BouncerMorph.prototype.moveDown=function(){this.moveBy(new Point(0,this.speed))},BouncerMorph.prototype.moveRight=function(){this.moveBy(new Point(this.speed,0))},BouncerMorph.prototype.moveLeft=function(){this.moveBy(new Point(-this.speed,0))},BouncerMorph.prototype.step=function(){this.isStopped||("vertical"===this.type?("down"===this.direction?this.moveDown():this.moveUp(),this.fullBounds().top()<this.parent.top()&&"up"===this.direction&&(this.direction="down"),this.fullBounds().bottom()>this.parent.bottom()&&"down"===this.direction&&(this.direction="up")):"horizontal"===this.type&&("right"===this.direction?this.moveRight():this.moveLeft(),this.fullBounds().left()<this.parent.left()&&"left"===this.direction&&(this.direction="right"),this.fullBounds().right()>this.parent.right()&&"right"===this.direction&&(this.direction="left")))},HandMorph.prototype=new Morph,HandMorph.prototype.constructor=HandMorph,HandMorph.uber=Morph.prototype,HandMorph.prototype.init=function(t){HandMorph.uber.init.call(this,!0),this.bounds=new Rectangle,this.world=t,this.mouseButton=null,this.mouseOverList=[],this.morphToGrab=null,this.grabPosition=null,this.grabOrigin=null,this.temporaries=[],this.touchHoldTimeout=null,this.contextMenuEnabled=!1},HandMorph.prototype.changed=function(){var t;null!==this.world&&((t=this.fullBounds()).extent().eq(new Point)||this.world.broken.push(t.spread()))},HandMorph.prototype.fullChanged=HandMorph.prototype.changed,HandMorph.prototype.morphAtPointer=function(){return this.world.topMorphAt(this.bounds.origin)||this.world},HandMorph.prototype.allMorphsAtPointer=function(){var t=this.world.allChildren(),e=this;return t.filter((function(t){return t.isVisible&&t.visibleBounds().containsPoint(e.bounds.origin)}))},HandMorph.prototype.dropTargetFor=function(t){for(var e=this.morphAtPointer();!e.wantsDropOf(t);)e=e.parent;return e},HandMorph.prototype.grab=function(t){var e=t.parent;if(t instanceof WorldMorph)return null;0===this.children.length&&(this.world.stopEditing(),this.grabOrigin=t.situation(),t instanceof MenuMorph||t.addShadow(),t.prepareToBeGrabbed&&t.prepareToBeGrabbed(this),t.cachedFullImage=t.fullImageClassic(),t.cachedFullBounds=t.fullBounds(),this.add(t),this.changed(),e&&e.reactToGrabOf&&e.reactToGrabOf(t))},HandMorph.prototype.drop=function(){var t,e;0!==this.children.length&&(e=this.children[0],t=(t=this.dropTargetFor(e)).selectForEdit?t.selectForEdit():t,this.changed(),t.add(e),e.cachedFullImage=null,e.cachedFullBounds=null,e.changed(),e instanceof MenuMorph||e.removeShadow(),this.children=[],this.setExtent(new Point),e.justDropped&&e.justDropped(this),t.reactToDropOf&&t.reactToDropOf(e,this))},HandMorph.prototype.processMouseDown=function(t){var e,o;if(this.destroyTemporaries(),this.contextMenuEnabled=!0,this.morphToGrab=null,this.grabPosition=null,0!==this.children.length)this.drop(),this.mouseButton=null;else{for(e=this.morphAtPointer(),this.world.activeMenu&&(contains(e.allParents(),this.world.activeMenu)?clearInterval(this.touchHoldTimeout):this.world.activeMenu.destroy()),this.world.activeHandle&&e!==this.world.activeHandle&&this.world.activeHandle.destroy(),this.world.cursor&&e!==this.world.cursor.target&&this.world.stopEditing(),e.mouseMove||(this.morphToGrab=e.rootForGrab(),this.grabPosition=this.bounds.origin.copy()),2===t.button||t.ctrlKey?(this.mouseButton="right",o="mouseDownRight"):(this.mouseButton="left",o="mouseDownLeft");!e[o];)e=e.parent;e[o](this.bounds.origin)}},HandMorph.prototype.processTouchStart=function(t){var e=this;MorphicPreferences.isTouchDevice=!0,clearInterval(this.touchHoldTimeout),1===t.touches.length&&(this.touchHoldTimeout=setInterval((function(){e.processMouseDown({button:2}),e.processMouseUp({button:2}),t.preventDefault(),clearInterval(e.touchHoldTimeout)}),400),this.processMouseMove(t.touches[0]),this.processMouseDown({button:0}),t.preventDefault())},HandMorph.prototype.processTouchMove=function(t){if(MorphicPreferences.isTouchDevice=!0,1===t.touches.length){var e=t.touches[0];this.processMouseMove(e),clearInterval(this.touchHoldTimeout)}},HandMorph.prototype.processTouchEnd=function(t){MorphicPreferences.isTouchDevice=!0,clearInterval(this.touchHoldTimeout),nop(t),this.processMouseUp({button:0})},HandMorph.prototype.processMouseUp=function(){var t,e,o,i=this.morphAtPointer();if(this.destroyTemporaries(),0!==this.children.length)this.drop();else{if("left"===this.mouseButton)o="mouseClickLeft";else if(o="mouseClickRight",this.mouseButton&&this.contextMenuEnabled){for(e=(t=i).contextMenu();!e&&t.parent;)e=(t=t.parent).contextMenu();e&&e.popUpAtHand(this.world)}for(;!i[o];)i=i.parent;i[o](this.bounds.origin)}this.mouseButton=null},HandMorph.prototype.processDoubleClick=function(){var t=this.morphAtPointer();if(this.destroyTemporaries(),0!==this.children.length)this.drop();else{for(;t&&!t.mouseDoubleClick;)t=t.parent;t&&t.mouseDoubleClick(this.bounds.origin)}this.mouseButton=null},HandMorph.prototype.processMouseMove=function(t){var e,o,i,n,r=getDocumentPositionOf(this.world.worldCanvas),s=this;e=new Point(t.pageX-r.x,t.pageY-r.y),this.setPosition(e),o=this.morphAtPointer().allParents(),!this.children.length&&this.mouseButton&&(i=(n=this.morphAtPointer()).rootForGrab(),n.mouseMove&&(n.mouseMove(e,this.mouseButton),"right"===this.mouseButton&&(this.contextMenuEnabled=!1)),"left"===this.mouseButton&&this.morphToGrab&&this.grabPosition.distanceTo(this.bounds.origin)>MorphicPreferences.grabThreshold&&(this.setPosition(this.grabPosition),this.morphToGrab.isDraggable?(i=this.morphToGrab.selectForEdit?this.morphToGrab.selectForEdit():this.morphToGrab,this.grab(i)):this.morphToGrab.isTemplate&&(this.world.stopEditing(),(i=this.morphToGrab.fullCopy()).isTemplate=!1,i.isDraggable=!0,i.reactToTemplateCopy&&i.reactToTemplateCopy(),this.grab(i),this.grabOrigin=this.morphToGrab.situation()),this.setPosition(e))),this.mouseOverList.forEach((function(t){contains(o,t)||(t.mouseLeave&&t.mouseLeave(),t.mouseLeaveDragging&&s.mouseButton&&t.mouseLeaveDragging())})),o.forEach((function(t){contains(s.mouseOverList,t)||(t.mouseEnter&&t.mouseEnter(),t.mouseEnterDragging&&s.mouseButton&&t.mouseEnterDragging()),s.children.length>0&&t instanceof ScrollFrameMorph&&t.enableAutoScrolling&&t.contents.allChildren().some((function(t){return t.wantsDropOf(s.children[0])}))&&(t.bounds.insetBy(3*MorphicPreferences.scrollBarSize).containsPoint(s.bounds.origin)||t.startAutoScrolling())})),this.mouseOverList=o},HandMorph.prototype.processMouseScroll=function(t){for(var e=this.morphAtPointer();e&&!e.mouseScroll;)e=e.parent;e&&e.mouseScroll(t.detail/-3||(Object.prototype.hasOwnProperty.call(t,"wheelDeltaY")?t.wheelDeltaY/120:t.wheelDelta/120),t.wheelDeltaX/120||0)},HandMorph.prototype.processDrop=function(t){var e,o,i,n,r,s=t instanceof FileList?t:t.target.files||t.dataTransfer.files,h=t.dataTransfer?t.dataTransfer.getData("URL"):null,a=t.dataTransfer?t.dataTransfer.getData("Text/HTML"):null,l=this.morphAtPointer(),c=new Image;function u(t){for(var e=new Image,o=new FileReader;!l.droppedSVG;)l=l.parent;e.onload=function(){l.droppedSVG(e,t.name)},(o=new FileReader).onloadend=function(t){e.src=t.target.result},o.readAsDataURL(t)}function p(t){for(var e=new Image,o=new FileReader;!l.droppedImage;)l=l.parent;e.onload=function(){(n=newCanvas(new Point(e.width,e.height),!0)).getContext("2d").drawImage(e,0,0),l.droppedImage(n,t.name)},(o=new FileReader).onloadend=function(t){e.src=t.target.result},o.readAsDataURL(t)}function d(t){for(var e=new Audio,o=new FileReader;!l.droppedAudio;)l=l.parent;o.onloadend=function(o){e.src=o.target.result,l.droppedAudio(e,t.name)},o.readAsDataURL(t)}function f(t){for(var e=new FileReader;!l.droppedText;)l=l.parent;e.onloadend=function(e){l.droppedText(e.target.result,t.name)},e.readAsText(t)}function g(t){for(var e=new FileReader;!l.droppedBinary;)l=l.parent;e.onloadend=function(e){l.droppedBinary(e.target.result,t.name)},e.readAsArrayBuffer(t)}if(s.length>0)for(r=0;r<s.length;r+=1)-1===(e=s[r]).type.indexOf("svg")||MorphicPreferences.rasterizeSVGs?0===e.type.indexOf("image")?p(e):0===e.type.indexOf("audio")?d(e):0===e.type.indexOf("text")?f(e):g(e):u(e);else if(h){if(contains(["gif","png","jpg","jpeg","bmp"],o=h.slice(h.lastIndexOf(".")+1).toLowerCase())){for(;!l.droppedImage;)l=l.parent;(c=new Image).onload=function(){(n=newCanvas(new Point(c.width,c.height),!0)).getContext("2d").drawImage(c,0,0),l.droppedImage(n)},c.src=h}else if("svg"===o&&!MorphicPreferences.rasterizeSVGs){for(;!l.droppedSVG;)l=l.parent;!function(t,e){var o=new XMLHttpRequest;o.open("GET",t),o.onreadystatechange=function(){if(4===o.readyState){if(!o.responseText)throw new Error("unable to retrieve "+t);e(o.responseText)}},o.send()}(h,(function(t){var e=new Image;e.onload=function(){l.droppedSVG(e,h.slice(h.lastIndexOf("/")+1,h.lastIndexOf(".")))},e.src="data:image/svg+xml;utf8,"+encodeURIComponent(t)}))}}else if(a){for(;!l.droppedImage;)l=l.parent;(c=new Image).onload=function(){(n=newCanvas(new Point(c.width,c.height),!0)).getContext("2d").drawImage(c,0,0),l.droppedImage(n)},(i=function(t){var e,o,i="",n=t.indexOf('<img src="');if(-1===n)return null;for(e=n+=10;e<t.length;e+=1){if('"'===(o=t[e]))return i;i=i.concat(o)}return null}(a))&&(c.src=i)}},HandMorph.prototype.destroyTemporaries=function(){var t=this;this.temporaries.forEach((function(e){e.isClickable&&e.bounds.containsPoint(t.position())||(e.destroy(),t.temporaries.splice(t.temporaries.indexOf(e),1))}))},WorldMorph.prototype=new FrameMorph,WorldMorph.prototype.constructor=WorldMorph,WorldMorph.uber=FrameMorph.prototype,WorldMorph.prototype.init=function(t,e){for(WorldMorph.uber.init.call(this),this.color=new Color(205,205,205),this.alpha=1,this.bounds=new Rectangle(0,0,t.width,t.height),this.drawNew(),this.isVisible=!0,this.isDraggable=!1,this.currentKey=null,this.worldCanvas=t,this.noticesTransparentClick=!0,this.stamp=Date.now();this.stamp===Date.now();)nop();this.stamp=Date.now(),this.useFillPage=e,void 0===this.useFillPage&&(this.useFillPage=!0),this.isDevMode=!1,this.broken=[],this.animations=[],this.hand=new HandMorph(this),this.keyboardReceiver=null,this.cursor=null,this.lastEditedText=null,this.activeMenu=null,this.activeHandle=null,this.virtualKeyboard=null,this.initEventListeners()},WorldMorph.prototype.brokenFor=function(t){var e=t.fullBounds();return this.broken.filter((function(t){return t.intersects(e)}))},WorldMorph.prototype.fullDrawOn=function(t,e){WorldMorph.uber.fullDrawOn.call(this,t,e),this.hand.fullDrawOn(t,e)},WorldMorph.prototype.updateBroken=function(){var t=this;this.condenseDamages(),this.broken.forEach((function(e){e.extent().gt(new Point(0,0))&&t.fullDrawOn(t.worldCanvas,e)})),this.broken=[]},WorldMorph.prototype.stepAnimations=function(){this.animations.forEach((function(t){t.step()})),this.animations=this.animations.filter((function(t){return t.isActive}))},WorldMorph.prototype.condenseDamages=function(){function t(t){var e,o=[];return t.forEach((function(t){(e=detect(o,(function(e){return e.isNearTo(t,20)})))?e.mergeWith(t):o.push(t)})),o}for(var e=!0,o=this.broken.length;e;)this.broken=t(this.broken),e=this.broken.length<o,o=this.broken.length},WorldMorph.prototype.doOneCycle=function(){this.stepFrame(),this.stepAnimations(),this.updateBroken()},WorldMorph.prototype.fillPage=function(){var t=window.innerHeight,e=window.innerWidth,o=this;this.worldCanvas.style.position="absolute",this.worldCanvas.style.left="0px",this.worldCanvas.style.right="0px",this.worldCanvas.style.width="100%",this.worldCanvas.style.height="100%",document.documentElement.scrollTop&&(t=document.documentElement.clientHeight),document.documentElement.scrollLeft&&(e=document.documentElement.clientWidth),this.worldCanvas.width!==e&&(this.worldCanvas.width=e,this.setWidth(e)),this.worldCanvas.height!==t&&(this.worldCanvas.height=t,this.setHeight(t)),this.children.forEach((function(t){t.reactToWorldResize&&t.reactToWorldResize(o.bounds.copy())}))},WorldMorph.prototype.getGlobalPixelColor=function(t){return this.hand.morphAtPointer().getPixelColor(this.hand.position())},WorldMorph.prototype.initVirtualKeyboard=function(){var t=this;this.virtualKeyboard&&(document.body.removeChild(this.virtualKeyboard),this.virtualKeyboard=null),MorphicPreferences.isTouchDevice&&MorphicPreferences.useVirtualKeyboard&&(this.virtualKeyboard=document.createElement("input"),this.virtualKeyboard.type="text",this.virtualKeyboard.style.color="transparent",this.virtualKeyboard.style.backgroundColor="transparent",this.virtualKeyboard.style.border="none",this.virtualKeyboard.style.outline="none",this.virtualKeyboard.style.position="absolute",this.virtualKeyboard.style.top="0px",this.virtualKeyboard.style.left="0px",this.virtualKeyboard.style.width="0px",this.virtualKeyboard.style.height="0px",this.virtualKeyboard.autocapitalize="none",document.body.appendChild(this.virtualKeyboard),this.virtualKeyboard.addEventListener("keydown",(function(e){t.currentKey=e.keyCode,t.keyboardReceiver&&t.keyboardReceiver.processKeyDown(e),8===e.keyCode&&e.preventDefault(),9===e.keyCode&&(t.keyboardReceiver&&t.keyboardReceiver.processKeyPress(e),e.preventDefault())}),!1),this.virtualKeyboard.addEventListener("keyup",(function(e){t.currentKey=null,t.keyboardReceiver&&t.keyboardReceiver.processKeyUp&&t.keyboardReceiver.processKeyUp(e),e.preventDefault()}),!1),this.virtualKeyboard.addEventListener("keypress",(function(e){t.keyboardReceiver&&t.keyboardReceiver.processKeyPress(e),e.preventDefault()}),!1))},WorldMorph.prototype.initEventListeners=function(){var t=this.worldCanvas,e=this;e.useFillPage?e.fillPage():this.changed(),t.addEventListener("mousedown",(function(o){o.preventDefault(),t.focus(),e.hand.processMouseDown(o)}),!1),t.addEventListener("touchstart",(function(t){e.hand.processTouchStart(t)}),!1),t.addEventListener("mouseup",(function(t){t.preventDefault(),e.hand.processMouseUp(t)}),!1),t.addEventListener("dblclick",(function(t){t.preventDefault(),e.hand.processDoubleClick(t)}),!1),t.addEventListener("touchend",(function(t){e.hand.processTouchEnd(t)}),!1),t.addEventListener("mousemove",(function(t){e.hand.processMouseMove(t)}),!1),t.addEventListener("touchmove",(function(t){e.hand.processTouchMove(t)}),!1),t.addEventListener("contextmenu",(function(t){t.preventDefault()}),!1),t.addEventListener("keydown",(function(t){e.currentKey=t.keyCode,e.keyboardReceiver&&e.keyboardReceiver.processKeyDown(t),8===t.keyCode&&t.preventDefault(),9===t.keyCode&&(e.keyboardReceiver&&e.keyboardReceiver.processKeyPress(t),t.preventDefault()),(t.ctrlKey&&!t.altKey||t.metaKey)&&86!==t.keyCode&&t.preventDefault()}),!1),t.addEventListener("keyup",(function(t){e.currentKey=null,e.keyboardReceiver&&e.keyboardReceiver.processKeyUp&&e.keyboardReceiver.processKeyUp(t),t.preventDefault()}),!1),t.addEventListener("keypress",(function(t){e.keyboardReceiver&&e.keyboardReceiver.processKeyPress(t),t.preventDefault()}),!1),t.addEventListener("mousewheel",(function(t){e.hand.processMouseScroll(t),t.preventDefault()}),!1),t.addEventListener("DOMMouseScroll",(function(t){e.hand.processMouseScroll(t),t.preventDefault()}),!1),document.body.addEventListener("paste",(function(t){var o=t.clipboardData.getData("Text");o&&e.cursor&&e.cursor.insert(o)}),!1),window.addEventListener("dragover",(function(t){t.preventDefault()}),!1),window.addEventListener("drop",(function(t){e.hand.processDrop(t),t.preventDefault()}),!1),window.addEventListener("resize",(function(){e.useFillPage&&e.fillPage()}),!1),window.onbeforeunload=function(t){var e=t||window.event,o="Are you sure you want to leave?";return e&&(e.returnValue=o),o}},WorldMorph.prototype.mouseDownLeft=nop,WorldMorph.prototype.mouseClickLeft=nop,WorldMorph.prototype.mouseDownRight=nop,WorldMorph.prototype.mouseClickRight=nop,WorldMorph.prototype.wantsDropOf=function(){return this.acceptsDrops},WorldMorph.prototype.droppedImage=function(){return null},WorldMorph.prototype.droppedSVG=function(){return null},WorldMorph.prototype.nextTab=function(t){var e=this.nextEntryField(t);e&&(t.clearSelection(),e.selectAll(),e.edit())},WorldMorph.prototype.previousTab=function(t){var e=this.previousEntryField(t);e&&(t.clearSelection(),e.selectAll(),e.edit())},WorldMorph.prototype.contextMenu=function(){var t;return t=this.isDevMode?new MenuMorph(this,this.constructor.name||this.constructor.toString().split(" ")[1].split("(")[0]):new MenuMorph(this,"Morphic"),this.isDevMode&&(t.addItem("demo...","userCreateMorph","sample morphs"),t.addLine(),t.addItem("hide all...","hideAll"),t.addItem("show all...","showAllHiddens"),t.addItem("move all inside...","keepAllSubmorphsWithin","keep all submorphs\nwithin and visible"),t.addItem("inspect...","inspect","open a window on\nall properties"),t.addItem("screenshot...",(function(){window.open(this.fullImageClassic().toDataURL())}),"open a new window\nwith a picture of this morph.jsk"),t.addLine(),t.addItem("restore display","changed","redraw the\nscreen once"),t.addItem("fill page...","fillPage","let the World automatically\nadjust to browser resizing"),useBlurredShadows?t.addItem("sharp shadows...","toggleBlurredShadows","sharp drop shadows\nuse for old browsers"):t.addItem("blurred shadows...","toggleBlurredShadows","blurry shades,\n use for new browsers"),t.addItem("color...",(function(){this.pickColor(t.title+localize("\ncolor:"),this.setColor,this,this.color)}),"choose the World's\nbackground color"),MorphicPreferences===standardSettings?t.addItem("touch screen settings","togglePreferences","bigger menu fonts\nand sliders"):t.addItem("standard settings","togglePreferences","smaller menu fonts\nand sliders"),t.addLine()),this.isDevMode?t.addItem("user mode...","toggleDevMode","disable developers'\ncontext menus"):t.addItem("development mode...","toggleDevMode"),t.addItem("about morphic.js...","about"),t},WorldMorph.prototype.userCreateMorph=function(){var t,e,o=this;function i(t){t.isDraggable=!0,t.pickUp(o)}(t=new MenuMorph(this,"make a morph.jsk")).addItem("rectangle",(function(){i(new Morph)})),t.addItem("box",(function(){i(new BoxMorph)})),t.addItem("circle box",(function(){i(new CircleBoxMorph)})),t.addLine(),t.addItem("slider",(function(){i(new SliderMorph)})),t.addItem("dial",(function(){(e=new DialMorph).pickUp(this)})),t.addItem("frame",(function(){(e=new FrameMorph).setExtent(new Point(350,250)),i(e)})),t.addItem("scroll frame",(function(){(e=new ScrollFrameMorph).contents.acceptsDrops=!0,e.contents.adjustBounds(),e.setExtent(new Point(350,250)),i(e)})),t.addItem("handle",(function(){i(new HandleMorph)})),t.addLine(),t.addItem("string",(function(){(e=new StringMorph("Hello, World!")).isEditable=!0,i(e)})),t.addItem("text",(function(){(e=new TextMorph("Ich weiß nicht, was soll es bedeuten, dass ich so traurig bin, ein Märchen aus uralten Zeiten, das kommt mir nicht aus dem Sinn. Die Luft ist kühl und es dunkelt, und ruhig fließt der Rhein; der Gipfel des Berges funkelt im Abendsonnenschein. Die schönste Jungfrau sitzet dort oben wunderbar, ihr gold'nes Geschmeide blitzet, sie kämmt ihr goldenes Haar, sie kämmt es mit goldenem Kamme, und singt ein Lied dabei; das hat eine wundersame, gewalt'ge Melodei. Den Schiffer im kleinen Schiffe, ergreift es mit wildem Weh; er schaut nicht die Felsenriffe, er schaut nur hinauf in die Höh'. Ich glaube, die Wellen verschlingen am Ende Schiffer und Kahn, und das hat mit ihrem Singen, die Loreley getan.")).isEditable=!0,e.maxWidth=300,e.drawNew(),i(e)})),t.addItem("speech bubble",(function(){i(e=new SpeechBubbleMorph("Hello, World!"))})),t.addLine(),t.addItem("gray scale palette",(function(){i(new GrayPaletteMorph)})),t.addItem("color palette",(function(){i(new ColorPaletteMorph)})),t.addItem("color picker",(function(){i(new ColorPickerMorph)})),t.addLine(),t.addItem("sensor demo",(function(){(e=new MouseSensorMorph).setColor(new Color(230,200,100)),e.edge=35,e.border=15,e.borderColor=new Color(200,100,50),e.alpha=.2,e.setExtent(new Point(100,100)),i(e)})),t.addItem("animation demo",(function(){var t,e,o,n,r;(t=new BouncerMorph).setPosition(new Point(50,20)),t.setExtent(new Point(300,200)),t.alpha=.9,t.speed=3,(e=new BouncerMorph).setColor(new Color(50,50,50)),e.setPosition(new Point(80,80)),e.setExtent(new Point(80,250)),e.type="horizontal",e.direction="right",e.alpha=.9,e.speed=5,(o=new BouncerMorph).setColor(new Color(20,20,20)),o.setPosition(new Point(90,140)),o.setExtent(new Point(40,30)),o.type="horizontal",o.direction="right",o.speed=3,(n=new BouncerMorph).setColor(new Color(200,20,20)),n.setPosition(new Point(90,140)),n.setExtent(new Point(20,20)),n.type="vertical",n.direction="up",n.speed=8,(r=new BouncerMorph).setColor(new Color(20,200,20)),r.setPosition(new Point(120,140)),r.setExtent(new Point(20,20)),r.type="vertical",r.direction="down",r.speed=4,e.add(n),e.add(o),t.add(r),t.add(e),i(t)})),t.addItem("pen",(function(){i(new PenMorph)})),o.customMorphs&&(t.addLine(),o.customMorphs().forEach((function(e){t.addItem(e.toString(),(function(){i(e)}))}))),t.popUpAtHand(this)},WorldMorph.prototype.toggleDevMode=function(){this.isDevMode=!this.isDevMode},WorldMorph.prototype.hideAll=function(){this.children.forEach((function(t){t.hide()}))},WorldMorph.prototype.showAllHiddens=function(){this.forAllChildren((function(t){t.isVisible||t.show()}))},WorldMorph.prototype.about=function(){var t,e="";for(t in modules)Object.prototype.hasOwnProperty.call(modules,t)&&(e+="\n"+t+" ("+modules[t]+")");""!==e&&(e="\n\nmodules:\n\nmorphic ("+morphicVersion+")"+e),this.inform("morphic.js\n\na lively Web GUI\ninspired by Squeak\n"+morphicVersion+"\n\nwritten by Jens Mönig\njens@moenig.org"+e)},WorldMorph.prototype.edit=function(t){var e=getDocumentPositionOf(this.worldCanvas);if(!t.isEditable)return null;this.cursor&&this.cursor.destroy(),this.cursor=new CursorMorph(t),t.parent.add(this.cursor),this.keyboardReceiver=this.cursor,this.initVirtualKeyboard(),MorphicPreferences.isTouchDevice&&MorphicPreferences.useVirtualKeyboard&&(this.virtualKeyboard.style.top=this.cursor.top()+e.y+"px",this.virtualKeyboard.style.left=this.cursor.left()+e.x+"px",this.virtualKeyboard.focus()),MorphicPreferences.useSliderForInput&&(t.parentThatIsA(MenuMorph)||this.slide(t)),this.lastEditedText!==t&&t.escalateEvent("freshTextEdit",t),this.lastEditedText=t},WorldMorph.prototype.slide=function(t){var e,o,i=parseFloat(t.text);isNaN(i)&&(i=0),e=new MenuMorph,(o=new SliderMorph(i-25,i+25,i,10,"horizontal")).alpha=1,o.color=new Color(225,225,225),o.button.color=e.borderColor,o.button.highlightColor=o.button.color.copy(),o.button.highlightColor.b+=100,o.button.pressColor=o.button.color.copy(),o.button.pressColor.b+=150,o.silentSetHeight(MorphicPreferences.scrollBarSize),o.silentSetWidth(10*MorphicPreferences.menuFontSize),o.drawNew(),o.action=function(e){t.changed(),t.text=Math.round(e).toString(),t.drawNew(),t.changed(),t.escalateEvent("reactToSliderEdit",t)},e.items.push(o),e.popup(this,t.bottomLeft().add(new Point(0,5)))},WorldMorph.prototype.stopEditing=function(){this.cursor&&(this.cursor.target.escalateEvent("reactToEdit",this.cursor.target),this.cursor.target.clearSelection(),this.cursor.destroy(),this.cursor=null),this.keyboardReceiver&&this.keyboardReceiver.stopEditing&&this.keyboardReceiver.stopEditing(),this.keyboardReceiver=null,this.virtualKeyboard&&(this.virtualKeyboard.blur(),document.body.removeChild(this.virtualKeyboard),this.virtualKeyboard=null),this.lastEditedText=null,this.worldCanvas.focus()},WorldMorph.prototype.toggleBlurredShadows=function(){useBlurredShadows=!useBlurredShadows},WorldMorph.prototype.togglePreferences=function(){MorphicPreferences=MorphicPreferences===standardSettings?touchScreenSettings:standardSettings}},function(t,e,o){"use strict";o.r(e),o.d(e,"vue",(function(){return n})),o.d(e,"react",(function(){return r}));var i=o(9);function n(t,e){return{render:e}}function r(t,e){return t.createClass({render:i.a(e,t.createElement)})}},function(t,e,o){"use strict";(function(t){var o="object"==typeof t&&t&&t.Object===Object&&t;e.a=o}).call(this,o(13))},function(t,e,o){"use strict";o.d(e,"a",(function(){return i}));var i=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var i=e.reduce((function(t,e){return function(o){return e(t(o))}}),(function(t){return t}));return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return i(t.apply(void 0,e))}}},function(t,e,o){"use strict";var i,n=o(6),r=o.n(n),s=(o(24),i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.contextMenu=function(){var e=t.prototype.contextMenu.call(this),o=this.world().contextMenu(),i=r()(this.world().canvas);o.items.forEach((function(t){return e.addItem.apply(e,t)}));var n=this.vms;return n&&n.forEach((function(t){return e.addMenu(t.appName,t.ol_menu.reduce((function(t,e){return t.addItem.apply(t,e),t}),new MenuMorph))})),e.addItem("Delete Canvas",i.detach.bind(i)),this.sys&&e.addMenu("System",this.sys.menu.call(this.sys,MenuMorph,i)),e},e}(Morph);e.a=h},function(t,e,o){"use strict";var i=o(3),n=o.n(i);e.a=n()("app_",(function(t,e,o){var i,n;return"ol_AppSetParam"===o.type?((i={})[o.data.appID]=Object.assign({},e[o.data.appID],((n={})[o.data.param]=o.data.value,n)),i):e}))},function(t,e,o){"use strict";var i=o(9);function n(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}e.a=function(){return new Array(3).map(i.a(n,12448,12543)).map(String.fromCodePoint.bind(String)).join("")}},function(t,e,o){"use strict";function i(t,e,o){void 0===e&&(e={});var i=t();if(!i)return e;var n=e.vms||[];e.p||Promise.resolve();if("addVMID"===o.type)return Object.assign({},e,{vms:e.vms.concat([o.data])});var r=n.map((function(t){return i.olVms[t.id]}));return Object.assign({},e,{p:r.map((function(t){return t.olRedux.reducer})).reduce((function(t,e){return t.then((function(t){return e(t,o)}))}),e.p)})}o.d(e,"a",(function(){return i}))},function(t,e,o){"use strict";e.a=function(t,e,o,i){return void 0===e&&(e={p:Promise.resolve()}),"postPromise"===o.type?i(Object.assign({},e,{p:e.p.then((function(t){return o.data(t)}))}),o):i(e,o)}},function(t,e,o){"use strict";function i(t,e){return[new ReadableStream({start:function(e){return t(e.enqueue.bind(e))}}),new WritableStream({write:function(t){return e().write(t)}})]}o.d(e,"a",(function(){return i}))},function(t,e,o){"use strict";(function(t){e.a=(window||t||self).driver&&(window||t||self).driver.eval}).call(this,o(13))},function(t,e,o){"use strict";function i(t){var e,o=t.Symbol;return"function"==typeof o?o.observable?e=o.observable:(e=o("observable"),o.observable=e):e="@@observable",e}o.d(e,"a",(function(){return i}))},function(t,e,o){"use strict";function i(t,e){Array.prototype.filter.call(t.childNodes,(function(t){return t.classList.includes("ol-inject")})).length||e()}function n(t){t.classList.add("ol-inject")}var r=function(){function t(t,e){this._ui=t,this.options=e}return t.prototype.listen=function(t){var e=new MutationObserver(this.mutated.bind(this));return e.observe(t,{attributes:!0,childList:!0,subtree:!0}),e.disconnect.bind(e)},t.prototype.olStartup=function(t){},t.prototype.ol_m_click=function(t,e){},t.prototype.mutated=function(t,e){var o=this._ui.Current;t.forEach((function(t){t.target;t.addedNodes&&t.addedNodes.forEach((function(t){var e,r,s=this;if(t.classList){var h=void 0;[].includes.call(t.classList,"osjs-window-icon")&&function(t,e){i(t,(function(){if(e){var o=document.createElement("span");t.appendChild(o),o.addEventListener("click",e.titleClickNative.bind(e,t)),n(o)}}))}(t,o),[].includes.call(t.classList,"osjs-gui-box")&&(r=this,i(e=t,(function(){Array.prototype.filter.call(e.childNodes,(function(t){return t.classList.includes("osjs-gui-menubar")})).forEach((function(t){i(t,(function(){var e=document.createElement("span");e.innerText="ObjectLand",e.addEventListener("click",r.ol_m_click.bind(r,e)),t.appendChild(e),n(t)}))})),n(e)}))),[].includes.call(t.classList,"ol-rolly-injected")&&function(t,e){i(t,(function(){t.addEventListener("olStartup",e.olStartup.bind(e,t)),n(t)}))}(t,this),(h=[].filter.call(t.classList,(function(t){return t.startsWith("green-flag")}))).length&&h.forEach((function(t){return t.addEventListener("click",s.options.onFlagScratchClicked.bind(t,s))}))}}))}))},t}();e.a=r},function(t,e,o){"use strict";function i(t,e,o){t.data.port.postMessage({postToWindow:{workerID:e,data:o}})}function n(t){var e=t.win,o=(t.workerMap,t.libs,t.chrome,t.callback);if(e.inGadgetHelper){new Map;e.addEventListener("message",(function(t){if("init"===t.data.type){i.bind(void 0,t);t.data.port.addEventListener("message",(function(e){if("addGadget"===e.data.type){var o=new Array(10).map((function(t){return String.fromCharCode(128*Math.random()+20)})).reduce((function(t,e){return t?t+e:e}));t.data.port.postMessage({postToWindow:{workerID:o,create:!0,url:e.data.data}});var i=new OffscreenCanvas(400,400),n=new MessageChannel;!function(t,e,o,i){e.addEventListener("message",(function(t){}))}(0,n.port1,0,t.data.port),t.data.port.postMessage({postToWindow:{workerID:o,data:{canvas:i,port:n.port2},transferables:[i,n.port2]},postToWindow_transferables:[i,n.port2]})}}))}}))}else{var n=new MessageChannel;e.postMessage({workerID:"GadgetHelper",data:{type:"init",port:n.port2},transferrables:[n.port2]},"*",[n.port2]),n.port1.addEventListener("message",(function(t){t.data.postToWindow&&e.postMessage(Object.assign({},t.data.postToWindow,{transferables:t.data.postToWindow_transferables}),"*",t.data.postToWindow_transferrables||[]),t.data.callBackLink&&o((function(e,o){return n.port1.postMessage({winCallback:t.data.callBackTag,data:e,transferables:o},o)}))})),e.addEventListener("message",(function(t){n.port1.postMessage({messageFromWindow:t.data},t.data.transferables)}))}}o.d(e,"a",(function(){return n}))},function(t,e,o){"use strict";var i=o(1),n=o(0),r=function(){return n.a.Date.now()},s=o(10),h="Expected a function",a=Math.max,l=Math.min;var c=function(t,e,o){var n,c,u,p,d,f,g=0,y=!1,m=!1,M=!0;if("function"!=typeof t)throw new TypeError(h);function w(e){var o=n,i=c;return n=c=void 0,g=e,p=t.apply(i,o)}function b(t){var o=t-f;return void 0===f||o>=e||o<0||m&&t-g>=u}function v(){var t=r();if(b(t))return S(t);d=setTimeout(v,function(t){var o=e-(t-f);return m?l(o,u-(t-g)):o}(t))}function S(t){return d=void 0,M&&n?w(t):(n=c=void 0,p)}function x(){var t=r(),o=b(t);if(n=arguments,c=this,f=t,o){if(void 0===d)return function(t){return g=t,d=setTimeout(v,e),y?w(t):p}(f);if(m)return clearTimeout(d),d=setTimeout(v,e),w(f)}return void 0===d&&(d=setTimeout(v,e)),p}return e=Object(s.a)(e)||0,Object(i.a)(o)&&(y=!!o.leading,u=(m="maxWait"in o)?a(Object(s.a)(o.maxWait)||0,e):u,M="trailing"in o?!!o.trailing:M),x.cancel=function(){void 0!==d&&clearTimeout(d),g=0,n=f=c=d=void 0},x.flush=function(){return void 0===d?p:S(r())},x};function u(t,e,o,i){var n=new MessageChannel,r=new MessageChannel;t.postMessage({type:"initPorts",alertPort:n.port2,consolePorts:r.port2},"*",[n.port2,r.port2]),n.port1.addEventListener("message",c(e.alertPort.postMessage.bind(e.alertPort),500)),e.alertPort.addEventListener("message",c(n.port1.postMessage.bind(n.port1),500)),r.port1.addEventListener("message",(function(t){return o(t.data)})),i.push(new WritableStream({write:r.port1.postMessage.bind(r.port1)}))}o.d(e,"a",(function(){return u}))},function(t,e,o){"use strict";var i=function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{a(i.next(t))}catch(t){r(t)}}function h(t){try{a(i.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,h)}a((i=i.apply(t,e||[])).next())}))},n=function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function h(r){return function(h){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,h])}}},r=function(){function t(t,e,o){this._chrome=t,this._ui=e,this.opts=o}return t.prototype.initServices=function(){var t=this;return new Promise((function(e){t._chrome.storage.sync.get(["use"],(function(o){o.use||t._chrome.storage.sync.set({use:o.use=[]}),Promise.all(o.use.map((function(e){return new Promise((function(o){return t._chrome.runtime.connect(e,o)})).then((function(t){return{id:e,port:t}}))}))).then((function(t){e(t)}))}))}))},t.prototype.onSqueakLinked=function(t){return i(this,void 0,void 0,(function(){var e;return n(this,(function(o){switch(o.label){case 0:return e=this._chrome,[4,t.call("when:send:to:","jsCMessage","call:with:",(function(t){return i(this,void 0,void 0,(function(){var o,i;return n(this,(function(n){switch(n.label){case 0:return[4,t.call("data")];case 1:return o=n.sent(),[4,new Promise((function(t){return e.runtime.postMessage(o,t)}))];case 2:return i=n.sent(),[4,t.call("reply:",i)];case 3:return[2,n.sent()]}}))}))}))];case 1:return o.sent(),[2]}}))}))},t}();e.a=r},function(t,e,o){"use strict";var i=o(6),n=o.n(i);function r(t,e){void 0===e&&(e={});var o=document.createElement("div");t.parentNode.appendChild(o),o.appendChild(t);var i,r,s,h,a,l,c,u=e.title||document.createElement("span");return n()(o).prepend(u),i=u,h=!1,a=o||i,l=0,c=0,i.addEventListener("mousedown",(function(t){r=t.clientX,s=t.clientY,h=!0})),i.addEventListener("mouseup",(function(t){h=!1,l=parseInt(a.style.left)||0,c=parseInt(a.style.top)||0})),document.addEventListener("mousemove",(function(t){if(h){var e=t.clientX-r,o=t.clientY-s;a.style.left=l+e+"px",a.style.top=c+o+"px"}})),e.decoration(u),{_d:o,_t:u}}o.d(e,"a",(function(){return r}))},function(t,e,o){"use strict";function i(t,e){return new Promise((function(o){var i,n,r=[new ReadableStream({start:function(t){return new Promise((function(e){i=t,n=e}))}}),new WritableStream({write:function(t){return Promise.resolve(i.enqueue(t))},close:function(){n()}})];if(!e)return o();e.get(t.location+"/settings/api/set",(function(t,e){t.body.pipeTo(r[1])})),e.get(t.location+"/settings/api/stream",(function(t,e){return new Response(r[0])})),e.get(t.location+"/init",(function(t,e){o(t)}))}))}o.d(e,"a",(function(){return i}))},function(t,e,o){"use strict";var i=o(34);function n(t,e,o,n){var r={};return function(s,h){n(s,(function(t){s.value=r[h]}),(function(t){r[h]=s.value}));var a=function(){var n=r[h]||"";return"="==n.charAt(0)?Object(i.a)(function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return e.forEach((function(e){var o=Object.keys(e).reduce((function(t,o){return t[o]=Object.getOwnPropertyDescriptor(e,o),t}),{});Object.getOwnPropertySymbols(e).forEach((function(t){var i=Object.getOwnPropertyDescriptor(e,t);i.enumerable&&(o[t]=i)})),Object.defineProperties(t,o)})),t}({},o,{log:t,chrome:void 0,get alert(){return e.olAlerter.alert},get prompt(){return e.olAlerter.prompt}}),n.substring(1)):isNaN(parseFloat(n))?n:parseFloat(n)};Object.defineProperty(o,h,{get:a}),Object.defineProperty(o,h.toLowerCase(),{get:a})}}o.d(e,"a",(function(){return n}))},function(t,e,o){"use strict";var i=o(20),n=o(16),r=o(5),s=o(2),h=Object(i.a)((function(t,e){var o=Object(s.a)(e,Object(r.a)(h));return Object(n.a)(t,64,void 0,e,o)}));h.placeholder={},e.a=h},function(t,e,o){"use strict";o.r(e),function(t){o(45);var e=o(43),i=o(9),n=o(6),r=o.n(n),s=(o(24),o(4)),h=o(3),a=o.n(h),l=o(11),c=o(25),u=(o(50),o(27)),p=o(39),d=o(40),f=o(28),g=o(29),y=o(30),m=o(31),M=o(32),w=o(12),b=o(36),v=o(41),S=o(37),x=o(33),C=o(22),P=o(42),k=o(38),T=function(){return(T=Object.assign||function(t){for(var e,o=1,i=arguments.length;o<i;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},I=window||self||t,B={};I.addEventListener=I.addEventListener||function(t,e){(B[t]||(B[t]=[])).push(e)},I.removeEventListener=I.removeEventListener||function(t,e){B[t]=B[t]&&B[t].filter((function(t){return t!==e}))},I.kernel={},kernel.snap=function(t,o){t.$=Object(u.a)(r.a,e.a(r.a.fn.filter.call.bind(r.a.fn.filter),".sn_sandboxed")),o()},kernel.onRanVM=function(t,e){Object.defineProperty(t.image.specialObjectsArray,"vm",{get:function(){return t}})},kernel.vort=c,kernel.BaseWindow=d.a,kernel.auth=function(t){return new Promise((function(e,o){kernel.store.getState().sys.usr.filter((function(e){return e.token===t||e.token.OLCacheEndpointPassword===t})).forEach(e),o()}))},kernel.prefs=function(t){return new Promise((function(e){fetch(t.domain||"ol.co/"+t.name).then((function(t){return t.json()})).then(e)}))},I.OlBridgeMorph=f.a,I.isSugar=!1;var E=void 0,O=[],L=kernel.store=Object(s.b)(kernel.reducer=Object(l.a)({sys:{k:{},app:void 0,terminal:void 0,memeOkBoomer:!1,memeFlatEarth:!1}},Object(s.a)({sys:Object(l.a)(null,Object(s.a)({k:Object(l.a)(null,(function(t,e){return t})),usr:a()("usr_",(function(t,e){return"user-create"===e.type?Object.assign({},t,{users:t.users.concat([e.data])}):"user_remove"===e.type?Object.assign({},t,{users:t.users.filter((function(t){return t.name===e.data.name&&t.passToken===e.data.token}))}):t}))}))}),Object(s.a)({dt:Object(l.a)({toolSlices:[]}),st:a()("squeak_",i.a(m.a,(function(){return I.SqueakJS}))),rolly:Object(s.a)({rIntegration:a()("r-integration_",e.a(i.a(M.a,I),Object(s.a)({}))),rData:a()("r-data_",(function(t,e){var o;return void 0===t&&(t={}),"addLocalComponent"===e.type?Object.assign({},t,((o={})[e.id]=e.data,o)):"setComponentID"===e.type?Object.assign({},t,{id:e.data}):t}))}),sysExtras:a()("extras_",Object(s.a)({})),app:i.a(g.a,I),sys:function(t,e){return"setApp"===e.type?{app:e.data}:"setTApp"===e.type?{terminal:e.data}:"_changeData"===e.type?e.data:t}}),a()("dt_",i.a((function(t,e,o){return e.dt.toolSlices.reduce((function(e,i){var n;return Object.assign({},e,((n={})[i]=Object.assign({},e[i],t(e[i],o)),n))}),e)}),(function(t,e){return t}))),Object(s.a)({auth:a()("auth_",(function(t,e){return"createID"===e.type?Object.assign({},t,{id:e.data||Object(y.a)()}):t}))})));I.addEventListener("message",(function(t){L.dispatch(T(T({},t.data),{source:t.source,origin:t.origin}))}));var D,F,R,j=Object(x.a)((function(t){return E=t}),(function(){return L.getState().sys.terminal})),N=(new C.a([],{getCurrent:function(){return L.getState().sys.terminal},setCurrent:function(t){L.dispatch({type:"setTApp",data:t})}}),new C.a(O,{getCurrent:function(){return L.getState().sys.app},setCurrent:function(t){L.dispatch({type:"setApp",data:t})}}),new b.a(w.a,{onFlagScratchClicked:function(t,e){var o=I.document.getElementsByClassName("project-title"),i=[].filter.call(o,(function(t){return t.innerHTML.includes("Pangea")}));i.length&&i.forEach((function(t){return t.addEventListener("click",(function(t){var e=window.open("https://snap.berkeley.edu/embed?project=Pangea%20OS%20NT&user=gkgoat&showTitle=true&showAuthor=true&editButton=true&pauseButton=true");Object(k.a)(e,I,E,O)}))}))}}));I._$console=j,I._$allApps=O,I.Sheet=P.a.bind(void 0,E),I.addEventListener("message",(function(t){if("createConsole"===t.data.type){var e=new MessageChannel;t.source.postMessage({port:e.port2},"*",[e.port2]),O.push(new WritableStream({write:e.port2.postMessage.bind(e.port2)})),e.port1.addEventListener("message",(function(t){return E(t.data)}))}var o;"linkConsole"===t.data.type&&(t.data.port.addEventListener("message",j[1].write.bind(j[1])),(o=j[0].tee())[0].pipeTo(new WritableStream({write:t.data.port.postMessage.bind(t.data.port)})).then((function(){j[0]=o[1]})))})),I.console.log=(R=I.console.log,function(t){return E(t),R(t)}),I.prompt=function(t){return function(e){return t(e)}}(I.prompt);var A=I.chrome;A&&A.app&&void 0!==A.app.window&&A.app.window.create("/dist/embed.html#/main.js",{},(function(t){t,t.contentWindow.addEventListener("message",(function(t){return I.postMessage(t.data,"*",t.data.transferables)})),I.addEventListener("message",(function(e){"comToMainWindow"==e.data.type&&t.postMesage(e.data.data,"*",e.data.transferables)}))})),(I.olKAPI||(I.olKAPI={})).addUI=function(t){w.a.Current=new w.a(t)};var W,_,H,z=!0,K=new Map,U=new Map;new Map,new OffscreenCanvas(1e3,1e3);if(I.workerMap&&(K=I.workerMap,z=!1,delete I.workerMap,I.addEventListener("message",(function(t){if(t.data.workerID&&t.data.create){I.ol_w_set(t.data.workerID,new Worker(t.data.url))}else t.data.workerID&&K.get(t.data.workerID).postMessage(Object.assign({},t.data.data,{transferables:t.data.transferables}),t.data.transferrables)})),I.ol_w_set=function(t,e){K.set(t,e),e.addEventListener("message",(function(e){I.postMessage({responseID:t,data:e.data,transferables:e.data.transferables},"*",e.data.transferables)}))}),I.define||I.System&&I.System.amdDefine){var G=I.define||I.System&&I.System.amdDefine;G("activity/activity",["sugar-web/activity/activity","sugar-web/env","olPalette"],(function(t,e,o){I.isSugar=!0,I.rollyChain&&I.rollyChain.forEach((function(t){return t.setIsSugar(!0)})),D=t,e.getEnvironment((function(t,e){e.user.name,I.addEventListener("DOMContentLoaded",(function(t){D.start(),F=new o.OLPallette(document.getElementById("olPalleteBarItem"),"ObjectLand")}))}))})),G("ol.bridge",["exports"],(function(t){Object.defineProperty(t,"enq",{get:function(){return E}}),Object.defineProperty(t,"pallette",{get:function(){return F}})}))}if(A&&(_=new p.a(A,w.a,{getSqueakProxy:function(){},getLink:function(){return N}})),!A&&I.document&&(Object(S.a)({win:I,workerMap:K,libs:U,chrome:void 0,callback:function(t){W=t}}),z=z&&I.isGadgetHelper),I.ServiceWorkerWare&&(H=new I.ServiceWorkerWare),I.require&&!H)try{H=I.require("express")()}catch(t){}I.document&&N.listen(document.body),I.location&&(I.location.hostname.includes("ol")||"chrome-extension"===I.location.protocol)&&(z=!0),Object(v.a)(I,H).then((function(t){t&&t})),_&&_.initServices().then((function(t){t})),I.addEventListener("message",(function(t){"exlinkgadget"===t.data.type&&W(Object.assign({},t.data.data,{transferables:t.data.transferables}),t.data.transferables),A&&t.data.id&&t.data.data&&"chrome"===t.data.type&&A.runtime.postMessage(Object.assign({},t.data.data,{isFromWebpage:!0,id:t.data.id}),(function(e){I.postMessage({chromeResponseID:t.data.id,chromeResponseData:e})})),W&&"gadget"===t.data.type&&W(t.data.data,t.data.transferables)})),I.open&&new Promise((function(t,e){if(!A)return e();A.storage.sync.get(["ol-deskEnv"],(function(t){e(t["ol-deskEnv"])}))})).catch((function(t){return t||Promise.resolve((I.prompt.default||I.prompt).call(I,"Desk Env URL"))})).then((function(t){return I.open(t)})).then((function(t){return I.addEventListener("message",(function(e){e.source===t&&I.postMessage(e.data,"*",e.data.transferables),"comToDeskEnv"===e.data.type&&t.postMessage({type:"fromWin",data:e.data},"*",e.data.transferables)})),t}))}.call(this,o(13))},function(t,e,o){var i=o(46),n=o(47);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var r={insert:"head",singleton:!1},s=(i("!!../../node_modules/css-loader/dist/cjs.js!./main.css",n,r),n.locals?n.locals:{});t.exports=s},function(t,e,o){"use strict";var i,n={},r=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},s=function(){var t={};return function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(t){o=null}t[e]=o}return t[e]}}();function h(t,e,o){t=o.base?t+o.base:t,n[t]||(n[t]=[]);for(var i=0;i<e.length;i++){var r=e[i],s={css:r[1],media:r[2],sourceMap:r[3]},h=n[t];h[i]?h[i].updater(s):h.push({updater:g(s,o)})}for(var a=e.length;a<n[t].length;a++)n[t][a].updater();n[t].length=e.length,0===n[t].length&&delete n[t]}function a(t){var e=document.createElement("style"),i=t.attributes||{};if(void 0===i.nonce){var n=o.nc;n&&(i.nonce=n)}if(Object.keys(i).forEach((function(t){e.setAttribute(t,i[t])})),"function"==typeof t.insert)t.insert(e);else{var r=s(t.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(e)}return e}var l,c=(l=[],function(t,e){return l[t]=e,l.filter(Boolean).join("\n")});function u(t,e,o,i){var n=o?"":i.css;if(t.styleSheet)t.styleSheet.cssText=c(e,n);else{var r=document.createTextNode(n),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(r,s[e]):t.appendChild(r)}}function p(t,e,o){var i=o.css,n=o.media,r=o.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),r&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var d=null,f=0;function g(t,e){var o,i,n;if(e.singleton){var r=f++;o=d||(d=a(e)),i=u.bind(null,o,r,!1),n=u.bind(null,o,r,!0)}else o=a(e),i=p.bind(null,o,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(o)};return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else n()}}t.exports=function(t,e,o){return(o=o||{}).singleton||"boolean"==typeof o.singleton||(o.singleton=r()),h(t,e,o),function(e){h(t,e||[],o)}}},function(t,e,o){(e=o(48)(!1)).push([t.i,"",""]),t.exports=e},function(t,e,o){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var o=function(t,e){var o=t[1]||"",i=t[3];if(!i)return o;if(e&&"function"==typeof btoa){var n=(s=i,h=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(h),"/*# ".concat(a," */")),r=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot).concat(t," */")}));return[o].concat(r).concat([n]).join("\n")}var s,h,a;return[o].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(o,"}"):o})).join("")},e.i=function(t,o){"string"==typeof t&&(t=[[null,t,""]]);for(var i=0;i<t.length;i++){var n=[].concat(t[i]);o&&(n[2]?n[2]="".concat(o," and ").concat(n[2]):n[2]=o),e.push(n)}},e}},function(t,e,o){"use strict";function i(t,e){for(var o in e)t[o]=e[o];return t}t.exports=function(t,e){return i(i({},t),e)}},function(t,e){if(!completeAssign)try{completeAssign=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return e.forEach((function(e){var o=Object.keys(e).reduce((function(t,o){return t[o]=Object.getOwnPropertyDescriptor(e,o),t}),{});Object.getOwnPropertySymbols(e).forEach((function(t){var i=Object.getOwnPropertyDescriptor(e,t);i.enumerable&&(o[t]=i)})),Object.defineProperties(t,o)})),t}}catch(t){}},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}}]);